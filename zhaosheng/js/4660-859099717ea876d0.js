try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="0f934945-e76a-4a8e-9a5e-9009bd463f6c",e._sentryDebugIdIdentifier="sentry-dbid-0f934945-e76a-4a8e-9a5e-9009bd463f6c")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4660],{42480:function(){},30327:function(e,t,n){"use strict";n.r(t),n.d(t,{BindMethod:function(){return d},ChatType:function(){return p},LoginMethod:function(){return l},MetricType:function(){return u},PaymentChannel:function(){return _},ProductType:function(){return h}});var r,i,o,a,s,c,u,l,d,p,_,h,f=n(1599),m=n(88808),E=n(91905);(r=u||(u={})).APP_COLD_START="app.cold_start_time",r.APP_DISK_USAGE="app.disk_usage",r.APP_OOM_RATE="app.oom_rate",r.APP_CRASH_RATE="app.crash_rate",r.APP_FRAME_DROP_RATE="app.frame_drop_rate",r.APP_FREEZE_RATE="app.freeze_rate",r.APP_NETWORK_ERROR_RATE="app.network_error_rate",r.WEB_LCP="web.lcp",r.WEB_FCP="web.fcp",r.WEB_CLS="web.cls",r.WEB_TTFB="web.ttfb",r.ERROR_REACT="error.react",r.ERROR_JS="error.js",r.ERROR_API="error.api",r.LOGIN_CONVERSION_RATE="login.conversion_rate",r.LOGIN_SUCCESS_RATE="login.success_rate",r.LOGIN_ONECLICK_RATIO="login.oneclick_ratio",r.LOGIN_PHONE_SUCCESS_RATE="login.phone.success_rate",r.LOGIN_PHONE_VERIFY_COMPLETION_RATE="login.phone.verify_completion_rate",r.LOGIN_ONECLICK_SUCCESS_RATE="login.oneclick.success_rate",r.LOGIN_WECHAT_SUCCESS_RATE="login.wechat.success_rate",r.LOGIN_APPLE_SUCCESS_RATE="login.apple.success_rate",r.LOGIN_GOOGLE_SUCCESS_RATE="login.google.success_rate",r.BIND_CONVERSION_RATE="bind.conversion_rate",r.BIND_SUCCESS_RATE="bind.success_rate",r.BIND_ONECLICK_RATIO="bind.oneclick_ratio",r.BIND_PHONE_SUCCESS_RATE="bind.phone.success_rate",r.BIND_PHONE_VERIFY_COMPLETION_RATE="bind.phone.verify_completion_rate",r.BIND_ONECLICK_SUCCESS_RATE="bind.oneclick.success_rate",r.CHAT_SUCCESS_RATE="chat.success_rate",r.CHAT_CONVERSION_RATE="chat.conversion_rate",r.CHAT_FIRST_FRAME_DELAY="chat.first_frame_delay",r.CHAT_TOTAL_DURATION="chat.total_duration",r.PAYMENT_SUCCESS_RATE="payment.success_rate",r.PAYMENT_CONVERSION_RATE="payment.conversion_rate",r.PAYMENT_COMPLETION_RATE="payment.completion_rate",r.PAGE_ERROR_RATE="page.error_rate",r.PAGE_BLANK_RATE="page.blank_rate",r.PAGE_FIRST_FRAME_DURATION="page.first_frame_duration",r.USER_TOTAL_ERROR_RATE="user.total_error_rate",r.API_RESPONSE_TIME="api.response_time",(i=l||(l={})).PHONE="phone",i.ONECLICK="oneclick",i.WECHAT="wechat",i.APPLE="apple",i.GOOGLE="google",(o=d||(d={})).PHONE="phone",o.ONECLICK="oneclick",(a=p||(p={})).TEXT="text",a.IMAGE="image",a.VOICE="voice",a.FILE="file",a.DEEP_RESEARCH="deep_research",(s=_||(_={})).WECHAT="wechat",s.ALIPAY="alipay",s.APPLE="apple",s.GOOGLE="google",(c=h||(h={})).VIP="vip",c.TOKEN="token",c.POINTS="points",c.OTHER="other";class g{static getInstance(){return g.instance||(g.instance=new g),g.instance}init(){if(!this.isInitialized){this.isInitialized=!0;try{this.metricsEnabled="function"==typeof f.GK}catch(e){this.metricsEnabled=!1}m.YA("app.version","wenxiaobai-web@3.7.9"),m.v("performance",{monitoring_enabled:!0,client_time:new Date().toISOString()}),setInterval(()=>this.reportMetrics(),3e4),window.addEventListener("beforeunload",()=>{this.reportMetrics(),m.yl(2e3).catch(()=>{})})}}setupFrameRateMonitoring(){let e=performance.now(),t=()=>{let n=performance.now(),r=n-e;this.frameCount++,r>33.33&&this.frameDrops++,r>200&&this.freezeCount++,e=n,requestAnimationFrame(t)};requestAnimationFrame(t),setInterval(()=>{if(this.frameCount>0){let e=this.frameDrops/this.frameCount,t=this.freezeCount/this.frameCount;this.recordMeasurement("app.frame_drop_rate",e),this.recordMeasurement("app.freeze_rate",t),this.frameDrops=0,this.frameCount=0,this.freezeCount=0}},1e4)}trackLogin(e){let{method:t,isStart:n,isSuccess:r,verifyCompleted:i,duration:o}=e;if(n&&this.recordMeasurement("login.conversion_rate",1,{method:t,stage:"start"}),void 0!==r)switch(this.recordMeasurement("login.success_rate",r?1:0,{method:t,result:r?"success":"fail"}),t){case"phone":this.recordMeasurement("login.phone.success_rate",r?1:0,{});break;case"oneclick":this.recordMeasurement("login.oneclick.success_rate",r?1:0,{}),this.recordMeasurement("login.oneclick_ratio",1,{});break;case"wechat":this.recordMeasurement("login.wechat.success_rate",r?1:0,{});break;case"apple":this.recordMeasurement("login.apple.success_rate",r?1:0,{});break;case"google":this.recordMeasurement("login.google.success_rate",r?1:0,{})}"phone"===t&&void 0!==i&&this.recordMeasurement("login.phone.verify_completion_rate",i?1:0,{})}trackBind(e){let{method:t,isStart:n,isSuccess:r,verifyCompleted:i}=e;if(n&&this.recordMeasurement("bind.conversion_rate",1,{method:t,stage:"start"}),void 0!==r)switch(this.recordMeasurement("bind.success_rate",r?1:0,{method:t,result:r?"success":"fail"}),t){case"phone":this.recordMeasurement("bind.phone.success_rate",r?1:0,{});break;case"oneclick":this.recordMeasurement("bind.oneclick.success_rate",r?1:0,{}),this.recordMeasurement("bind.oneclick_ratio",1,{})}"phone"===t&&void 0!==i&&this.recordMeasurement("bind.phone.verify_completion_rate",i?1:0,{})}trackChat(e){let{chatType:t,isStart:n,isSuccess:r,firstFrameDelay:i,totalDuration:o,botId:a}=e,s={chat_type:t};a&&(s.bot_id=a),n&&this.recordMeasurement("chat.conversion_rate",1,{...s,stage:"start"}),void 0!==r&&this.recordMeasurement("chat.success_rate",r?1:0,{...s,result:r?"success":"fail"}),i&&this.recordMeasurement("chat.first_frame_delay",i,s),o&&this.recordMeasurement("chat.total_duration",o,s)}trackPayment(e){let{channel:t,productType:n,productId:r,isStart:i,isSuccess:o,isCompletion:a,amount:s}=e,c={channel:t,product_type:n};r&&(c.product_id=r),s&&(c.amount=s.toString()),i&&this.recordMeasurement("payment.conversion_rate",1,{...c,stage:"start"}),void 0!==o&&this.recordMeasurement("payment.success_rate",o?1:0,{...c,result:o?"success":"fail"}),void 0!==a&&this.recordMeasurement("payment.completion_rate",a?1:0,{...c,result:a?"success":"fail"})}trackPagePerformance(e){let{hasError:t,isBlank:n,firstFrameDuration:r,page:i}=e,o={page:i};void 0!==t&&this.recordMeasurement("page.error_rate",t?1:0,o),void 0!==n&&this.recordMeasurement("page.blank_rate",n?1:0,o),r&&this.recordMeasurement("page.first_frame_duration",r,o)}trackApiCall(e){let{url:t,status:n,duration:r,error:i,stage:o="end",method:a="GET"}=e,s=!0===e.success,c=t.split("?")[0];try{if("start"===o){E.n({category:"api",type:"http",message:"API Request started: ".concat(c),data:{url:c,method:a,stage:"start"},level:"info"});return}f.GK({name:"api.response_time",op:"measurement.duration",forceTransaction:!0,startTime:Date.now()/1e3-r/1e3},e=>{e.setAttribute("api_endpoint",c),e.setAttribute("http.method",a),e.setAttribute("http.status_code",n.toString()),e.setAttribute("success",s.toString()),e.setAttribute("api_category","response_time"),e.setAttribute("duration_ms",r.toString()),!s&&i&&(e.setAttribute("error",i),e.setStatus({code:"error"})),s||f.GK({name:"api.error_rate",op:"measurement.count",forceTransaction:!0},e=>{e.setAttribute("api_endpoint",c),e.setAttribute("http.method",a),e.setAttribute("http.status_code",n.toString()),e.setAttribute("error_type",i||"unknown"),e.setAttribute("count","1"),e.setAttribute("api_category","error_rate"),e.setStatus({code:"error"})})}),"function"==typeof f.GK&&this.metricsEnabled&&f.GK({name:"api_call_".concat(c),op:"http"},e=>{e.setAttribute("url",c),e.setAttribute("method",a),e.setAttribute("status",n.toString()),e.setAttribute("duration",r.toString()),e.setAttribute("success",s.toString()),!s&&i&&e.setAttribute("error",i),s||e.setStatus({code:"error"})}),E.n({category:"api",type:"http",message:"".concat(s?"Success":"Failed"," API call to ").concat(c),data:{url:c,status:n,duration:r,success:s,method:a},level:s?"info":"error"}),this.updateNetworkCounters({isApiRequest:!0,isError:!s}),m.yl(2e3).catch(e=>console.error("Failed to flush Sentry queue:",e))}catch(e){}}trackApiError(e){let{url:t,status:n,duration:r,errorMsg:i,errorCode:o="unknown",method:a="GET",context:s={}}=e,c=t.split("?")[0];try{this.trackApiCall({url:t,status:n,duration:r,success:!1,error:i,method:a}),f.GK({name:"api.error.".concat(o),op:"api.error",forceTransaction:!0,startTime:Date.now()/1e3-r/1e3},e=>{e.setAttribute("api.endpoint",c),e.setAttribute("http.method",a),e.setAttribute("http.status_code",n.toString()),e.setAttribute("error_code",o),e.setAttribute("error_message",i.substring(0,200)),e.setAttribute("duration_ms",r.toString()),Object.entries(s).forEach(t=>{let[n,r]=t;("string"==typeof r||"number"==typeof r||"boolean"==typeof r)&&e.setAttribute("context.".concat(n),String(r).substring(0,200))}),e.setStatus({code:"error"}),m.eN({message:"API Error: ".concat(i),level:"error",tags:{api_endpoint:c,status_code:n.toString(),error_code:o,method:a},extra:s,contexts:{api:{endpoint:c,status:n,duration:r,error_message:i,error_code:o,method:a,...s}}})}),this.recordMeasurement("api.response_time",r,{endpoint:c,status:n.toString(),success:"false",error_type:o?"code_".concat(o):"http_error",method:a})}catch(e){}}async trackApiWithSentry(e,t){this.isInitialized||this.init();let n=performance.now(),r=(null==e?void 0:e.url)||"",i=(null==e?void 0:e.method)||"GET",o=!!((null==e?void 0:e.data)||(null==e?void 0:e.body)),a=r.split("?")[0],s=a.split("/").slice(-2).join("/"),c="api.request.".concat(i.toLowerCase(),".").concat(s||"unknown");return E.n({category:"api.request.start",type:"http",message:"API Request started: ".concat(a),data:{url:a,method:i},level:"info"}),f.GK({name:c,op:"http.client",forceTransaction:!0},async e=>{try{var s,c;let u;e.setAttribute("http.url",r),e.setAttribute("http.method",i),e.setAttribute("has_body",o.toString()),e.setAttribute("api_endpoint",a),E.n({category:"api.request.active",type:"http",message:"Executing API Request: ".concat(a),data:{url:r,method:i,transaction_id:e.spanContext().spanId},level:"debug"});let l=await t,d=performance.now()-n,p=200,_=!0;if(!l||"object"!=typeof l||(l.status?p=l.status:void 0!==l.code&&(p=0===l.code?200:l.code),(_=p>=200&&p<300||0===l.code)||(u=l.statusText||l.msg||l.message||"Unknown API error")),e.setAttribute("http.status_code",p.toString()),e.setAttribute("duration_ms",d.toString()),e.setAttribute("success",_.toString()),!_){e.setAttribute("error",u||"Unknown API error");let t=(null===(s=l.code)||void 0===s?void 0:s.toString())||p.toString();e.setAttribute("error_code",t)}if(E.n({category:"api.request.end",type:"http",message:"".concat(_?"Success":"Failed"," API call to ").concat(a),data:{url:a,status:p,duration:d,success:_,method:i,error:u},level:_?"info":"error"}),this.updateNetworkCounters({isApiRequest:!0,isError:!_}),this.handleAuthState(r,i,l,_),!_&&u){let e=(null===(c=l.code)||void 0===c?void 0:c.toString())||p.toString();m.uT("API Error: ".concat(u),{level:"error",tags:{error_type:"api_call_failure",api_endpoint:a,error_code:e,http_method:i,http_status_code:p.toString()},extra:{request_body_present:o,response_data:l}})}return m.yl(2e3).catch(()=>{}),l}catch(s){let t=performance.now()-n,r=s instanceof Error?s.message:String(s);throw e.setAttribute("error","true"),e.setAttribute("exception","true"),e.setAttribute("error.message",r),e.setAttribute("duration_ms",t.toString()),E.n({category:"api.request.exception",type:"error",message:"API Request Exception: ".concat(r),data:{url:a,method:i},level:"error"}),m.Tb(s,{tags:{error_type:"api_request_exception",api_endpoint:a,http_method:i},extra:{request_body_present:o}}),this.updateNetworkCounters({isApiRequest:!0,isError:!0}),m.yl(2e3).catch(()=>{}),s}})}handleAuthState(e,t,n,r){try{let i=e.includes("/sessions")&&"POST"===t,o=e.includes("/sessions/")&&"DELETE"===t,a=e.includes("/weChat/callback")&&"POST"===t,s=e.includes("/sessions/refresh")&&"GET"===t;if(!i&&!o&&!a&&!s)return;let c=null;try{n&&"object"==typeof n&&(c=n.data||n)}catch(e){return}(i||a)&&c?this.handleLoginState(e,a,c,r):o&&r?this.handleLogoutState():s&&this.handleTokenRefresh(r,n.statusText)}catch(e){}}handleLoginState(e,t,n,r){if(r)try{let r=n.data||n;r&&r.user&&(m.av({id:r.user.id,username:r.user.phone||r.user.userName||r.user.nickname,email:r.user.email,isTourist:e.includes("tourist")}),E.n({category:"auth",message:"User logged in: ".concat(r.user.userId),data:{login_method:t?"wechat":e.includes("tourist")?"tourist":"phone",user_id:r.user.userId},level:"info"}),window.sentryTrack&&window.sentryTrack.sessionUpdate(!0,e.includes("tourist")),this.recordLoginMetrics(e,t,!0))}catch(e){}else{this.recordLoginMetrics(e,t,!1);let n=this.determineLoginMethod(e,t);E.n({category:"auth",message:"Login failed: ".concat(n),data:{error:"Authentication failed"},level:"error"})}}determineLoginMethod(e,t){return t?"wechat":e.includes("tourist")?"oneclick":"phone"}recordLoginMetrics(e,t,n){let r=this.determineLoginMethod(e,t);this.trackLogin({method:r,isSuccess:n})}handleLogoutState(){m.av(null),E.n({category:"auth",message:"User logged out",level:"info"}),window.sentryTrack&&window.sentryTrack.sessionUpdate(!1,!1)}handleTokenRefresh(e,t){E.n({category:"auth",message:e?"Token refreshed successfully":"Token refresh failed",data:e?void 0:{error:t||"Unknown error"},level:e?"info":"warning"})}recordMeasurement(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.isInitialized||this.init();try{let i=String(e).replace(/_/g,"."),o=this.getMetricUnit(e),a={};Object.entries(n).forEach(e=>{let[t,n]=e;a[t]="string"==typeof n?n.substring(0,200):String(n).substring(0,200)}),f.GK({name:"metric.".concat(i),op:this.isDistribution(e)?"measurement.distribution":"measurement.count",forceTransaction:!0},n=>{n.setAttribute("metric_name",i),n.setAttribute("metric_value",t.toString()),n.setAttribute("metric_unit",o||"none"),Object.entries(a).forEach(e=>{let[t,r]=e;n.setAttribute("tag.".concat(t),r)}),this.isDistribution(e)&&"millisecond"===o&&(n.setAttribute("is_duration","true"),n.setAttribute("duration_ms",t.toString()),n.setAttribute("duration_equivalent","true")),"ratio"===o&&(n.setAttribute("is_ratio","true"),n.setAttribute("ratio_value",t.toString())),r.markError&&n.setStatus({code:"error"}),E.n({category:"metric",message:"".concat(e,": ").concat(t),data:{value:t,unit:o,...a},level:r.markError?"error":"info"}),("user.total_error_rate"===e||"app.crash_rate"===e||"app.freeze_rate"===e)&&m.uT("Metric ".concat(i,": ").concat(t),{level:t>.05?"warning":"info",tags:{metric_type:i,...a}})}),(this.isDistribution(e)||r.captureMessage||r.markError)&&m.yl(2e3).catch(()=>{})}catch(e){}}isDistribution(e){return["web.lcp","web.fcp","web.cls","web.ttfb","chat.first_frame_delay","chat.total_duration","api.response_time","app.cold_start_time","page.first_frame_duration"].includes(e)}getMetricUnit(e){switch(e){case"app.cold_start_time":case"chat.first_frame_delay":case"chat.total_duration":case"page.first_frame_duration":case"web.fcp":case"web.ttfb":case"api.response_time":return"millisecond";case"app.frame_drop_rate":case"app.freeze_rate":case"app.network_error_rate":case"web.cls":return"ratio";case"error.react":case"error.js":case"error.api":return"count";default:return"none"}}async reportMetrics(){if(this.isInitialized)try{await m.yl(2e3)}catch(e){}}updateNetworkCounters(e){let{isApiRequest:t=!1,isError:n=!1}=e;this.networkRequests++,n&&this.networkErrors++,t&&(this.apiRequests++,n&&this.apiErrors++)}triggerMetricsReport(){this.reportMetrics().catch(e=>{})}constructor(){this.isInitialized=!1,this.frameDrops=0,this.frameCount=0,this.freezeCount=0,this.networkErrors=0,this.networkRequests=0,this.apiErrors=0,this.apiRequests=0,this.transactions={},this.metricsEnabled=!0,this.startTime=Date.now()}}let I=g.getInstance();t.default=I},97179:function(e,t,n){"use strict";n.d(t,{A6:function(){return s},BK:function(){return f},Ed:function(){return a},Fg:function(){return A},Re:function(){return I},Uz:function(){return d},Xg:function(){return c},eD:function(){return u},eW:function(){return T},fK:function(){return _},kC:function(){return y},n8:function(){return p},oO:function(){return E},qm:function(){return l},sp:function(){return m},tW:function(){return r},x$:function(){return S},zY:function(){return h}});let r="api/v1.0",i="api-bj.wenxiaobai.com",o="https://",a="https://activity.wenxiaobai.com/end.html";function s(e){return"".concat(o).concat(i,":").concat("443","/").concat(e,"/core")}function c(e){return"".concat(o).concat(i,":").concat("443","/").concat(e,"/user")}function u(e){return"".concat(o).concat(i,":").concat("443","/").concat(e,"/bot")}function l(e){return"".concat(o).concat(i,":").concat("443","/").concat(e,"/file")}function d(e){return"".concat(o).concat(i,":").concat("443","/rest/api")}let p={SUCCESS:0,NEED_LOGIN:5e3,LOGIN_PASSWORD_ERROR:5001,CHECK_CODE_INVALID:5002,CHECK_CODE_ERROR:5003,LOGIN_IS_BANNED:5004,USERID_MISMATCH:5005,TOKEN_INVALID:5006,TOKEN_EXPIRE:5007,TOKEN_REQUIRE:5008,VISITORID_REQUIRE:5009,VISITORID_EXPIRE:5010,VISITORID_INVALID:5011,VISITORID_MISMATCH:5012,SIGN_INVALID:5013,SIG_TIMEOUT:5014,REGISTER_PASS:5015,REGISTER_PATIENT:5016,TOURIST_LIMIT:5106,PARAM_REQUIRE:6e3,PARAM_INVALID:6001,PARAM_IMAGE_FORMAT_ERROR:6002,SERVER_ERROR:500,DATA_EXIST:7e3,USER_DATA_NOT_EXIST:7001,DATA_NOT_EXIST:7002,NO_OPERATOR_AUTH:4e3,NEED_ADMIND:4001,UPDATEPHONE_ERROR:5019},_={CHAT:{key:"chat",area:{CONVERSATION:{key:"conversation",element:{QUESTION:"question",ANSWER:"answer",RELATED_QUESTION:"related_question",PRAISE_BTN:"praise_btn",DISLIKE_BTN:"dislike_btn",PRE_BTN:"pre_btn",NEXT_BTN:"next_btn",REFRESH_BTN:"refresh_btn",PPT_CREATE:"ppt_create"}},INPUT:{key:"input",element:{INPUT:"input",SEND_BTN:"send_btn",NEW_START_BTN:"new_start_btn",PAUSE:"pause"}},CHAT:{key:"chat",element:{RECOMMEND:"recommend"}}}},HISTORY:{key:"history"},FEED:{key:"feed"},FEED_DETAIL:{key:"feed_detail"},SHARE_CHAT:{key:"share_chat"},SHARE_DEEP_RESEARCH:{key:"share_deep_research",area:{SHARE_BTN:"share_btn",HOME_BTN:"home_btn"}},SHRE_CARD:{key:"share_card"},LOGIN:{key:"login"},SETTING:{key:"setting"},DISCOVERY:{key:"discovery"}},h={INPUT_WAY:{PROACTIVE:"proactive",RELATIVED:"related",ICEBREAKING:"icebreaking",RECOMMEND:"recommend"}},f="抱歉，网络开小差了，请再问我一次。",m=10,E=["image/jpg","image/png","image/jpeg","image/gif","image/bmp","image/webp"],g=[".txt","text/plain",".pdf","application/pdf",".doc","application/msword",".docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document",".md",".csv","text/csv",".xls","application/vnd.ms-excel",".xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".pptx",".ppt","application/vnd.openxmlformats-officedocument.presentationml.presentation",".epub",".mobi",".azw3",".fb2",".rtf",".lrf",".lit",".djvu","application/vnd.ms-powerpoint","application/epub+zip","text/rtf","application/mobi"],I={file:{key:"file",title:"文件",lengthLimit:10,exceedLengthMsg:"最多可上传 ".concat(10," 个文件"),exceedTotalLengthMsg:"上传文件数目超出最大限制（".concat(10,"个），超出部分无法上传。"),sizeLimit:104857600,exceedSizeMsg:"单个文件大小超过限制（".concat(100," MB），请调整后重试"),acceptType:g,exceedAcceptTypeMsg:"暂不支持此格式，请更换。",isForbidden(e){let{files:t}=e,n=t.filter(e=>E.includes(e.type)).length;return n>=1},forbiddenMsg:"已经上传了图片，文件和图片不支持同时上传",dropUploadTips:"可上传".concat(10,"个文件，每个最多").concat(100,"MB，支持各类文档"),buttonUploadTips:"可上传".concat(10,"个文件，每个最多").concat(100,"MB，支持各类文档")},image:{key:"image",title:"图片",lengthLimit:1,exceedLengthMsg:"仅支持上传 ".concat(1," 张图片"),exceedTotalLengthMsg:"上传文件数目超出最大限制（".concat(10,"个），超出部分无法上传。"),sizeLimit:10485760,exceedSizeMsg:"单个图片大小超过限制（10 MB），请调整后重试",acceptType:E,exceedAcceptTypeMsg:"暂不支持此格式，请更换。",isForbidden(e){let{files:t}=e,n=t.filter(e=>g.includes(e.type)).length;return n>=1},forbiddenMsg:"已经上传了文件，文件和图片不支持同时上传",dropUploadTips:"可上传".concat(1,"个图片，单个文件最多").concat(10,"MB"),buttonUploadTips:"可上传".concat(1,"个图片，单个文件最多").concat(10,"MB")}},T={touristFst:"_qdd_tstp"},y="/",A={"ys-chat.wenxiaobai.com":78,"ys-chat-normal.wenxiaobai.com":75},S=["cameraSolve"]},60767:function(e,t,n){"use strict";n.r(t),n.d(t,{ALL_MENU_LIST:function(){return p},CONVER_TYPE_TO_PROMPT_MAP:function(){return g},EImageGenerateSubType:function(){return c},EMenuType:function(){return a},EWriteSubType:function(){return s},MENUKEY_TO_REPORTKEY_MAP:function(){return _},UPLOAD_FILE_TYPE_MENU_LIST:function(){return m},UPLOAD_IMAGE_TYPE_MENU_LIST:function(){return E},WRITE_SUBMENUKEY_TO_REPORTKEY_MAP:function(){return h},WRITE_SUBMENU_LIST_MAP:function(){return f},default:function(){return A},getCoverType:function(){return I},getPromptByConverType:function(){return T},isUploadTypeMenuItem:function(){return y}});var r,i,o,a,s,c,u=n(2265),l=n(88915),d=n.n(l);(r=a||(a={})).NONE="",r.OTHER_BOT="otherBot",r.IMAGE="image",r.WEBPAGE="webPage",r.FILE="file",(i=s||(s={})).NONE="",i.ARTICLE="help_me_write_article",i.ESSAY="help_me_write_essay",i.NOVEL="help_me_write_novel",i.STORY="help_me_write_story",i.XIAO_HONG_SHU="help_me_write_xiaohongshu",i.WECHAT_MOMENTS="help_me_write_wechatmoments",(o=c||(c={})).NONE="",o.STYLE="style",o.SIZE="size";let p=Object.values(a),_={[a.WRITE]:"chat_tools_helpmewrite",[a.IMAGE]:"chat_tools_imageanalyse",[a.WEBPAGE]:"chat_tools_webread",[a.FILE]:"chat_tools_fileanalyse"},h={[a.WRITE]:{[s.ARTICLE]:"help_me_write_article",[s.ESSAY]:"help_me_write_essay",[s.NOVEL]:"help_me_write_novel",[s.STORY]:"help_me_write_story",[s.XIAO_HONG_SHU]:"help_me_write_xiaohongshu",[s.WECHAT_MOMENTS]:"help_me_write_wechatmoments"}},f={[a.WRITE]:[{key:s.WECHAT_MOMENTS,action:"click",title:"朋友圈",prompt:"帮我写一个幽默风趣的 [朋友圈] 文案，100~200字，主题是：",extraInfo:{}},{key:s.ARTICLE,action:"click",title:"文章",prompt:"帮我写一篇正式的[文章]，要求内容充实、有逻辑性，篇幅在 800字左右，主题是：",extraInfo:{}},{key:s.ESSAY,action:"click",title:"作文",prompt:"帮我写一篇[作文]，500字左右，要求文字表达流畅，有清晰的开头正文和结尾。主题是：",extraInfo:{}},{key:s.NOVEL,action:"click",title:"小说",prompt:"帮我编写一个精彩的[小说]，有引人入胜的背景，故事要有悬念感，引发读者对后续情节的好奇，主题是：",extraInfo:{}},{key:s.XIAO_HONG_SHU,action:"click",title:"小红书",prompt:"帮我写一个[小红书]风格的文案，采用二极管标题法，内容：在每段话的开头和结尾都使用emoji。文章结尾需要提取 5-8 个#标签，主题是：",extraInfo:{}}],[a.PROMPT_MENU]:[{key:c.STYLE,title:"风格",action:"select",prompt:"风格",extraInfo:{iconSize:42,options:[{icon:"https://wy-static.wenxiaobai.com/multimodal_image/%E7%BD%91%E9%A1%B5%E9%98%85%E8%AF%BB.png",text:"人像摄影",prompt:"人像摄影"},{icon:"https://wy-static.wenxiaobai.com/multimodal_image/%E7%BD%91%E9%A1%B5%E9%98%85%E8%AF%BB.png",text:"电影写真",prompt:"电影写真"},{icon:"https://wy-static.wenxiaobai.com/multimodal_image/%E7%BD%91%E9%A1%B5%E9%98%85%E8%AF%BB.png",text:"中国风",prompt:"中国风"},{icon:"https://wy-static.wenxiaobai.com/multimodal_image/%E7%BD%91%E9%A1%B5%E9%98%85%E8%AF%BB.png",text:"动漫",prompt:"动漫"},{icon:"https://wy-static.wenxiaobai.com/multimodal_image/%E7%BD%91%E9%A1%B5%E9%98%85%E8%AF%BB.png",text:"3D渲染",prompt:"3D渲染"}]}},{key:c.SIZE,title:"比例",action:"select",prompt:"比例",extraInfo:{iconSize:20,options:[{icon:"https://wy-static.wenxiaobai.com/multimodal_image/%E7%BD%91%E9%A1%B5%E9%98%85%E8%AF%BB.png",text:"1:1 头像，封面图",prompt:"1:1"},{icon:"https://wy-static.wenxiaobai.com/multimodal_image/%E7%BD%91%E9%A1%B5%E9%98%85%E8%AF%BB.png",text:"2:3 自拍，旅游照片",prompt:"2:3"}]}}]},m=[a.FILE],E=[a.IMAGE],g={"":"",["".concat(a.WEBPAGE)]:"请帮我总结这个网页：",["".concat(a.FILE)]:"详细描述这个文件的内容",["".concat(a.IMAGE)]:"简要描述这幅图像",["".concat(a.WRITE,"-").concat(s.WECHAT_MOMENTS)]:"帮我写一个幽默风趣的 [朋友圈] 文案，100~200字，主题是：",["".concat(a.WRITE,"-").concat(s.ARTICLE)]:"帮我写一篇正式的[文章]，要求内容充实、有逻辑性，篇幅在 800字左右，主题是：",["".concat(a.WRITE,"-").concat(s.ESSAY)]:"帮我写一篇[作文]，500字左右，要求文字表达流畅，有清晰的开头正文和结尾。主题是：",["".concat(a.WRITE,"-").concat(s.NOVEL)]:"帮我编写一个精彩的[小说]，有引人入胜的背景，故事要有悬念感，引发读者对后续情节的好奇，主题是：",["".concat(a.WRITE,"-").concat(s.STORY)]:"帮我编写一个有趣的短篇[故事]，确保故事内容引人入胜，主题是：",["".concat(a.WRITE,"-").concat(s.XIAO_HONG_SHU)]:"帮我写一个[小红书]风格的文案，采用二极管标题法，内容：在每段话的开头和结尾都使用emoji。文章结尾需要提取 5-8 个#标签，主题是："},I=e=>{let{mainType:t,subType:n}=e;return t?n?"".concat(t,"-").concat(n):t:""},T=e=>{let{mainType:t,subType:n,menuItems:r}=e,i="";if(t!==a.WRITE){var o;i=(null===(o=r.find(e=>e.capability===t))||void 0===o?void 0:o.defaultQuery)||""}let s=I({mainType:t,subType:n});return i||g[s]||""},y=e=>[a.FILE,a.IMAGE].includes(e.capability);function A(){let[e,t]=(0,u.useState)(a.NONE),[n,r]=(0,u.useState)({}),[i,o]=(0,u.useState)(""),[s,c]=(0,u.useState)({}),[l,_,h]=d()({}),f=(0,u.useMemo)(()=>I({mainType:e,subType:i}),[e,i]),g=(0,u.useMemo)(()=>m.includes(e),[e]),T=(0,u.useMemo)(()=>E.includes(e),[e]),y=(0,u.useMemo)(()=>e===a.WEBPAGE,[e]),A=(0,u.useCallback)(e=>e.filter(e=>!!e.capability&&p.includes(e.capability)).sort((e,t)=>p.indexOf(e.capability)-p.indexOf(t.capability)).map((e,t)=>({...e,_id:t})),[]),S=(0,u.useCallback)(()=>{r({}),t(a.NONE),o("")},[]),b=(0,u.useCallback)((e,t)=>{let n=h.current[e]||[],r=!n.find(e=>e.key===t.key);r&&_(r=>({...r,[e]:[...n,t]}))},[h,_]),w=(0,u.useCallback)((e,t)=>{let n=h.current[e]||[],r=n.find(e=>e.key===t.key);if(r){let r=n.filter(e=>e.key!==t.key);_(t=>({...t,[e]:r}))}},[h,_]),v=(0,u.useCallback)(e=>{_(t=>({...t,[e]:[]}))},[_]),O=(0,u.useCallback)(e=>{r(e);let{capability:n}=e;t(n)},[]),k=(0,u.useCallback)(e=>{let{key:t}=e;c(e),o(t)},[]),R=(0,u.useCallback)(()=>{r({}),t(a.NONE),o("")},[]);return(0,u.useEffect)(()=>{let e=localStorage.getItem("checked_menu_items");try{let t=JSON.parse(e);if(null==t)return;_(t)}catch(e){}},[]),(0,u.useEffect)(()=>{localStorage.setItem("checked_menu_items",JSON.stringify(l))},[l]),{mainConverType:e,mainConverItem:n,subConverType:i,subConverItem:s,converType:f,checkedMenuItems:l,isUploadFileConverType:g,isUploadImageConverType:T,isWebReadConverType:y,filterMenuItems:A,checkMenuItem:b,uncheckMenuItem:w,selectMainMenu:O,selectSubMenu:k,backToMainMenu:R,clearConverMenu:S,clearMenuItems:v}}},93322:function(e,t,n){"use strict";n.d(t,{N:function(){return g},d:function(){return m}});var r=n(54829);class i{track(e,t){for(let n in this.eventName=e,this.eventData={},t){let e=t[n];this.eventData[n]="string"!=typeof e?JSON.stringify(e):e}this.time=Date.now()}get(){return{contents:{...this.eventData,eventName:this.eventName},time:this.time}}constructor(){this.eventName="",this.eventData={},this.time=""}}let o=new i,a=[],s=!1,c=async e=>{try{await r.Z.default({url:"https://".concat("ap-nanjing.cls.tencentcs.com","/tracklog?topic_id=").concat("1816edd4-1d80-42f2-9eeb-627715131b4d"),method:"post",data:JSON.stringify({logs:e,source:""}),headers:{"Content-Type":"application/json","x-cls-add-source":"1"}})}catch(e){}},u=async()=>{if(s||0===a.length)return;s=!0;let e=a.splice(0),t=e.reduce((e,t)=>e.concat(t),[]);try{await c(t)}catch(e){}s=!1,l()},l=()=>{a.length>=10?u():a.length>0&&setTimeout(u,5e3)},d=(e,t)=>{o.track(e,t),a.push(o.get()),l()};var p=n(14586);let _=/^\/chat\/[0-9]+/,h=/[0-9]+/,f=[];function m(e,t,n,r){if(_.test(e)){let t=h.exec(e);t&&t[0];let n=f.pop()||{};g("quit_chat",{...n,duration:r-n.time})}if(_.test(t)){let n;let i=h.exec(t),o=i?i[0]:"",a={bot_info:o,source_page:(n="discover",_.test(e)&&(n="my_bot"),n),time:r};g("enter_chat",a),f.push(a)}}let E=null;function g(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"info";E||(E=(0,p.yP)());let i={...t,timestamp:Date.now(),datetime:function(){let e=new Date,t=6e4*e.getTimezoneOffset(),n=new Date(e-t).toISOString().slice(0,-1);return n}(),user_id:(null==t?void 0:t.user_id)||(null==E?void 0:null===(n=E.user)||void 0===n?void 0:n.id),user_info:(null==t?void 0:t.user)||(null==E?void 0:E.user),component_name:"wenxiaobai-web",logLevel:r};d(e,i)}},14586:function(e,t,n){"use strict";n.d(t,{Ub:function(){return b},bN:function(){return T},et:function(){return es},rZ:function(){return ea},CZ:function(){return eP},l8:function(){return q},kT:function(){return ef},xn:function(){return eC},fV:function(){return eu},wI:function(){return en},rQ:function(){return eL},Ss:function(){return K},j4:function(){return L},zK:function(){return em},yP:function(){return ey},y3:function(){return V},w4:function(){return U},qs:function(){return el},$$:function(){return ev},Co:function(){return eM},ej:function(){return e_},qB:function(){return X},Si:function(){return z},bJ:function(){return eO},_h:function(){return er},ep:function(){return _},G$:function(){return h},y2:function(){return ei},YI:function(){return x},Nx:function(){return g},mI:function(){return D},mN:function(){return eo},OP:function(){return eI},oo:function(){return eT},Gr:function(){return eS},Fs:function(){return P},Zo:function(){return ec},Oo:function(){return F},mD:function(){return H},Jf:function(){return G},U1:function(){return m},hU:function(){return $},vh:function(){return eE},pB:function(){return W},S7:function(){return B},xr:function(){return E},CL:function(){return ed},zL:function(){return f},O1:function(){return ew},d8:function(){return ep},OD:function(){return eh},E1:function(){return eR}});var r,i=n(36460),o=n(16392),a=n(37513),s=n.n(a),c=n(91811),u=n.n(c),l=n(71573),d=n.n(l);let p=e=>{var t;let{appConfig:n}=e;return(null==n?void 0:null===(t=n.bot)||void 0===t?void 0:t.id)||"70"},_=e=>{var t;let{appConfig:n}=e;return(null==n?void 0:null===(t=n.homeBottomInputBarBotInfo)||void 0===t?void 0:t.id)||"70"},h=e=>{let{appConfig:t}=e;return(null==t?void 0:t.homeBottomInputBarBotInfo)||(null==t?void 0:t.bot)||{}},f=e=>{let{botId:t,appConfig:n}=e,r=p({appConfig:n});return String(t)===String(r)},m=e=>{let{botId:t,appConfig:n}=e,r=_({appConfig:n});return String(t)===String(r)},E=e=>{let t=d()(e);return u()(t)&&t>0},g=e=>{let{id:t,avatar:n,state:r}=e;return{id:t,alias:"",name:"",description:"",avatar:void 0!==n?n:"https://platform-dev-1319140468.cos.ap-nanjing.myqcloud.com/avatar/bot_avatar/2024/03/01/d4e081dc-0e56-4031-ae2a-27ddbecaf091.png",fullDesc:"",botIndex:0,state:r,openingRemarks:""}};var I=n(60767);let T=["deep_research"],y={deep_research:{isPublic:!1,isShow:!0,userIds:[]},deepseekV3:{isPublic:!1,isShow:!0,userIds:[]},deepseekR1:{isPublic:!1,isShow:!0,userIds:[]},deepseekR2:{isPublic:!0,isShow:!1,userIds:[]}},A="web_beta",S=[],b="_is_new_tag",w=e=>S.includes(e.key),v=e=>e.capability&&I.ALL_MENU_LIST.includes(e.capability),O=(e,t)=>{let n=(null==t?void 0:t.capabilityWhiteList)||y,r=n[e.key];return!!r&&!1===r.isPublic},k=(e,t)=>{let n=(null==t?void 0:t.capabilityWhiteList)||y,r=n[e.key];return!!r&&!0===r.needPay},R=(e,t)=>{let n=(null==t?void 0:t.capabilityWhiteList)||y,r=n[e.key];return(null==r?void 0:r.userIds)||[]},C=(e,t)=>{let n=(null==e?void 0:e.subCapabilities)||[];return{...e,[b]:w(e),[A]:O(e,t)?e.key:"",need_pay:k(e,t)?e.key:"",subCapabilities:n.map(e=>({...e,[b]:w(e),[A]:O(e,t)?e.key:""}))}},N=(e,t,n)=>{let r=(null==t?void 0:t.capabilityWhiteList)||y,i=r[e.key]||{},{isShow:o=!0,userIds:a=[]}=i;return o||a.includes(n)},P=(e,t,n)=>{if(!e[A])return!0;let r=R(e,t);return n&&r.includes(n)},M=(e,t,n)=>{let r={...e},i=(null==r?void 0:r.subCapabilities)||[];return r.subCapabilities=i.filter(e=>P(e,t,n)),P(r,t,n)||T.includes(r.key)?r:null},L=(e,t)=>{var n;let r=ey(),i=(null==r?void 0:null===(n=r.user)||void 0===n?void 0:n.id)||"";return e.filter(v).filter(e=>N(e,t,i)).map(e=>{let{subCapabilities:n}=e;return{...e,subCapabilities:(n||[]).filter(e=>N(e,t,i))}}).map(e=>C(e,t)).map(e=>M(e,t,i)).filter(e=>null!==e)},D=e=>e.subCapabilities||[],x=e=>D(e).length>0,B=e=>{let{capability:t}=e;return[I.EMenuType.FILE,I.EMenuType.IMAGE].includes(t)},U=(e,t)=>e.filter(e=>!B(e)).map(e=>{let n=t[e.key];if(!n)return null;let r=x(e);if(r){let t=D(e);for(let e=0;e<t.length;e++){let r=t[e];if(r.key===n.key&&r.botId===n.botId)return r}}else if(e.key===n.key&&e.botId===n.botId)return e;return null}).filter(e=>null!==e),G=e=>e.capability!==I.EMenuType.OTHER_BOT||["ai_search"].includes(e.key),H=(e,t)=>{let n=t[e.key];return n&&n.key==(null==e?void 0:e.key)&&0===n.botId},W=(e,t,n)=>{let r=t[e.key];return r&&r.key==(null==n?void 0:n.key)&&r.botId==(null==n?void 0:n.botId)},X=(e,t)=>{let n=(null==e?void 0:e.subCapabilities)||[],r=n.find(n=>W(e,t,n))||n[0];return r||e},Y=e=>{let{key:t,capability:n}=e;return[I.EMenuType.FILE,I.EMenuType.IMAGE].includes(n)||n===I.EMenuType.OTHER_BOT&&["deep_think","deep_search"].includes(t)},F=e=>{let{key:t,capability:n}=e;return B(e)||n===I.EMenuType.OTHER_BOT&&["deep_search"].includes(t)},K=(e,t)=>{let n=e.filter(e=>Y(e)),r=t.exclusiveCapabilities,i=r&&Array.isArray(r);return i?n.filter(e=>!r.includes(e.key)):n};function z(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=/wenxiaobai_desktop/.test(e),n=/wenxiaobai_desktop; framework\/electron/.test(e),r=/Windows NT 10.0; Win64; x64; wenxiaobai_desktop/.test(e),i=/Macintosh; Intel Mac OS X 10_15_7; wenxiaobai_desktop/.test(e);return{isDesktop:t,isTauriDesktop:t&&!n,isElectronDesktop:n,isWinDesktop:r,isMacDesktop:i}}let V=e=>new Promise((t,n)=>{let r=new FileReader;r.readAsDataURL(e),r.onload=()=>t(r.result),r.onerror=e=>n(e)});(r||(r={})).ys_think="ys_think";let j=e=>[RegExp("```".concat(e,"[\\s\\S]*?```"),"g"),RegExp("```".concat(e,"[\\s\\S]*$"),"g"),/\[\d+\]\(@ref\)/g,/^\s*[\r\n]+|[\r\n]+\s*$/g],q=e=>{let t=j("ys_think"),n=t.reduce((e,t)=>e.replace(t,""),e);return n},Z=e=>{var t;let n=null==e?void 0:null===(t=e.split("."))||void 0===t?void 0:t.pop();return n||""},J=e=>{let t=e.match(/\/([^\/?#]+)(?:\.[a-zA-Z]{3,4})(?=[?#$]|$)/),n="默认文件名";return t&&(n=t[1]),n},Q=e=>{let t=Z(e),n=J(e);return{filename:n,suffix:t}},$=e=>{let t=Z(e);return t&&["jpg","jpeg","png","gif","bmp","webp"].includes(t)},ee=(e,t)=>{fetch(e).then(e=>e.blob()).then(n=>{let r=URL.createObjectURL(n),i=document.createElement("a"),{suffix:o,filename:a}=Q(e),s=t||a;i.href=r,i.download=o?"".concat(s,".").concat(o):s,i.click(),URL.revokeObjectURL(r)}).catch(e=>{})},et=(e,t)=>{let n=document.createElement("a");n.href=e,n.download=t||J(e),document.body.appendChild(n),n.click(),document.body.removeChild(n)},en=(e,t)=>{$(e)?ee(e,t):et(e,t)},er=e=>e&&e.user&&"string"==typeof e.user.phone&&""!==e.user.phone,ei=e=>!e||!e.user||e.user.isTourist,eo=()=>{let e=window.location.origin?window.location.origin:"",t=window.location.href?window.location.href:"";return{origin:e,href:t}},ea="login_redirect_url",es="weachtQrcodeContainer",ec=e=>{let{containerId:t,redirectUrl:n}=e;if(window&&window.WxLogin){let e="".concat(window.location.origin,"/transfer/wechatLogin");new WxLogin({self_redirect:!0,id:t,appid:"wx9492d4465ef37327",scope:"snsapi_login",redirect_uri:"".concat(e,"?").concat(ea,"=").concat(encodeURIComponent(n),"&"),state:"",style:"",href:"data:text/css;base64,".concat("Ym9keSB7CiAgbWFyZ2luOiAwOwp9Ci5pbXBvd2VyQm94IHsKICB3aWR0aDogMTgwcHg7CiAgaGVpZ2h0OiAxODBweDsKICBib3JkZXItcmFkaXVzOiAxNnB4OwogIG92ZXJmbG93OiBoaWRkZW47CiAgYm94LXNoYWRvdzogMHB4IDQuNXB4IDQ1cHggMHB4IHJnYmEoMCwgMCwgMCwgMC4wOCk7Cn0KLmltcG93ZXJCb3ggLnFyY29kZSB7CiAgd2lkdGg6IDE4MHB4OwogIGJvcmRlcjpub25lOwogIG1hcmdpbi10b3A6IDA7Cn0KLmltcG93ZXJCb3ggLnRpdGxlIHsKICBkaXNwbGF5OiBub25lOwp9Ci5pbXBvd2VyQm94IC5pbmZvIHsKICBkaXNwbGF5OiBub25lOwp9Ci5zdGF0dXNfaWNvbiB7CiAgZGlzcGxheTogbm9uZTsKfQ=="),fast_login:0})}};function eu(e){let{parsedResult:t}=s().getParser(e||window.navigator.userAgent);return"Android"===t.os.name?"Android":"iOS"===t.os.name?"iOS":"macOS"===t.os.name?"macOS":"Windows"===t.os.name?"Windows":"unknown"}function el(){let{userAgent:e}=navigator;return e.match(/edg/i)?"Edge":e.match(/chrome|chromium|crios/i)?"Chrome":e.match(/firefox|fxios/i)?"Firefox":e.match(/safari/i)?"Safari":e.match(/opr\//i)?"Opera":e.match(/netscape/i)?"Netscape":e.match(/msie|trident/i)?"IE":e.match(/huaweibrowser/i)?"Huawei Browser":"unknown"}function ed(){if(!window.navigator)return!1;let e=/MicroMessenger/i.test(window.navigator.userAgent);return e}function ep(e,t,n){let r="";if(n){let e=new Date;e.setTime(e.getTime()+864e5*n),r="; expires="+e.toUTCString()}document.cookie=e+"="+(t||"")+r+"; path=/"}function e_(e){if("undefined"==typeof document||!document.cookie)return null;let t=document.cookie.split("; ");for(let n=0;n<t.length;n++){let r=t[n].split("=");if(r[0]===e)return r[1]}return""}function eh(e,t){let n=ey();n&&n.user&&(n.user[e]=t),ep("login",encodeURIComponent(JSON.stringify(n)),90)}function ef(e){document.cookie="".concat(e,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;")}function em(e,t){if(Array.isArray(e))for(let n=0;n<e.length;++n){let r=e[n];if(r.name===t)return r}return null}function eE(e){if(!e)return!1;let t=e.split("_");return 1===t.length&&32===t[0].length}let eg="";async function eI(){if(!eg&&!(eg=localStorage.getItem("visitorId"))){let e=await o.ZP.load(),t=await e.get();eg="".concat(t.visitorId,"_").concat(function(){let e=Date.now();return"".concat(e,"_").concat(Math.floor(1e6*Math.random()))}()),localStorage.setItem("visitorId",eg)}return eg}function eT(){return e_("visitorId")}function ey(){let e=e_("login");try{let t=decodeURIComponent(e),n=JSON.parse(t);return n}catch(e){return null}}let eA=e=>new Promise((t,n)=>{let r=new FileReader;r.readAsDataURL(e),r.onload=()=>t(r.result),r.onerror=e=>n(e)}),eS=async e=>(e.url||e.preview||(e.preview=await eA(e.originFileObj)),e.url||e.preview),eb="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_";function ew(e){let t="";for(let n=e;n>0;--n)t+=eb[Math.floor(Math.random()*eb.length)];return t}function ev(){return window.visualViewport?window.visualViewport.height:window.innerHeight}function eO(){var e;let t,n;if("undefined"==typeof navigator)return;let{userAgent:r}=navigator;return e=r.toLocaleLowerCase(),t="",n="",/iphone|ipad|ipod/.test(e)?t="ios":/android/.test(e)&&(t="android"),/MicroMessenger/i.test(e)&&(n="wx"),{env:t,app:n}}let ek="TIMEOUT_STORAGE";function eR(e,t){let n=eN();n||(n={});let r=n[e];if(r){let e=!1;for(let n=0;n<r.turnList.length;++n)if(r.turnList[n].turnId===t.turnId){e=!0,r.turnList[n]=t;break}e||r.turnList.push(t)}else r={conversationId:e,turnList:[t]};n[e]=r,localStorage.setItem(ek,JSON.stringify(n))}function eC(e,t){let n=eN();if(n&&n[e]){let r=n[e];r.turnList=r.turnList.filter(e=>e.turnId!==t),n[e]=r,localStorage.setItem(ek,JSON.stringify(n))}}function eN(){try{let e=localStorage.getItem(ek);return JSON.parse(e)}catch(e){return null}}function eP(e){let t=eN();t&&(t[e]=null),localStorage.setItem(ek,JSON.stringify(t))}function eM(e){let t=RegExp("``` ys_imgs.*?```","gs"),n=/header count (\d+)\n/,r=e.match(t),i=0;if(Array.isArray(r))for(let e=0;e<r.length;++e){let t=r[e].match(n);if(Array.isArray(t)&&t.length>1){let e=parseInt(t[1]);"number"!=typeof e||isNaN(e)||(i+=e)}}return i}let eL=async()=>{let e=localStorage.getItem("mistiming")||null;try{var t;let n=await (0,i.Z0)();(null==n?void 0:n.code)===0&&(null==n?void 0:null===(t=n.data)||void 0===t?void 0:t.serverTimeMs)&&(e=n.data.serverTimeMs-Date.now(),localStorage.setItem("mistiming",e.toString()))}catch(e){}}},28493:function(e,t,n){"use strict";n.r(t),n.d(t,{TrackProvider:function(){return p},expTrackIns:function(){return d},mapPathToPage:function(){return l},useTrack:function(){return _}});var r=n(57437),i=n(97179),o=n(14586),a=n(24033),s=n(2265);let c=(0,s.createContext)(null),u=0,l=e=>"/"===e?i.fK.LOGIN.key:"/chat/settings"===e?i.fK.SETTING.key:"/chat/discovery"===e?i.fK.DISCOVERY.key:/\/share\/chat\/([A-Za-z0-9+/]+)/.test(e)?i.fK.SHARE_CHAT.key:/\/share\/card\/([A-Za-z0-9+/]+)/.test(e)?i.fK.SHRE_CARD.key:i.fK.CHAT.key,d=null;function p(e){let{children:t}=e,[i,p]=(0,s.useState)(null),[_,h]=(0,s.useState)([]),[f,m]=(0,s.useState)({}),[E,g]=(0,s.useState)({});(0,a.usePathname)(),(0,s.useEffect)(()=>{let e=async()=>{if(u)return;u=1;let e=(await n.e(5262).then(n.t.bind(n,98826,23))).default;(d=new e({tencentProps:{appkey:"0WEB05SIJX95RJ4N",appid:"",openid:""},hsProps:{appid:"20001987"}})).init().then(()=>d.getWebId()).then(e=>{localStorage.setItem("webId",e)}).catch(e=>{}),g({"client_info.device_id":await (0,o.OP)()}),p(d)};e()},[]),(0,s.useEffect)(()=>{i&&(Object.keys(f).length>0&&(i.storeCommonAttrs(f),m({})),_.length>0&&(_.forEach(e=>i.track(e.eventName,e.attrs,e.callback)),h([])),Object.keys(E).length>0&&(i.setCommonAttrsToSDK(E),g({})))},[i,_,f,E]);let I=(0,s.useCallback)((e,t,n)=>{i?i.track(e,t,n):h(r=>{let i=[...r];return i.push({eventName:e,attrs:t,callback:n}),i})},[i]),T=(0,s.useCallback)(e=>{i?i.storeCommonAttrs(e):m(t=>{let n={...t,...e};return n})},[i]),y=(0,s.useCallback)(e=>{i?i.setCommonAttrsToSDK(e):g(t=>{let n={...t,...e};return n})},[i]),A=(0,s.useCallback)(()=>{let e=Date.now(),t=document.title,n=window.location.href,r=window.location.pathname,i=l(r);I("web_exposure",{bhv_type:"exposure",page:i,time:e,url:n,url_path:r,title:t},()=>{})},[I]);return(0,r.jsx)(c.Provider,{value:{track:I,setCommonData:T,setCommonAttrsToSDK:y,webExposureTrack:A},"data-sentry-element":"Track.Provider","data-sentry-component":"TrackProvider","data-sentry-source-file":"track.tsx",children:t})}function _(){return(0,s.useContext)(c)}},23851:function(e,t,n){"use strict";n.d(t,{zc:function(){return _},FZ:function(){return p},ZP:function(){return g}});var r=n(97179),i=n(14586),o=n(30327);let a={API_RESP_CONSUMPTION:"API_RESP_CONSUMPTION",API_RESP_LOG:"API_RESP_LOG"};var s=n(28493),c=n(93322);let u=()=>window.SMSdk?new Promise(e=>{let t="",n=!1,r=setTimeout(()=>{t=window.SMSdk.getDeviceId?window.SMSdk.getDeviceId():t,n||(n=!0,e(t))},100);window.SMSdk.ready(()=>{t=window.SMSdk.getDeviceId?window.SMSdk.getDeviceId():t,clearTimeout(r),n||(n=!0,e(t))})}):Promise.reject(Error("数美 SDK 未初始化: SMSdk is undefined"));var l=n(34559),d=n.n(l);let p=d()({appName:"wanyu",appVersion:"2.8.0",appVersionCode:"2.1.5"}),_={json:"application/json",stream:"text/event-stream",form:"application/x-www-form-urlencoded; charset=UTF-8",download:"application/octet-stream",upload:"multipart/form-data"};function h(e){try{var t,n,r,i,o;let u=new Date().getTime(),l=(null===(t=e.config)||void 0===t?void 0:t.meta)?u-e.config.meta.startTime:-1,d=(null===(n=e.config)||void 0===n?void 0:n.url)||"",p=d.split("?")[0];e.status&&e.status>=200&&e.status,(0,c.N)(a.API_RESP_CONSUMPTION,{msg:JSON.stringify({url:p,start_time:null===(i=e.config)||void 0===i?void 0:null===(r=i.meta)||void 0===r?void 0:r.startTime,end_time:u,duration:l})}),s.expTrackIns&&"function"==typeof s.expTrackIns.track&&s.expTrackIns.track("api",{bhv_type:"network",url:p,duration:l,status_code:e.status,api_code:null===(o=e.data)||void 0===o?void 0:o.code,config:JSON.stringify(e.config),data:JSON.stringify(e.data)})}catch(e){}}new Headers({"Content-Type":_.json}),p.interceptors.response.use(e=>{var t,n,o;h(e);let{data:s}=e,{code:u}=s||{};switch(u){case r.n8.SUCCESS:return(0,c.N)(a.API_RESP_LOG,{msg:JSON.stringify({url:null===(t=e.config)||void 0===t?void 0:t.url,...e})}),s;case r.n8.NEED_LOGIN:case r.n8.LOGIN_IS_BANNED:case r.n8.TOKEN_INVALID:case r.n8.TOKEN_EXPIRE:case r.n8.TOKEN_REQUIRE:case r.n8.VISITORID_REQUIRE:case r.n8.VISITORID_EXPIRE:case r.n8.VISITORID_MISMATCH:case r.n8.VISITORID_INVALID:(0,i.kT)("login"),(null===(o=window)||void 0===o?void 0:null===(n=o.location)||void 0===n?void 0:n.pathname)!==r.kC&&(window.location.href=r.kC);return;default:return s}},e=>(h(e),{code:999,msg:"网络开小差，请稍后重试"}));let f=async e=>{try{let t=(null==e?void 0:e.headers)||{},n=await u();t["X-Yuanshi-SM-DeviceId"]=n,e.headers=t}catch(e){}},m=async e=>{try{let t=localStorage.getItem("webId")||"";e.headers={...e.headers,"X-Yuanshi-source":JSON.stringify({volc_did:t||""})}}catch(e){}},E=async e=>null==e?Promise.reject("Invalid requset config."):(e.meta={startTime:new Date().getTime()},localStorage.getItem("mistiming")||await (0,i.rQ)(),await f(e),await m(e),e.__trackingMeta={isServiceRequest:!0,startTime:new Date().getTime()},o.default.trackApiWithSentry(e,p(e)));var g=E},36460:function(e,t,n){"use strict";n.d(t,{Hj:function(){return _},Hx:function(){return l},Jf:function(){return a},QB:function(){return d},QJ:function(){return u},Z0:function(){return E},aH:function(){return s},eF:function(){return h},iW:function(){return f},kS:function(){return p},ps:function(){return m},x4:function(){return c}});var r=n(97179),i=n(14586),o=n(23851);let a={method:"POST",url:"".concat((0,r.Xg)(r.tW),"/codes"),data:{phone:""},headers:{}};function s(e){let t=(0,i.yP)(),n=(0,i.oo)();return t&&t.token&&(e.headers={...e.headers,"X-Yuanshi-Authorization":"Bearer "+t.token,"X-Yuanshi-DeviceId":n}),(0,o.ZP)(e)}async function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=localStorage.getItem("webId"),a="".concat((0,r.Xg)(r.tW),"/sessions");e.deviceId=await (0,i.OP)(),e.device=(0,i.qs)(),e.client="web";let s=new URL(window.location.href),c=s.search?"&":"?";s.search+="".concat(c,"webId=").concat(n),e.extraInfo={url:"".concat(window.location.href,"?webId=").concat(n)};let u=(0,i.yP)(),l=(0,i.oo)(),d={};return u&&u.token&&(d={"X-Yuanshi-Authorization":"Bearer "+u.token,"X-Yuanshi-DeviceId":l}),d={...d,...t},(0,o.ZP)({url:a,method:"POST",data:e,headers:d})}async function u(){let e="".concat((0,r.Xg)(r.tW),"/sessions"),t=await (0,i.OP)(),n={deviceId:t,device:(0,i.qs)(),client:"tourist",phone:t,code:t,extraInfo:{url:window.location.href}};return(0,o.ZP)({url:e,method:"POST",data:n,headers:{}})}async function l(e){let t="".concat((0,r.Xg)(r.tW),"/weChat/callback"),n=await (0,i.OP)(),a={code:e,weChatLoginType:"web",deviceId:n,device:(0,i.qs)(),client:"web",extraInfo:{url:window.location.href}},s=(0,i.yP)(),c=(0,i.oo)(),u={};return s&&s.token&&(u={"X-Yuanshi-Authorization":"Bearer "+s.token,"X-Yuanshi-DeviceId":c}),(0,o.ZP)({url:t,method:"POST",data:a,headers:u})}async function d(){let e=(0,i.oo)(),t=(0,i.yP)();if(!t||!t.token)return Promise.reject({status:408,message:"未登录状态不需要刷新token"});{let n={url:"".concat((0,r.Xg)(r.tW),"/sessions/refresh"),method:"GET",headers:{"X-Yuanshi-Authorization":"Bearer "+((null==t?void 0:t.token)||""),"X-Yuanshi-DeviceId":e}};return(0,o.ZP)(n)}}async function p(e,t){let n=await (0,i.oo)(),a={url:"".concat((0,r.Xg)(r.tW),"/sessions/").concat(e),method:"DELETE",headers:{"X-Yuanshi-Authorization":"Bearer "+t,"X-Yuanshi-DeviceId":n}};return(0,o.ZP)(a)}async function _(e,t,n){let a=await (0,i.oo)(),s={url:"".concat((0,r.Xg)(r.tW),"/users/").concat(e,"/feedback"),method:"POST",headers:{"X-Yuanshi-Authorization":"Bearer "+t,"X-Yuanshi-DeviceId":a,"Content-Type":"multipart/form-data"},data:n};return(0,o.ZP)(s)}async function h(e){let{phone:t,code:n}=e,a=(0,i.oo)(),s=(0,i.yP)(),c={url:"".concat((0,r.Xg)(r.tW),"/phone/bind"),method:"PUT",data:{phone:t,checkCode:n},headers:{"X-Yuanshi-Authorization":"Bearer "+(null==s?void 0:s.token),"X-Yuanshi-DeviceId":a}};return(0,o.ZP)(c)}function f(e){let t=(0,i.oo)(),n=(0,i.yP)(),a={url:"".concat((0,r.Xg)(r.tW),"/users/").concat(n.user.id,"/avatar"),method:"PUT",data:{avatar:e},headers:{"X-Yuanshi-Authorization":"Bearer "+(null==n?void 0:n.token),"X-Yuanshi-DeviceId":t,"Content-Type":o.zc.upload}};try{return(0,o.ZP)(a)}catch(e){return Promise.reject({status:408})}}function m(e){let{key:t,value:n}=e,a=(0,i.oo)(),s=(0,i.yP)(),c={url:"".concat((0,r.Xg)(r.tW),"/users/").concat(s.user.id),method:"PUT",data:{[t]:n},headers:{"X-Yuanshi-Authorization":"Bearer "+(null==s?void 0:s.token),"X-Yuanshi-DeviceId":a}};try{return(0,o.ZP)(c)}catch(e){return Promise.reject({status:408})}}async function E(){let e={url:"".concat((0,r.Xg)(r.tW),"/time/heartbeat"),method:"POST",headers:{}};try{let t=await fetch(e.url,{method:e.method,headers:e.headers});if(!t.ok)throw Error("HTTP error! Status: ".concat(t.status));return await t.json()}catch(e){return Promise.reject({status:408})}}}}]);
//# sourceMappingURL=4660-859099717ea876d0.js.map
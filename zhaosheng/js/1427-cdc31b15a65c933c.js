try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="4c8132e6-0ebc-4ceb-8b21-7aaf2372de9a",e._sentryDebugIdIdentifier="sentry-dbid-4c8132e6-0ebc-4ceb-8b21-7aaf2372de9a")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1427],{9179:function(e,t,n){n.d(t,{R3:function(){return a},b2:function(){return o},dW:function(){return s}});var r=n(85496);let o=40,a={getcoins_show:"getcoins_show",getcoins_click:"getcoins_click",buyview_show:"buyview_show",buyview_click:"buyview_click"},i={SUCCESS:0,LACK:1,PAY_ERROR:2,LOCK:3};function s(e){switch(e){case i.SUCCESS:return r.XG.success;case i.LACK:return r.XG.lack;case i.PAY_ERROR:return r.XG.error;case i.LOCK:return r.XG.lock;default:return r.XG.error}}},85496:function(e,t,n){n.d(t,{M2:function(){return h},x9:function(){return I},XG:function(){return o}});var r,o,a=n(27173);class i{immerSet(e){this.set((0,a.Uy)(e))}constructor(e,t){this.get=t,this.set=e}}var s=n(97179),l=n(14586),u=n(9179),c=n(94368),d=n(66395),v=n(13743);(r=o||(o={})).lack="lack",r.enough="enough",r.lock="lock",r.error="error",r.success="success";class I{constructor(){this.isExpired=!0,this.isShowDeepResearchPayment=!1,this.mode="lack",this.retryParams=null}}class h extends i{updateConversation(e){let{conversationId:t}=this.get();e&&e.conversationId!==t&&this.immerSet(t=>{t.conversationId=e.conversationId,t.chatId=e.chatId,t.isShowDeepResearchPayment=!1,t.mode="lack",t.retryParams=null})}deepResearchPaymentError(e){let{botId:t,conversationId:n,conver:r,responseData:o}=e,{turnId:a,question:i}=r,{coin:l}=o||{},c=(0,u.dW)(null==l?void 0:l.status);this.immerSet(e=>{e.isShowDeepResearchPayment=["lock","lack"].includes(c),e.conversationId=n,e.chatId=r.chatId,e.mode=c,e.turnId=a,e.retryParams={botId:t,conversationId:n,botAlias:"custom",contents:i.contents||"",mediaInfos:i.mediaInfos,strategy:{isRetry:!1,breakingStrategy:0},uuid:n,turnId:r.turnId,turnIndex:0,timeoutRetry:!0,inputWay:s.zY.INPUT_WAY.PROACTIVE,customAttrs:{input_way:s.zY.INPUT_WAY.PROACTIVE},customParams:{capabilities:[{icon:"https://wy-static.wenxiaobai.com/bot-capability/prod/deepresearch.png",title:"小白研报",defaultQuery:"",capability:"otherBot",capabilityRang:2,minAppVersion:"",maxAppVersion:null,botId:210041,botDesc:null,selectedIcon:null,botIcon:null,exclusiveCapabilities:["deep_search","deep_think","deepseekR1","deepseekV3","file","camera","image"],defaultSelected:!1,defaultHidden:!1,key:"deep_research",defaultPlaceholder:"请输入您想深度研究的课题，并描述研究目的、背景、方法和内容等详细要求",isPromptMenu:!1,subCapabilities:[],needTips:!1,promptMenu:!1,_is_new_tag:!1,need_pay:!0}]}}})}updateBalance(){let{isShowDeepResearchPayment:e}=this.get();e&&(0,c.wi)().then(e=>{e.validBalance>=u.b2&&this.immerSet(e=>{e.mode="enough"})})}async retry(){var e;let{retryParams:t,conversationId:n}=this.get();t&&((0,l.xn)(n,t.turnId),await (e={conversationId:n,turnId:t.turnId},new Promise((t,n)=>{(0,d.oY)(e).then(e=>{let{code:r,data:o,msg:a}=e||{};0===Number(r)?t(o):n(a)},n)})),new Promise((e,n)=>{try{v.Z.sendMsgToBot({...t,turnId:""}),e(!0)}catch(e){n()}}),this.immerSet(e=>{e.mode="enough",e.retryParams=null,e.isShowDeepResearchPayment=!1}))}constructor(e,t){super(e,t)}}},25815:function(e,t,n){n.d(t,{P:function(){return s}});var r,o,a=n(59115),i=n(85496);let s=(r=i.x9,o=i.M2,(0,a.U)((e,t)=>{let n=new r,a=new o(e,t,void 0),i=function(e){let t=Object.getPrototypeOf(e);return Object.fromEntries(Object.getOwnPropertyNames(t).filter(t=>"constructor"!==t&&"function"==typeof e[t]).map(t=>[t,e[t].bind(e)]))}(a);return{...n,...i}}))},82899:function(e,t,n){n.d(t,{HR:function(){return c},Uf:function(){return o},VD:function(){return a},Yc:function(){return r},Yg:function(){return l},lT:function(){return s},sO:function(){return i},yI:function(){return u}});let r="1",o="SIGN_FLAG",a=1,i=300,s={dailygift_show:"dailygift_show",dailygift_click:"dailygift_click",dailygift_reward_show:"dailygift_reward_show",coin_show:"coin_show",coin_click:"coin_click",cointasklist_show:"cointasklist_show",Cointasklist_coinpay_Click:"Cointasklist_coinpay_Click",Cointasklist_coinpay_Success:"Cointasklist_coinpay_Success"},l=2e3,u=202004,c="LOCAL_BALANCE_SHOULD_UPDATE"},94368:function(e,t,n){n.d(t,{Bb:function(){return s},Ps:function(){return I},VX:function(){return u},YT:function(){return l},ar:function(){return i},hw:function(){return h},qA:function(){return d},sl:function(){return E},su:function(){return c},vd:function(){return f},wi:function(){return v}});var r=n(9992),o=n(82899);let a="网络开小差，请稍后重试";function i(e){return new Promise((t,n)=>{(0,r.Qk)(e).then(e=>{let{code:r,data:o,msg:i}=e||{};0===Number(r)&&(null==o?void 0:o.CodeUrl)&&t({codeUrl:null==o?void 0:o.CodeUrl,orderId:null==o?void 0:o.orderId}),n(i||a)}).then(e=>{n(a)})})}function s(e){return new Promise((t,n)=>{(0,r.Zr)(e).then(e=>{let{code:r,data:o,msg:i}=e||{};0===Number(r)&&(null==o?void 0:o.state)&&t(o.state),n(i||a)},()=>{n(a)})})}function l(e){return new Promise((t,n)=>{(0,r.jl)(e).then(e=>{let{code:r,data:o,msg:i}=e||{};0===Number(r)?t({status:null==o?void 0:o.status}):n(i||a)},()=>{n(a)})})}function u(){return new Promise((e,t)=>{(0,r.yz)().then(n=>{let{code:r,data:o,msg:i}=n||{};0===Number(r)&&Array.isArray(null==o?void 0:o.productList)&&e(null==o?void 0:o.productList.map(e=>(e.price=Number((e.price/100).toFixed()),e))),t(i||a)}).catch(e=>{t(a)})})}function c(e){return new Promise((t,n)=>{(0,r.Zh)(e).then(e=>{let{code:r,data:o,msg:i}=e||{};if(0===Number(r)){var s,l;t({data:Array.isArray(o.recordList)?o.recordList:[],hasMore:null!==(s=o.hasMore)&&void 0!==s&&s,nextCursor:null!==(l=o.nextCursor)&&void 0!==l?l:""})}else n(i||a)}).catch(e=>{n(a)})})}function d(){return new Promise((e,t)=>{(0,r.EG)().then(n=>{let{code:r,data:o,msg:i}=n||{};0===Number(r)&&o&&e(o),t(i||a)})})}function v(){return new Promise((e,t)=>{(0,r.pO)().then(n=>{let{code:r,data:o,msg:i}=n||{};0===Number(r)&&o&&e(o),t(i||a)})})}function I(e){return new Promise((t,n)=>{(0,r.qj)(e).then(e=>{let{code:r,data:o,msg:i}=e||{};0===Number(r)&&Array.isArray(o)&&t(o),n(i||a)}).catch(e=>{n(a)})})}function h(e){return new Promise((t,n)=>{(0,r.W0)(e).then(e=>{let{code:r,data:o,msg:a}=e||{};0===Number(r)&&t(!0),n({code:r,msg:a})}).catch(e=>{n({code:-1,msg:"请稍后重试！"})})})}function E(e){return new Promise((t,n)=>{(0,r.U_)(e).then(e=>{let{code:r,data:a,msg:i}=e;if(0===Number(r)&&Array.isArray(a)){let{taskId:e}=a.find(e=>{let{taskType:t}=e;return String(t)===o.Yc})||{taskId:""};t(e)}n(i)})})}let f=()=>{let e=new Event(o.HR);window.dispatchEvent(e)}},94704:function(e,t,n){n.d(t,{K:function(){return u}});var r=n(99568);let o=[r.He.EXPERT_PERSPECTIVE_START,r.He.THINK_START,r.He.ORGANIZE_START,r.He.WRITE_START,r.He.HTML_START],a=[r.He.EXPERT_PERSPECTIVE,r.He.THINK,r.He.ORGANIZE,r.He.WRITING,r.He.HTML],i=[r.He.EXPERT_PERSPECTIVE_END,r.He.THINK_END,r.He.ORGANIZE_END,r.He.WRITE_END,r.He.HTML_END],s=[r.He.EXPERT_PERSPECTIVE_START,r.He.EXPERT_PERSPECTIVE],l={[r.He.EXPERT_PERSPECTIVE_END]:"我正在进行研究",[r.He.THINK_END]:"我正在思考",[r.He.ORGANIZE_END]:"我正在组织内容",[r.He.WRITE_END]:"我正在进行内容写作",[r.He.HTML_END]:"我正在编写信息可视化代码"},u=e=>{let{deepResearchPre:t,details:n}=e;return n.map(e=>{if(o.includes(null==e?void 0:e.stage)){let n=o.indexOf(null==e?void 0:e.stage);t.push({stage:a[n],content:"",title:null==e?void 0:e.title,isLoading:!s.includes(null==e?void 0:e.stage)})}else if(a.includes(null==e?void 0:e.stage)){let n=a.indexOf(null==e?void 0:e.stage),r=a[n],o=!1;t=(t=t.reverse().map(t=>((null==t?void 0:t.stage)!==r||o||(t={...t,stage:r,content:(null==t?void 0:t.content)+(null==e?void 0:e.content),title:null==e?void 0:e.title,isLoading:!s.includes(null==e?void 0:e.stage)},o=!0),t))).reverse()}else if(i.includes(null==e?void 0:e.stage)){let n=i.indexOf(null==e?void 0:e.stage),r=a[n],o=i[n],s=!1;t=(t=t.reverse().map(t=>((null==t?void 0:t.stage)!==r||s||(t={...t,title:(null==e?void 0:e.title)||l[o],isLoading:!1},s=!0),t))).reverse()}else t.push(e)}),t}},51595:function(e,t){let n=(e,t)=>{let n=new RegExp("<".concat(t,">([^]*?)<\\/").concat(t,">")),r=e.match(n);return r?{value:r[1].trim(),updatedContent:e.replace(r[0],"").trim()}:{value:"",updatedContent:e}},r=(e,t)=>{let r=t,o={icon:"",title:"",content:"",status:"before"},a=n(r,"icon");o.icon=a.value,r=a.updatedContent;let i=n(r,"start");i.value&&(o.title=i.value,o.status="loading"),r=i.updatedContent;let s=n(r,"end");return s.value&&(o.title=s.value,o.status="end"),r=s.updatedContent,o.content=r.trim(),o},o=(e,t)=>{let n="```".concat(t);if(!e.includes(n))return{blockContent:"",remainingContent:e};let r=e.indexOf(n)+n.length,o=e.indexOf("```",r);return -1===o?{blockContent:e.substring(r).trim(),remainingContent:""}:{blockContent:e.substring(r,o).trim(),remainingContent:e.substring(o+3).trim()}};t.Z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ys_think",n={contents:"",target:"",targetInfo:{icon:"",title:"",content:""}},{blockContent:a,remainingContent:i}=o(e,t);return a?(n.target=a,n.contents=i,n.targetInfo=r(t,a)):n.contents=e,n}},24523:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(40654),o=n(34098),a=n.n(o);function i(e){let{onlineSearchPre:t,details:n=[]}=e,o=a()(t);return null==n||n.map(e=>{var n,a,i;(null==e?void 0:e.stage)===r.wr.SEARCH&&(o={content:null==e?void 0:e.content,title:null==e?void 0:e.title,isLoading:!0,type:"title",children:[],level:"primary"}),(null==e?void 0:e.stage)===r.wr.WEB_SEARCH_KEYWORDS&&(null==o||null===(n=o.children)||void 0===n||n.push({content:null==e?void 0:e.content,title:null==e?void 0:e.title,type:"keyword",level:"secondary"})),(null==e?void 0:e.stage)===r.wr.WEB_SEARCH_DETAIL&&(o={...o,webSearchDetail:{...null==e?void 0:e.content,details:((null==e?void 0:null===(a=e.content)||void 0===a?void 0:a.details)||[]).concat((null==t?void 0:null===(i=t.webSearchDetail)||void 0===i?void 0:i.details)||[])}}),(null==e?void 0:e.stage)===r.wr.WEB_SEARCH_DETAIL_END&&(o={...o,type:"title",title:null==e?void 0:e.title,isLoading:!1})}),{detail:o}}},71361:function(e,t,n){n.d(t,{ZP:function(){return u},il:function(){return l}});var r=n(57437),o=n(94052),a=n(67655),i=n(2265),s={components:{Message:{contentBg:"rgba(0, 0, 0, 0.95)",paddingXS:"0 62px",fontSize:28,fontWeight:500,colorText:"#FFFFF",colorInfo:"#FFFFF",borderRadiusLG:1200,boxShadow:"0px 4px 40px 0px rgba(0, 0, 0, 0.20)"}}};let l=()=>{let[e,t]=a.ZP.useMessage();return{messageApi:e,info:t=>{e.open({icon:null,content:(0,r.jsx)("div",{style:{padding:"14px 37px"},children:t}),duration:3,style:{color:"#FFFFFF",fontSize:16,fontWeight:500}})},error:t=>{e.open({icon:null,content:(0,r.jsx)("div",{style:{padding:"14px 37px"},children:t}),duration:3,style:{color:"#FFFFFF",fontSize:16,fontWeight:500}})},MessageContextHolder:(0,r.jsx)(o.ZP,{theme:s,children:t})}};var u=(0,i.forwardRef)((e,t)=>{let[n,l]=a.ZP.useMessage();(0,i.useImperativeHandle)(t,()=>({info:u}));let u=e=>{n.open({icon:null,content:(0,r.jsx)("div",{style:{padding:"14px 37px"},children:e}),duration:3,style:{color:"#FFFFFF",fontSize:16,fontWeight:500}})};return(0,r.jsx)(o.ZP,{theme:s,"data-sentry-element":"ConfigProvider","data-sentry-component":"MyMessage","data-sentry-source-file":"index.tsx",children:l})})},69948:function(e,t,n){n.r(t),n.d(t,{ChatProvider:function(){return u},useChat:function(){return c}});var r=n(57437),o=n(2265),a=n(88915),i=n.n(a);let s="chat_list_open_status",l=(0,o.createContext)(null);function u(e){let{children:t}=e,[n,a]=(0,o.useState)([]),[u,c]=(0,o.useState)({}),[d,v]=(0,o.useState)(0),[I,h]=(0,o.useState)(null),[E,f,_]=i()({}),[p,T]=(0,o.useState)(!0);(0,o.useEffect)(()=>{let e=localStorage.getItem(s);e&&"false"===e&&T(!1)},[]);let S=(0,o.useCallback)(e=>{T(e),localStorage.setItem(s,e?"true":"false")},[]),m=(0,o.useCallback)(e=>{if(n.length<1)a(e);else{let t=[];for(let r of e)n.some(e=>e.conversationId===r.conversationId)||t.push(r);a([...n,...t])}},[n,a]),y=(0,o.useCallback)(e=>{f(t=>({...t,...e}))},[f]),g=(0,o.useCallback)(async(e,t,r,o,i)=>{let s=-1;for(let e=0;e<n.length;++e){var l;if((null===(l=n[e])||void 0===l?void 0:l.conversationId)===i.conversationId){n[e],s=e;break}}let u={botId:e,conversationId:i.conversationId,name:t},c=[...n];-1!==s&&c.splice(s,1),c.unshift(u),a(c)},[n]),A=(0,o.useCallback)(e=>{let t={...u};t[e.id]=e,c(t),h(e)},[u,c]),b=(0,o.useCallback)(e=>{let t=-1;for(let r=0;r<n.length;++r)if(n[r].conversationId===e){t=r;break}if(-1!==t){let e=[...n];e.splice(t,1),a(e)}},[n]),C=(0,o.useCallback)(e=>{let{conversationId:t,conversationName:r}=e,o=n.findIndex(e=>e.conversationId===t);if(-1!==o){let e=n[o],t=[...n];t.splice(o,1,{...e,name:r}),a(t)}},[n]),P=(0,o.useCallback)(()=>{v(1)},[v]),R=(0,o.useCallback)(e=>{e=parseInt(e);for(let t=0;t<n.length;++t)if(n[t].id===e){h(n[t]);break}},[n]);return(0,r.jsx)(l.Provider,{value:{chatList:n,setRefreshChatList:v,refreshList:d,mergeChatList:m,setChatList:a,setChatContent:g,discoveryBot:A,deleteConv:b,setConvName:C,refreshChatList:P,chatBot:I,setChattingBot:R,botInfoMap:E,botInfoMapRef:_,mergeBotInfo:y,chatListOpenStatus:p,changeChatListOpenStatus:S},"data-sentry-element":"ChatContext.Provider","data-sentry-component":"ChatProvider","data-sentry-source-file":"chat.tsx",children:t})}function c(){return(0,o.useContext)(l)}},1427:function(e,t,n){n.r(t),n.d(t,{ConverProvider:function(){return er},useConver:function(){return eo}});var r=n(57437),o=n(25815),a=n(71361),i=n(97179),s=n(66395),l=n(13743),u=n(14586),c=n(33018),d=n(4966),v=n(34098),I=n.n(v),h=n(12068),E=n.n(h),f=n(73897),_=n.n(f),p=n(62067),T=n.n(p),S=n(24033),m=n(2265),y=n(69948),g=n(39177),A=e=>{let{manual:t=!1,conversations:n,currentConversationId:r,curChatBotId:o,beforeSendMsg:a}=e,i=(0,m.useMemo)(()=>{var e,t,o,a,i,s,l,u;let c=null==n?void 0:n[r],d=(null==c?void 0:c.turnList)||[],v=d[0],I=(null==v?void 0:null===(e=v.sentenceList)||void 0===e?void 0:e.length)||0,h={status:null==c?void 0:c.status,turnInfo:v||{},turnId:(null==v?void 0:v.turnId)||"",querySentenceId:(null==v?void 0:null===(o=v.sentenceList)||void 0===o?void 0:null===(t=o[0])||void 0===t?void 0:t.sentenceId)||"",queryInfo:(null==v?void 0:null===(a=v.sentenceList)||void 0===a?void 0:a[0])||{},answerSentenceId:(null==v?void 0:null===(s=v.sentenceList)||void 0===s?void 0:null===(i=s[I-1])||void 0===i?void 0:i.sentenceId)||"",state:(null==v?void 0:null===(u=v.sentenceList)||void 0===u?void 0:null===(l=u[I-1])||void 0===l?void 0:l.state)||"",conversationId:r};return h},[n,r]),u=(0,m.useMemo)(()=>{let e=!!(null==i?void 0:i.turnId)&&!!(null==i?void 0:i.querySentenceId)&&!!(null==i?void 0:i.answerSentenceId)&&!!(null==i?void 0:i.conversationId)&&(null==i?void 0:i.querySentenceId)!=="NEW_SENTENCE_ID"&&(null==i?void 0:i.state)===4;return e},[i]),c=(0,m.useCallback)(()=>{let e=I()(i);null==a||a({turnId:null==i?void 0:i.turnId,sentenceId:null==i?void 0:i.answerSentenceId}),null===l.Z||void 0===l.Z||l.Z.sendMsgToBot({conversationId:null==e?void 0:e.conversationId,turnId:null==e?void 0:e.turnId,answerSentenceId:null==e?void 0:e.answerSentenceId,querySentenceId:null==e?void 0:e.querySentenceId,botId:o,uuid:null==e?void 0:e.conversationId,strategy:{isResume:!0,isRetry:!0}})},[i,o,a,n,r]),d=(0,m.useCallback)(()=>{(0,s.zQ)({conversationId:r,turnId:null==i?void 0:i.turnId,answerSentenceId:null==i?void 0:i.answerSentenceId})},[r,i]);return(0,m.useEffect)(()=>{!t&&u&&c()},[t,u]),{run:c,stop:d}},b=n(28493),C=n(94704),P=n(51595),R=n(24523),N=n(26230);let L=(e,t)=>{if(E()(e)&&E()(t))return e.concat(t)},w=(0,m.createContext)(null),k=e=>{let t="";if(e){let{turnList:n}=e,r=n[n.length-1];if(r){let e=r.sentenceList[0];e&&(t=e.sentTime)}}return t},D=(e,t)=>{let{conversationId:n,turnId:r,sentenceId:o,feedback:a}=e,i=t[n];if(i){let e={...i};for(let t=0;t<e.turnList.length;++t)if(e.turnList[t].turnId===r){let n={...e.turnList[t]};for(let r=0;r<n.sentenceList.length;++r)if(n.sentenceList[r].sentenceId===o){let o={...n.sentenceList[r],feedback:a};return n.sentenceList=[...n.sentenceList],n.sentenceList[r]=o,e.turnList=[...e.turnList],e.turnList[t]=n,e}}}return null},O=(e,t)=>{let{conversationId:n,turnId:r}=e,o=t[n];if(o){let e=[...o.turnList];for(let t=0;t<e.length;++t)if(e[t].turnId===r){let n={...e[t]};n.status="delete",n.turnId="delete_".concat(r),e[t]=n;break}return o.turnList=e,o}return null},x=(e,t)=>{var n,r,o,a,i,s,l,u;let c;let{answer:d,conversationId:v,state:h,appConfig:f,responseData:p}=e,T={...t[v]},S=[...T.turnList],m=0;for(;m<S.length;++m)if((null===(n=S[m])||void 0===n?void 0:n.turnId)===d.turnId){c={...S[m]};break}if(c){let e=!0;c.loading=!1;for(let t=0;t<c.sentenceList.length;++t){let n={...c.sentenceList[t]};if(n.sentenceId===d.sentenceId){if("close"!==h){if(n.breakingStrategy=d.breakingStrategy,n.isBanned=d.isBanned,n.isRetry=d.isRetry,n.loadingEvent=d.loadingEvent,d.answerVisualization){let e=n.extraInfo||{};n.extraInfo={...e,answerVisualization:d.answerVisualization}}if(d.visualizationError){let e=n.extraInfo||{};n.extraInfo={...e,visualizationError:d.visualizationError}}if(d.coin){let e=n.extraInfo||{};n.extraInfo={...e,coin:d.coin}}d.isBanned?n.contents=d.contents||f.bannedResponse:n.contents=d.contents||"",n.loading=!0}if(["ppt"].includes(h)&&d.extraInfo){let e=n.extraInfo||{};n.extraInfo={...e,...d.extraInfo}}if(["webSearchDetail"].includes(h)){let e=n.extraInfo||{},t=I()((null==e?void 0:e.webSearchDetail)||{}),r=(null==d?void 0:d.webSearchDetail)||{},o=_()(t,r,(e,t)=>{if(E()(e)&&E()(t))return e.concat(t)});n.extraInfo={...e,webSearchDetail:o}}if(["deepResearch"].includes(h)){let e=I()(null==n?void 0:null===(o=n.extraInfo)||void 0===o?void 0:null===(r=o.deepResearch)||void 0===r?void 0:r.details)||[],t=(null==d?void 0:null===(i=d.deepResearch)||void 0===i?void 0:null===(a=i.content)||void 0===a?void 0:a.details)||[],s=(0,C.K)({deepResearchPre:e,details:t});n.extraInfo={...n.extraInfo,deepResearch:{details:s}}}if(["onlineSearch"].includes(h)){let e=I()(null==n?void 0:null===(s=n.extraInfo)||void 0===s?void 0:s.onlineSearch)||null,t=(null==d?void 0:null===(u=d.onlineSearch)||void 0===u?void 0:null===(l=u.content)||void 0===l?void 0:l.details)||[],{detail:r}=(0,R.Z)({onlineSearchPre:e,details:t});n.extraInfo={...n.extraInfo,onlineSearch:r}}if(("close"===h||"error"===h||"generateEnd"===h||"needLogin"===h||"needBound"===h)&&(n.loading=!1),"message"===h){let{contents:e,targetInfo:t}=(0,P.Z)(d.contents,"ys_think"),r=n.extraInfo||{};r.thinkInfo=t,n.contents=e,n.extraInfo=r}d.voluntaryStop&&(n.loading=!1),n.voluntaryStop=d.voluntaryStop||!1,e=!1;let v=[...c.sentenceList];v[t]=n,c.sentenceList=v;break}}if(e){let e=d.isBanned?f.bannedResponse:d.contents,t={...d,contents:e,sentenceId:d.sentenceId,direction:2,loading:"before"===h||"message"===h,voluntaryStop:d.voluntaryStop||!1},n=[...c.sentenceList];n.push(t),c.sentenceList=n}c.status=h,p&&(c.eventIndex=(null==p?void 0:p.eventIndex)||-1),c.lastEventIndex=(null==d?void 0:d.lastEventIndex)||-999}return S[m]=c,T.turnList=S,T},U=(e,t)=>{let{conver:n,strategy:r,auth:o}=e,a=t[n.conversationId];if(!a){var i;a={conversationId:n.conversationId,botId:e.botId,userId:null===(i=o.user)||void 0===i?void 0:i.id,turnList:[]}}let s=[...a.turnList];if(!(null==r?void 0:r.isRetry)){let e={turnId:n.turnId,sentenceList:[]};0===r.breakingStrategy&&e.sentenceList.push(n.question),s.unshift(e)}if(null==r?void 0:r.isResume){let e=[...s[0].sentenceList],t=e[e.length-1];e.pop(),e.push({...n.answer,...t}),s[0].sentenceList=e,s[0].turnId=n.turnId}else{let e=[...s[0].sentenceList];e.push(n.answer),s[0].sentenceList=e}return s[0].status="before",a.turnList=s,a},W=(e,t)=>{let{conver:n,strategy:r}=e,o=t[n.conversationId];if(o){o.conversationId=n.conversationId,"timeout"===o.status&&(0,u.CZ)(o.conversationId);let e=[...o.turnList];if(e[0]&&e[0].sentenceList){var a;e[0].turnId=(null==n?void 0:n.turnId)||e[0].turnId;let t=[...e[0].sentenceList];for(let e=0;e<t.length;++e)1===t[e].direction&&0===r.breakingStrategy?t[e]=n.question:2===t[e].direction&&t[e].sentenceId===c.NEW_SENTENCE_ID&&(t[e]=n.answer);e[0].status="open",e[0].lastEventIndex=(null==n?void 0:null===(a=n.answer)||void 0===a?void 0:a.lastEventIndex)||-999,e[0].sentenceList=t}o.turnList=e}return o},Z=(e,t)=>{let{conver:n,strategy:r}=e,o=t[n.conversationId];if(o){o.conversationId=n.conversationId;let e=[...o.turnList];e[0]&&(e[0].turnId=n.turnId,e[0].status="timeout"),o.turnList=e}return{...o,dirty:!0,status:"timeout"}},M=(e,t)=>{let{conver:n,strategy:r}=e,o=t[n.conversationId];if(o){o.conversationId=n.conversationId;let e=[...o.turnList];e[0]&&(e[0].turnId=n.turnId,e[0].status="net_error"),o.turnList=e}return{...o,dirty:!0,status:"net_error"}},B={before:0,timeout:0,open:1,webSearch:2,webSearchDetail:3,onlineSearch:3,deepResearch:3,message:4,generateEnd:5,suggested:6,close:7,error:7,needLogin:7,ppt:6,needBound:8,banned:9},H=function(e,t){let n=B[null==t?void 0:t.status],r=B[e];return(null==t?void 0:t.status)&&r!==n?r>n?e:null==t?void 0:t.status:e},Y={},F={INITIAL_CONVERSATION:"INITIAL_CONVERSATION",MORE_CONVERSATION:"MORE_CONVERSATION",SET_SENTENCE_FEEDBACK:"SET_SENTENCE_FEEDBACK",INSERT_NEW_CONVERSATION:"INSERT_NEW_CONVERSATION",DELETE_TURN_FROM_CONVERSATION:"DELETE_TURN_FROM_CONVERSATION",APPEND_ANSWER:"APPEND_ANSWER",UPDATE_ANSWER:"UPDATE_ANSWER",UPDATE_WEB_SEARCH_DETAIL:"UPDATE_WEB_SEARCH_DETAIL",DELETE_CONVERSATION:"DELETE_CONVERSATION",INSERT_NEW_TURN:"INSERT_NEW_TURN",UPDATE_TURN_TO_OPEN:"UPDATE_TURN_TO_OPEN",UPDATE_TURN_TO_TIMEOUT:"UPDATE_TURN_TO_TIMEOUT",UPDATE_TURN_TO_NET_ERROR:"UPDATE_TURN_TO_NET_ERROR",CREATE_MEDIA_LOADING:"CREATE_MEDIA_LOADING",CLEAR_MEDIA_LOADING:"CLEAR_MEDIA_LOADING",UPDATE_TURN_BY_POLL:"UPDATE_TURN_BY_POLL",CLEAR_TIMEOUT_TURN:"CLEAR_TIMEOUT_TURN",CHANGE_CONVERSATION_STATUS:"CHANGE_CONVERSATION_STATUS",DELETE_LAST_ANSWER:"DELETE_LAST_ANSWER"},X={5106:"needLogin",5013:"needLogin",5014:"needBound"},V=["5106"],z=["5106"];function G(e,t){switch(t.type){case F.INITIAL_CONVERSATION:{let{conversationId:n,data:r}=t.payload;return{...e,[n]:r}}case F.MORE_CONVERSATION:{let{conversationId:n,data:r}=t.payload;return{...e,[n]:{...e[n],...r}}}case F.SET_SENTENCE_FEEDBACK:{let{conversationId:n}=t.payload,r=D(t.payload,e);return null==r?e:{...e,[n]:r}}case F.INSERT_NEW_CONVERSATION:{let{conversationId:n,data:r}=t.payload;return{...e,[n]:r}}case F.DELETE_TURN_FROM_CONVERSATION:{let{conversationId:n}=t.payload,r=O(t.payload,e);return null==r?e:{...e,[n]:{...r,dirty:!0}}}case F.APPEND_ANSWER:{let{conversationId:n}=t.payload,r=H(t.payload.state,e[n]),o=x({...t.payload,state:r},e);return{...e,[n]:{...o,dirty:!0,status:r}}}case F.UPDATE_ANSWER:{let{conversationId:n,sentenceId:r,turnId:o,info:a}=t.payload;return{...function(e,t,n,r,o){var a,i;let s=JSON.parse(JSON.stringify(e)),l=s[t];if(!l)return s;let u=null===(a=l.turnList)||void 0===a?void 0:a.find(e=>e.turnId===n);if(!u)return s;let c=null===(i=u.sentenceList)||void 0===i?void 0:i.find(e=>e.sentenceId===r);return c&&(c.extraInfo={...c.extraInfo||{},...o},s[t].dirty=!0),s}(e,n,o,r,a)}}case F.UPDATE_WEB_SEARCH_DETAIL:{let{conversationId:n,sentenceId:r,turnId:o,webSearchDetail:a}=t.payload;return{...function(e,t,n,r,o){var a,i,s;let l=I()(e),u=l[t];if(!u)return l;let c=null===(a=u.turnList)||void 0===a?void 0:a.find(e=>e.turnId===n);if(!c)return l;let d=null===(i=c.sentenceList)||void 0===i?void 0:i.find(e=>e.sentenceId===r);if(!d)return l;let v=(null===(s=d.extraInfo)||void 0===s?void 0:s.webSearchDetail)||{};return d.extraInfo={...d.extraInfo||{},webSearchDetail:_()(v,o,L)},l[t].dirty=!0,l}(e,n,o,r,a)}}case F.DELETE_CONVERSATION:{let{conversationId:n}=t.payload;return{...e,[n]:{}}}case F.INSERT_NEW_TURN:{var n;let{conversationId:r}=t.payload.conver,o=U(t.payload,e);return{...e,[r]:{...o,dirty:!0,status:(null==t?void 0:null===(n=t.payload)||void 0===n?void 0:n.status)||"before"}}}case F.UPDATE_TURN_TO_OPEN:{let{conversationId:n}=t.payload,r=W(t.payload,e);return{...e,[n]:{...r,dirty:!0,status:"open"}}}case F.UPDATE_TURN_TO_TIMEOUT:{let{conversationId:n}=t.payload,r=Z(t.payload,e);return{...e,[n]:r}}case F.UPDATE_TURN_TO_NET_ERROR:{let{conversationId:n}=t.payload,r=M(t.payload,e);return{...e,[n]:r}}case F.CREATE_MEDIA_LOADING:{let{conversationId:n,inputValue:r}=t.payload,o=J({state:e,conversationId:n,inputValue:r});return{...o}}case F.CLEAR_MEDIA_LOADING:{let{conversationId:n}=t.payload,r=$({state:e,conversationId:n});return{...r}}case F.UPDATE_TURN_BY_POLL:{let{conversationId:n,turnId:r,sentenceId:o,data:a}=t.payload,i=Q({state:e,conversationId:n,turnId:r,sentenceId:o,data:a});return{...i}}case F.CLEAR_TIMEOUT_TURN:{let{conversationId:n,turnId:r}=t.payload,o=K(e,n,r);return{...o}}case F.CHANGE_CONVERSATION_STATUS:{let{conversationId:n,status:r}=t.payload,o=q(e,n,r);return{...o}}case F.DELETE_LAST_ANSWER:{let{conversationId:n,turnId:r}=t.payload,o=j(e,n,r);return{...o}}default:throw Error("Unhandled action type")}}let j=(e,t,n)=>{var r;let o=I()(null===(r=e[t])||void 0===r?void 0:r.turnList),a=o.map(e=>{if(e.turnId!==n)return e;let t=e.sentenceList[e.sentenceList.length-1],r=e.sentenceList.slice(0,-1);return r.push({sentenceId:t.sentenceId,contents:"",direction:2}),e.status="before",{...e,sentenceList:r}});return{...e,[t]:{...e[t],turnList:a}}},q=(e,t,n)=>({...e,[t]:{...e[t],status:n}}),K=(e,t,n)=>{var r;let o=I()(null===(r=e[t])||void 0===r?void 0:r.turnList),a=o[0];return a&&(a.status=""),{...e,[t]:{...e[t],turnList:o}}},Q=e=>{var t;let{state:n,conversationId:r,turnId:o,sentenceId:a,data:i}=e,s=I()(null===(t=n[r])||void 0===t?void 0:t.turnList),l=s.map(e=>{var t,n;if(e.turnId!==o)return e;let r=null==e?void 0:null===(t=e.sentenceList)||void 0===t?void 0:t.findIndex(e=>e.sentenceId===a);-1===r&&(null==e||null===(n=e.sentenceList)||void 0===n||n.push({sentenceId:a,contents:"",state:4,direction:2}));let s=e.sentenceList.map(e=>{var t,n,r,o;if(e.sentenceId!==a)return e;let s=(null==i?void 0:i.ppt)=="{}"?{}:null==i?void 0:i.ppt;return{...e,contents:null==i?void 0:i.message,state:4,extraInfo:{...e.extraInfo,webSearchDetail:(null==i?void 0:i.webSearchDetail)||(null===(t=e.extraInfo)||void 0===t?void 0:t.webSearchDetail),deepResearch:(null==i?void 0:i.deepResearch)||(null===(n=e.extraInfo)||void 0===n?void 0:n.deepResearch),pptInfo:s||(null===(r=e.extraInfo)||void 0===r?void 0:r.pptInfo),answerVisualization:(null==i?void 0:i.answerVisualization)||(null===(o=e.extraInfo)||void 0===o?void 0:o.answerVisualization)}}});return{...e,sentenceList:s}});return{...n,[r]:{...n[r],status:"message",turnList:l}}},J=e=>{var t;let{state:n,conversationId:r,inputValue:o}=e,a=I()(null===(t=n[r])||void 0===t?void 0:t.turnList);return null==a||a.unshift({turnId:"media-loading-id",sentenceList:[{contents:o,mediaInfos:[{q_type:"loading"}],turnIndex:0,direction:1}],status:"open"}),{...n,[r]:{...n[r],turnList:a}}},$=e=>{var t;let{state:n,conversationId:r}=e,o=I()(null===(t=n[r])||void 0===t?void 0:t.turnList);return o=(o||[]).filter(e=>(null==e?void 0:e.turnId)!=="media-loading-id"),{...n,[r]:{...n[r],turnList:o}}},ee={UPDATE_STEP:"UPDATE_STEP",UPDATE_STATE:"UPDATE_STATE",UPDATE_ACT:"UPDATE_ACT",CLEAR_SENTENCE:"CLEAR_SENTENCE"},et={};function en(e,t){switch(t.type){case ee.UPDATE_STEP:{let{uuid:n,turnId:r,sentenceId:o,contents:a}=t.payload,i=n||"".concat(r,"_").concat(o),s=e[i]?{...e[i],step:t.payload.step,status:!0,contents:a}:{step:t.payload.step,status:!0,contents:a};return{...e,[i]:s}}case ee.UPDATE_STATE:{let{turnId:n,sentenceId:r,status:o,uuid:a}=t.payload,i=a||"".concat(n,"_").concat(r),s=e[i]?{...e[i],status:o}:{status:o};return{...e,[i]:s}}case ee.UPDATE_ACT:{let{turnId:n,sentenceId:r,actStatus:o}=t.payload,a="".concat(n,"_").concat(r),i=e[a]?{...e[a],actStatus:o}:{actStatus:o};return{...e,[a]:i}}case ee.CLEAR_SENTENCE:{let{turnId:n,sentenceId:r}=t.payload,o="".concat(n,"_").concat(r);return{...e,[o]:null}}}}function er(e){let{children:t,appConfig:n,auth:c}=e,{setUserLoginModalShow:v}=(0,g.useGlobalExecuteState)(),{botInfoMap:I={}}=(0,y.useChat)()||{},{info:h,MessageContextHolder:E}=(0,a.il)();(0,S.useParams)(),(0,S.useSearchParams)();let f=(0,S.usePathname)(),_=(0,S.useRouter)(),[p,L]=(0,m.useState)(""),D=(0,m.useRef)(""),[O,x]=(0,m.useState)({}),[U,W]=(0,m.useState)({}),[Z,M]=(0,m.useState)({}),[B,H]=(0,m.useState)({}),[j,q]=(0,m.useState)({}),[K,Q]=(0,m.useState)({}),[J,$]=(0,m.useState)(!1),[ee,er]=(0,m.useState)({}),[eo,ea]=(0,m.useState)(""),[ei,es]=(0,m.useState)(""),[el,eu]=(0,m.useState)({}),[ec,ed]=(0,m.useState)((null==n?void 0:n.deepSeekStopText)||"思考已停止"),[ev,eI]=(0,m.useState)(""),{setSideOpen:eh}=(0,N.useViewConfigState)(),[eE,ef]=(0,m.useState)(""),{track:e_}=(0,b.useTrack)(),[ep,eT]=(0,m.useReducer)(G,Y),[eS,em]=(0,m.useReducer)(en,et),[ey,{setTrue:eg,setFalse:eA}]=(0,d.Z)(!0),{run:eb,stop:eC}=A({manual:!1,conversations:ep,currentConversationId:eo,curChatBotId:p,beforeSendMsg:e=>{eT({type:F.DELETE_LAST_ANSWER,payload:{conversationId:eo,turnId:e.turnId,sentenceId:e.sentenceId}})}}),eP="history",eR=(0,m.useCallback)(e=>{ea(e)},[ea]),eN=(0,m.useCallback)(e=>{let{botId:t,conversationId:n}=e;if(!(0,u.xr)(t))return;let r=!!I[t];"/"===f&&r?L(String(t)):_.push("/chat/".concat(t)),eR(n)},[eR,_,I,f]),eL=(0,m.useCallback)(e=>{let{conversationId:t,index:n}=e;eu({...el,[t]:n})},[el]),ew=(0,m.useCallback)(e=>{let{turnId:t,answer:n,end:r,forceStop:o=!1}=e},[em]),ek=(0,m.useCallback)(e=>{eT({type:F.SET_SENTENCE_FEEDBACK,payload:e})},[eT]),eD=(0,m.useCallback)(async e=>{if(!ep[e.conversationId])try{let n=await (0,s.A7)({...e});if(n.code===i.n8.SUCCESS){let r;if(n.data.length<=0)r={conversationId:null==e?void 0:e.conversationId,turnList:[{turnId:"no_data",sentenceList:[{sentenceId:"no_data",contents:"数据异常,清刷新页面",direction:2,state:0}],status:"no_data"}]};else{var t;null==(r=n.data[0])||null===(t=r.turnList)||void 0===t||t.reverse(),null==r||r.turnList.map(e=>{var t;return(null==e?void 0:null===(t=e.sentenceList)||void 0===t?void 0:t.length)>0&&e.sentenceList.map(e=>{var t,n,r,o,a,i,s,l,u,c;if((null==e?void 0:null===(r=e.extraInfo)||void 0===r?void 0:null===(n=r.deepResearch)||void 0===n?void 0:null===(t=n.details)||void 0===t?void 0:t.length)>0&&(e.extraInfo.deepResearch.details=(0,C.K)({deepResearchPre:[],details:(null==e?void 0:null===(l=e.extraInfo)||void 0===l?void 0:null===(s=l.deepResearch)||void 0===s?void 0:s.details)||[]})),(null==e?void 0:null===(i=e.extraInfo)||void 0===i?void 0:null===(a=i.onlineSearch)||void 0===a?void 0:null===(o=a.details)||void 0===o?void 0:o.length)>0){let t=(0,R.Z)({onlineSearchPre:null,details:(null==e?void 0:null===(c=e.extraInfo)||void 0===c?void 0:null===(u=c.onlineSearch)||void 0===u?void 0:u.details)||[]});e.extraInfo.onlineSearch=(null==t?void 0:t.detail)||null}if((null==e?void 0:e.contents)&&(null==e?void 0:e.direction)===2){let{contents:t,targetInfo:n}=(0,P.Z)(e.contents,"ys_think");e.contents=t,e.extraInfo.thinkInfo=n}return e}),e}),null==r||r.turnList.forEach(e=>{var t;if((null==e?void 0:null===(t=e.sentenceList)||void 0===t?void 0:t.length)>0){let t=e.sentenceList[e.sentenceList.length-1];(null==t?void 0:t.state)===4&&(e.status="needResume")}})}eT({type:F.INITIAL_CONVERSATION,payload:{conversationId:r.conversationId,data:{...r,dirty:!1}}})}}catch(e){}},[ep,eT,p]),eO=(0,m.useCallback)(async e=>{let{conversationId:t}=e,n=ep[t],r=k(n);r&&(r=T()(r).subtract(1,"s").format("YYYY-MM-DDTHH:mm:ss"));let o=await (0,s.A7)({...e,startTime:r});if(o&&Array.isArray(o.data)&&o.data.length<1){Q(e=>{let n={...e};return n[t]=!0,n});return}let a=ep[t],i=a?{...a}:{},l=o.data[0];return l.turnList.reverse(),l.conversationId===(null==a?void 0:a.conversationId)?i.turnList=[...i.turnList,...l.turnList]:i.turnList=l.turnList,eT({type:F.MORE_CONVERSATION,payload:{conversationId:i.conversationId,data:i}}),Promise.resolve(i)},[ep,eT,Q]),ex=(0,m.useCallback)(async e=>{let{botId:t,conversationId:n}=e,r=n?{code:0,data:n}:await (0,s.Ki)(t);if(r.code!==i.n8.SUCCESS)return Promise.reject(r);{let e=function(e,t){let n=(0,u.yP)();if(n&&n.user)return{botId:e,userId:n.user.id,turnList:[],conversationId:t}}(t,r.data);return eT({type:F.INSERT_NEW_CONVERSATION,payload:{conversationId:r.data,data:{...e,dirty:!1}}}),e_("chat_input_new_start_btn_click",{page:i.fK.CHAT.key,area:i.fK.CHAT.area.INPUT.key,element:i.fK.CHAT.area.INPUT.element.NEW_START_BTN,bhv_type:"click",is_new_start:1,conversation_id:r.data,is_active_new_start:1,refer_page:eP}),Promise.resolve(r.data)}},[e_,eT]),eU=(0,m.useCallback)((e,t)=>{eT({type:F.DELETE_TURN_FROM_CONVERSATION,payload:{conversationId:e,turnId:t}})},[eT]),eW=(0,m.useCallback)(e=>{let t=ep[e],n=0;if(t){let{turnList:e}=t;for(let t=0;t<e.length;++t)e[t]&&"delete"!==e[t].status&&++n}return n},[ep]),eZ=(0,m.useCallback)(e=>{x(t=>{let n={...t};return n[e]=[],n}),W(t=>{let n={...t};return n[e]=!1,n}),M(t=>{let n={...t};return n[e]=[],n}),H(t=>{let n={...t};return n[e]=!1,n})},[x,W]),eM=(0,m.useCallback)(()=>{},[]),eB=(0,m.useCallback)(()=>{},[]),eH=(0,m.useCallback)(e=>{let{answer:t,conversationId:r,state:o,responseData:a}=e;null!=t&&eT({type:F.APPEND_ANSWER,payload:{answer:t,conversationId:r,state:o,appConfig:n,responseData:a}})},[n,eT]),eY=(0,m.useCallback)(e=>{eT({type:F.UPDATE_ANSWER,payload:{...e,appConfig:n}})},[n,eT]),eF=(0,m.useCallback)(e=>{let{conversationId:t,turnId:n,sentenceId:r,webSearchDetail:o}=e;eT({type:F.UPDATE_WEB_SEARCH_DETAIL,payload:{conversationId:t,turnId:n,sentenceId:r,webSearchDetail:o}})},[eT]),eX=(0,m.useCallback)((e,t)=>{eT({type:F.CREATE_MEDIA_LOADING,payload:{conversationId:e,inputValue:t}})},[eT]),eV=(0,m.useCallback)(e=>{eT({type:F.CLEAR_MEDIA_LOADING,payload:{conversationId:e}})},[eT]),ez=(0,m.useCallback)(e=>{eT({type:F.DELETE_CONVERSATION,payload:{conversationId:e}})},[eT]),eG=(0,m.useCallback)((e,t,n)=>{"message"===e&&n.message.length>1||null==t||e_("chat_sse_event",{conversation_id:t.conversationId,turn_id:t.turnId,q_sentence_id:t.question&&"newSentenceId"!==t.question.sentenceId?t.question.sentenceId:"",a_sentence_id:t.answer&&"newSentenceId"!==t.answer.sentenceId?t.answer.sentenceId:"",content:t.question.contents,sse_event:e,refer_page:eP})},[e_,eP]),ej=(0,m.useCallback)(async e=>{let{conver:t,strategy:n}=e;eT({type:F.INSERT_NEW_TURN,payload:{conver:t,strategy:n,auth:c}}),x(e=>{let n={...e};return n[t.conversationId]=[],n}),W(e=>{let n={...e};return n[t.conversationId]=!1,n}),M(e=>{let n={...e};return n[t.conversationId]=[],n}),H(e=>{let n={...e};return n[t.conversationId]=!1,n}),e.onComplete(),eG("begin",t,{})},[c,eT,eG]),eq=(0,m.useCallback)(e=>{let{conver:t,strategy:n}=e;eT({type:F.UPDATE_TURN_TO_OPEN,payload:{conver:t,strategy:n,conversationId:e.conversationId}});let{customAttrs:r,conversationId:o,turnId:a,answer:i,question:s}=t;x(e=>{let t={...e};return t[o]={conversationId:o,turnId:a,qSentenceId:s.sentenceId,aSentenceId:i.sentenceId,contents:""},t}),M(e=>{let t={...e};return t[o]={conversationId:o,turnId:a,qSentenceId:s.sentenceId,aSentenceId:i.sentenceId,contents:""},t});let l=ep[o];r&&r.eventName&&e_(r.eventName,{conversation_id:o,turn_id:a,q_sentence_id:s.sentenceId,a_sentence_id:i.sentenceId,content:s.contents,is_new_start:l.turnList.length<1?1:0,...r.attrs})},[e_,ep,eT]),eK=(0,m.useCallback)(e=>{var t;let{botId:n,conver:r,responseData:o}=e,{webSearchDetail:a}=r;null===(t=r.answer)||void 0===t||t.extraInfo,eH({answer:{...r.answer,webSearchDetail:a},conversationId:r.conversationId,state:"webSearchDetail",responseData:o}),q(e=>{let t={...e};return t[r.conversationId]={...t[r.conversationId],visibility:!1},t})},[q,eH]),eQ=(0,m.useCallback)(e=>{let{botId:t,conver:n,responseData:r}=e;eH({answer:n.answer,conversationId:n.conversationId,state:"message",responseData:r})},[eH]),eJ=(0,m.useCallback)(e=>{var t;let{botId:n,conver:r,responseData:o}=e,{ppt:a,answer:i}=r,s=(null===(t=r.answer)||void 0===t?void 0:t.extraInfo)||{};eH({answer:{...i,extraInfo:{...s,pptInfo:null==a?void 0:a.content}},conversationId:r.conversationId,state:"ppt",responseData:o})},[eH]),e$=(0,m.useCallback)(e=>{let{botId:t,conver:n,responseData:r}=e,{deepResearch:o,answer:a}=n;eH({answer:{...a,deepResearch:o},conversationId:n.conversationId,state:"deepResearch",responseData:r})},[eH]),e0=(0,m.useCallback)(e=>{let{botId:t,conver:n,responseData:r}=e,{onlineSearch:o,answer:a}=n;eH({answer:{...a,onlineSearch:o},conversationId:n.conversationId,state:"onlineSearch",responseData:r})},[eH]),e1=(0,m.useCallback)(e=>{let{botId:t,conver:n,responseData:r}=e;eH({answer:n.answer,conversationId:n.conversationId,state:"message",responseData:r})},[eH]),e6=(0,m.useCallback)(e=>{let{botId:t,conver:n,responseData:r}=e;eH({answer:n.answer,conversationId:n.conversationId,state:"message",responseData:r}),q(e=>{let t={...e};return t[n.conversationId]={...t[n.conversationId],visibility:!1},t})},[eH,q]),e9=(0,m.useCallback)(e=>{let{botId:t,conver:n,responseData:r}=e;eH({conversationId:n.conversationId,answer:n.answer,state:"message",responseData:r}),q(e=>{let t={...e};return t[n.conversationId]={...t[n.conversationId],visibility:!1},t}),l.Z&&l.Z.stopSse({conversationId:n.conversationId,uuid:n.conversationId})},[eH,q]),e2=(0,m.useCallback)(e=>{let{botId:t,conver:n,responseData:r}=e;eH({answer:n.answer,state:"generateEnd",conversationId:n.conversationId,responseData:r})},[eH]),e5=(0,m.useCallback)(e=>{let{conver:t,timestamp:n,state:r,responseData:o}=e;eH({answer:t.answer,state:"close",conversationId:t.conversationId,responseData:o}),W(e=>{let n={...e};return n[t.conversationId]=!0,n}),H(e=>{let n={...e};return n[t.conversationId]=!0,n}),q(e=>{let n={...e};return n[t.conversationId]=!1,n[t.conversationId]={...n[t.conversationId],visibility:!1},n});try{let e=n.message[0]-n.build,o=n.close-n.build;e_("chat_sse_time_consumption",{conversation_id:t.conversationId,turn_id:t.turnId,a_sentence_id:t.answer.sentenceId,q_sentence_id:t.question.sentenceId,ft_resp_duration:e,comp_resp_duration:o,sse_status:r,content:t.question.contents,answer_length:t.answer.contents.length,refer_page:eP,images_count:(0,u.Co)(t.answer.contents)})}catch(e){}},[eH,e_,q,ep]),e4=(0,m.useCallback)(e=>{let{conver:t,strategy:n}=e;eT({type:F.UPDATE_TURN_TO_TIMEOUT,payload:{...e}}),(0,u.E1)(t.conversationId,{turnId:t.turnId,status:"timeout",sentenceList:[t.question,t.answer]})},[eT]),{deepResearchPaymentError:e3}=(0,o.P)(e=>e),e7=(0,m.useCallback)(e=>{var t,n,r,o,a;let{conver:i,timestamp:s,state:l,onComplete:c,responseData:d}=e;if(-999===l)e4(e);else if(-998===l)eT({type:F.UPDATE_TURN_TO_NET_ERROR,payload:{...e}});else{[9001].includes(l)&&e3(e);let n=X["".concat(l)]||"error";if(V.includes("".concat(l))){let e=(null==i?void 0:null===(t=i.answer)||void 0===t?void 0:t.contents)||"";e&&h(e)}z.includes("".concat(l))&&v(!0),eH({answer:i.answer,state:n,conversationId:i.conversationId,responseData:d})}W(e=>{let t={...e};return t[i.conversationId]=!0,t}),H(e=>{let t={...e};return t[i.conversationId]=!0,t}),c&&c(),q(e=>{let t={...e};return t[i.conversationId]={...t[i.conversationId],visibility:!1},t});try{let e=s.message[0]-s.build,t=s.error-s.build;e_("chat_sse_time_consumption",{conversation_id:i.conversationId,turn_id:i.turnId,a_sentence_id:null===(n=i.answer)||void 0===n?void 0:n.sentenceId,q_sentence_id:null===(r=i.question)||void 0===r?void 0:r.sentenceId,ft_resp_duration:e,comp_resp_duration:t,sse_status:l,content:null===(o=i.question)||void 0===o?void 0:o.contents,answer_length:null===(a=i.answer)||void 0===a?void 0:a.contents.length,refer_page:eP,images_count:(0,u.Co)(i.answer.contents)})}catch(e){}},[eH,q,e_,e4]),e8=(0,m.useCallback)(e=>{let{suggested:t,conversationId:n,turnId:r,question:o,answer:a,customAttrs:i}=e.conver;if(t)try{x(e=>{let s={...e};return s[n]={conversationId:n,turnId:r,qSentenceId:o.sentenceId,aSentenceId:a.sentenceId,customAttrs:i,contents:t},s}),q(e=>{let t={...e};return t[n]={...t[n],visibility:!1},t})}catch(e){}},[q]),te=(0,m.useCallback)(e=>{let{suggestedReco:t,conversationId:n,turnId:r,question:o,answer:a,customAttrs:i}=e.conver;if(t)try{M(e=>{let s={...e};return s[n]={conversationId:n,turnId:r,qSentenceId:o.sentenceId,aSentenceId:a.sentenceId,customAttrs:i,contents:t},s}),q(e=>{let t={...e};return t[n]={...t[n],visibility:!1},t})}catch(e){}},[q]),tt=(0,m.useCallback)(e=>{let{botId:t,conver:n,responseData:r}=e,{webSearch:o}=n;eH({answer:n.answer,conversationId:n.conversationId,state:"webSearch",responseData:r}),q(e=>{let t={...e};return t[n.conversationId]={searchMsg:o,visibility:!t[n.conversationId]||!!t[n.conversationId].visibility},t})},[q,eH]),tn=(0,m.useCallback)(e=>{let{event:t,botId:n,strategy:r,conversationId:o,uuid:a,conver:i,timestamp:s}=e;try{eG(t.event,i,s),t.data?JSON.parse(t.data):t.data}catch(e){}},[eG]);(0,m.useEffect)(()=>{let e=[];return e.push(l.Z.bind("beforeOpen",ej)),e.push(l.Z.bind("open",eq)),e.push(l.Z.bind("loading",eQ)),e.push(l.Z.bind("message",e6)),e.push(l.Z.bind("generateEnd",e2)),e.push(l.Z.bind("banned",e9)),e.push(l.Z.bind("end",e5)),e.push(l.Z.bind("error",e7)),e.push(l.Z.bind("suggestedQuestions",e8)),e.push(l.Z.bind("suggestionReco",te)),e.push(l.Z.bind("webSearch",tt)),e.push(l.Z.bind("trunk",tn)),e.push(l.Z.bind("webSearchDetail",eK)),e.push(l.Z.bind("ppt",eJ)),e.push(l.Z.bind("deepResearch",e$)),e.push(l.Z.bind("answerVisualization",e1)),e.push(l.Z.bind("onlineSearch",e0)),()=>{e.forEach(e=>{e()})}},[ej,e9,eq,e2,tn,tt,eQ,e6,e5,e7,eK,e8,e$,eJ,e1,e0,te]),(0,m.useEffect)(()=>{let e=async()=>{if(!eo&&!ei||eo===ei||p&&!isNaN(Number(p))&&p!==D.current){var e;let t=p&&!isNaN(Number(p))?p:(null==n?void 0:null===(e=n.bot)||void 0===e?void 0:e.id)||"70";try{let e=await (0,s.Ki)(t);0===e.code&&es(e.data)}catch(e){}}};e()},[eo,p]),(0,m.useEffect)(()=>{D.current=p},[p]);let tr=(0,m.useCallback)((e,t,n,r)=>{$(!0),er({conversationId:e,turnId:t,isLastTurn:n,trackParams:r})},[er,$]),to=(0,m.useMemo)(()=>{var e;let t=!1;return null===(e=ep[eo])||void 0===e||e.turnList.forEach(e=>{var n;null==e||null===(n=e.sentenceList)||void 0===n||n.forEach(e=>{var n;(null==e?void 0:null===(n=e.extraInfo)||void 0===n?void 0:n.deepResearch)&&(t=!0)})}),t},[ep,eo]),ta=(0,m.useCallback)((e,t)=>{eT({type:F.CLEAR_TIMEOUT_TURN,payload:{conversationId:e,turnId:t}})},[eT]);return(0,r.jsxs)(w.Provider,{value:{suggestedQuestion:O,conversations:ep,suggestedQuestionShow:U,suggestionReco:Z,suggestionRecoShow:B,webSearch:j,noMore:K,initOneConversation:eD,createNewConv:ex,createTurn:eM,createSection:eB,getMoreHistoryConversation:eO,clearBotConv:ez,setSentenceFeedback:ek,deleteTurnFromConv:eU,confirmDeleteTurn:tr,deleteTurnModalShow:J,setDeleteTurnModalShow:$,deleteTurnInfo:ee,setDeleteTurnInfo:er,deleteSuggestByConversationId:eZ,currentConverTurns:eW,updateAnswer:eY,updateWebSearchDetail:eF,autoIncAnsPrintStep:ew,ansPrintStep:eS,currentConversationId:eo,nextConversationId:ei,changeChatUrl:eR,changeConvLasTurnAnsIdx:eL,lasTurnAnsIdx:el,deepSeekStopText:ec,curChatBotId:p,setCurrentBotId:L,gotoBotChat:eN,createMediaLoadingAction:eX,clearMediaLoadingAction:eV,sendLock:ey,sendLockFalse:eA,sendLockTrue:eg,inputValue:ev,setInputValue:eI,newConverInputValue:eE,setNewConverInputValue:ef,isDeepResearchBot:to,runBreakPointResume:eb,clearTimeoutTurn:ta,stopBreakPointResume:eC},"data-sentry-element":"ConverContext.Provider","data-sentry-component":"ConverProvider","data-sentry-source-file":"conversation.tsx",children:[E,t]})}function eo(){return(0,m.useContext)(w)}},39177:function(e,t,n){n.r(t),n.d(t,{GlobalExecuteStateProvider:function(){return d},useGlobalExecuteState:function(){return v}});var r=n(57437),o=n(97179),a=n(36460),i=n(14586),s=n(2265),l=n(88915),u=n.n(l);let c=(0,s.createContext)({userLoginModalShow:!1,userLoginModalShowRef:{current:!1},setUserLoginModalShow:()=>{},activityModalShow:!1,setActivityModalShow:()=>{},phoneBindModalShow:!1,setPhoneBindModalShow:()=>{},auth:null,hasPhoneNumber:!1,needLogin:!1,needRealLogin:!1,setAuth:()=>{},checkRealLogin:()=>!1,addLoginSuccessCb:()=>{},addLoginFailCb:()=>{},clearLoginSuccessCbs:()=>{},clearLoginFailCbs:()=>{},execLoginSuccessCbs:()=>{},execLoginFailCbs:()=>{},checkLogin:()=>!1,isTourist:!1});function d(e){let{children:t}=e,[n,l]=(0,s.useState)((0,i.yP)()),d=(0,s.useMemo)(()=>n&&n.user&&n.user.phone&&""!==n.user.phone,[n]);(0,s.useEffect)(()=>{},[n,d]);let[v,I,h]=u()(!1),[E,f]=u()(!1),[_,p]=(0,s.useState)(!1),T=(0,s.useRef)([]),S=(0,s.useRef)([]),m=(0,s.useCallback)(e=>{T.current.push(e)},[]),y=(0,s.useCallback)(e=>{S.current.push(e)},[]),g=(0,s.useCallback)(()=>{T.current=[]},[]),A=(0,s.useCallback)(()=>{S.current=[]},[]),b=(0,s.useCallback)(()=>{let e=T.current;g(),e.forEach(e=>e())},[]),C=(0,s.useCallback)(()=>{let e=S.current;A(),e.forEach(e=>e())},[]),P=(0,s.useMemo)(()=>!n||!n.user||n.user.isTourist,[n]),R=(0,s.useMemo)(()=>!n||!n.user||!n.token,[n]),N=(0,s.useCallback)(()=>!P||(I(!0),!1),[P]),L=(0,s.useCallback)(()=>P||R?(I(!0),!1):!!(0,i._h)(n)||(p(!0),!1),[R,P,n,I,p]),w=(0,s.useMemo)(()=>n&&n.user&&n.user.isTourist,[n]);return(0,s.useEffect)(()=>{let e=async()=>{try{let e=(0,i.yP)();if(e&&e.token){let t=await (0,a.QB)();if(t.code===o.n8.SUCCESS&&t.data.token&&t.data.token!==e.token){let n={...e,token:t.data.token};(0,i.d8)("login",encodeURIComponent(JSON.stringify(n)),90),null==l||l(n)}}}catch(e){}},t=(()=>{try{let e=(0,i.yP)();if(e&&e.user&&e.user.isTourist&&e.user.deviceId){let t=e.user.deviceId;if((0,i.vh)(t))return(0,i.kT)("login"),l(null),localStorage.removeItem("visitorId"),(0,i.kT)("visitorId"),window.location.href="/",!0}}catch(e){}})();t||window.top!==window.self||e()},[]),(0,r.jsx)(c.Provider,{value:{userLoginModalShow:v,userLoginModalShowRef:h,setUserLoginModalShow:I,activityModalShow:E,setActivityModalShow:f,phoneBindModalShow:_,setPhoneBindModalShow:p,auth:n,hasPhoneNumber:d,needRealLogin:P,needLogin:R,setAuth:l,checkRealLogin:N,addLoginSuccessCb:m,addLoginFailCb:y,clearLoginSuccessCbs:g,clearLoginFailCbs:A,execLoginSuccessCbs:b,execLoginFailCbs:C,checkLogin:L,isTourist:w},"data-sentry-element":"GlobalExecuteState.Provider","data-sentry-component":"GlobalExecuteStateProvider","data-sentry-source-file":"globalExcute.tsx",children:t})}function v(){return(0,s.useContext)(c)}},26230:function(e,t,n){n.r(t),n.d(t,{ViewConfigProvider:function(){return u},useViewConfigState:function(){return c}});var r=n(57437);let o="system-theme-mode";var a=n(81885),i=n(2265),s=()=>{let[e,t]=(0,i.useState)(a.F.System),[n,r]=(0,i.useState)(a.B.Light);(0,i.useEffect)(()=>{let e=localStorage.getItem(o)||a.F.System;t(e)},[]),(0,i.useEffect)(()=>{let t=window.matchMedia("(prefers-color-scheme: dark)"),n=t=>{if(e===a.F.System){let e=t.matches,n=e?a.B.Dark:a.B.Light;r(n)}};if(t.addEventListener("change",n),e===a.F.System){let e=t.matches,n=e?a.B.Dark:a.B.Light;r(n)}else e===a.F.Light?r(a.B.Light):e===a.F.Dark&&r(a.B.Dark);return()=>{t.removeEventListener("change",n)}},[e]);let s=(0,i.useMemo)(()=>"".concat("root-system-theme-mode-").concat(n),[n]),l=(0,i.useCallback)(()=>{let e=n===a.B.Light?a.B.Dark:a.B.Light;e===a.B.Dark?(t(a.F.Dark),localStorage.setItem(o,a.F.Dark)):e===a.B.Light&&(t(a.F.Light),localStorage.setItem(o,a.F.Light))},[n]),u=(0,i.useMemo)(()=>n===a.B.Light,[n]),c=(0,i.useMemo)(()=>n===a.B.Dark,[n]);return{containerId:"dark-mode-container",theme:n,themeMode:e,themeClassName:s,isLightMode:u,isDarkMode:c,changeThemeMode:e=>{t(e),localStorage.setItem(o,e)},toggleTheme:l}};let l=(0,i.createContext)({containerId:"",themeClassName:"",changeThemeMode:()=>{},toggleTheme:()=>{},theme:a.B.Light,themeMode:a.F.System,isLightMode:!0,isDarkMode:!1,sideOpen:!1,setSideOpen:()=>{},actived:"",setActived:()=>{}}),u=e=>{let[t,n]=(0,i.useState)(!1),[o,a]=(0,i.useState)(""),{containerId:u,themeClassName:c,changeThemeMode:d,toggleTheme:v,theme:I,themeMode:h,isLightMode:E,isDarkMode:f}=s();return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(l.Provider,{value:{containerId:u,themeClassName:c,changeThemeMode:d,toggleTheme:v,theme:I,themeMode:h,isLightMode:E,isDarkMode:f,setSideOpen:n,sideOpen:t,actived:o,setActived:a},"data-sentry-element":"ViewConfigState.Provider","data-sentry-source-file":"viewConfig.tsx",children:e.children})})};function c(){return(0,i.useContext)(l)}},66395:function(e,t,n){n.d(t,{$Q:function(){return m},A7:function(){return u},Bn:function(){return v},Ki:function(){return c},N:function(){return I},Ni:function(){return s},Od:function(){return f},W:function(){return i},WD:function(){return g},Xh:function(){return T},Y3:function(){return l},Zi:function(){return p},b2:function(){return b},dU:function(){return d},jS:function(){return h},n8:function(){return S},oY:function(){return E},sE:function(){return y},tY:function(){return A},zQ:function(){return _}});var r=n(97179),o=n(14586),a=n(23851);async function i(e){let{tag:t=0,lastIdx:n=0,token:i=""}=e,s=(0,o.oo)(),l={url:"".concat((0,r.A6)(r.tW),"/bot/list?tag=").concat(t,"&botIndex=").concat(n),method:"GET",headers:{"X-Yuanshi-DeviceId":s,"X-Yuanshi-Authorization":"Bearer "+i}};return(0,a.ZP)(l)}(0,r.A6)(r.tW);let s={url:"".concat((0,r.A6)(r.tW),"/conversations/names/v1"),method:"GET",heraders:{}};function l(e){let{url:t,userId:n,botId:r,token:i,startTime:s,hasTop:l}=e,u=(0,o.oo)();return e.url=t,e.params={botId:r,startTime:s||void 0,hasTop:!!l},e.headers={"X-Yuanshi-DeviceId":u,"X-Yuanshi-Authorization":"Bearer ".concat(i)},(0,a.ZP)(e)}function u(e){let{botId:t,conversationId:n,turnCount:i=20,startTime:s=""}=e,l=(0,o.oo)(),u=(0,o.yP)();if(!u||!l)return Promise.reject();{let e={url:"".concat((0,r.A6)(r.tW),"/conversations/conversation"),method:"GET",headers:{"X-Yuanshi-Authorization":"Bearer "+u.token,"X-Yuanshi-DeviceId":l},params:{turnCount:i,startTime:s?new Date(s).getTime():null,conversationId:n,botId:t}};return(0,a.ZP)(e)}}async function c(e){let t=(0,o.oo)(),n=(0,o.yP)();if(!n||!t)return Promise.reject();{let o={url:"".concat((0,r.A6)(r.tW),"/conversations/users/").concat(n.user.id,"/bots/").concat(e,"/conversation"),method:"POST",headers:{"X-Yuanshi-Authorization":"Bearer "+n.token,"X-Yuanshi-DeviceId":t},data:{visitorId:t}};return(0,a.ZP)(o)}}async function d(e,t,n,i,s,l){let u=(0,o.oo)(),c={url:"".concat((0,r.A6)(r.tW),"/conversations/users/").concat(e,"/bots/").concat(t,"/turns/").concat(s,"?actions=").concat(i),method:"POST",headers:{"X-Yuanshi-Authorization":"Bearer "+l,"X-Yuanshi-DeviceId":u},data:{messageVo:n}};return(0,a.ZP)(c)}async function v(e,t){let n=(0,o.oo)(),i={url:"".concat((0,r.A6)(r.tW),"/conversations/users/").concat(e,"/bots"),method:"DELETE",headers:{"X-Yuanshi-Authorization":"Bearer "+t,"X-Yuanshi-DeviceId":n}};return(0,a.ZP)(i)}function I(e){let t=(0,o.oo)(),n=(0,o.yP)();if(!n||!t)return Promise.reject();{let o={url:"".concat((0,r.A6)(r.tW),"/conversations/users/").concat(n.user.id,"/bots/").concat(e),method:"DELETE",headers:{"X-Yuanshi-Authorization":"Bearer "+n.token,"X-Yuanshi-DeviceId":t}};return(0,a.ZP)(o)}}function h(e,t){let n=(0,o.oo)(),i=(0,o.yP)();if(!i||!n)return Promise.reject();{let o={url:"".concat((0,r.A6)(r.tW),"/conversations/conversation?conversationId=").concat(t,"&botId=").concat(e),method:"DELETE",headers:{"X-Yuanshi-Authorization":"Bearer "+i.token,"X-Yuanshi-DeviceId":n}};return(0,a.ZP)(o)}}function E(e){let{conversationId:t,turnId:n}=e,i=(0,o.oo)(),s=(0,o.yP)();if(!s||!i)return Promise.reject();{let e={url:"".concat((0,r.A6)(r.tW),"/conversations/").concat(t,"/turns/").concat(n),method:"DELETE",headers:{"X-Yuanshi-Authorization":"Bearer "+s.token,"X-Yuanshi-DeviceId":i}};return(0,a.ZP)(e)}}function f(e){let{botId:t,turnId:n,reportType:i,reportInfo:s}=e,l=(0,o.oo)(),u=(0,o.yP)();if(!u||!l)return Promise.reject();{let e={url:"".concat((0,r.A6)(r.tW),"/conversations/users/").concat(u.user.id,"/bots/").concat(t,"/turns/").concat(n,"/report"),method:"POST",headers:{"X-Yuanshi-Authorization":"Bearer "+u.token,"X-Yuanshi-DeviceId":l},data:{userId:u.user.id,botId:t,turnId:n,reportType:-1==i?[]:[i],reportInfo:s}};return(0,a.ZP)(e)}}function _(e){let{conversationId:t,turnId:n,answerSentenceId:i}=e,s=(0,o.oo)(),l=(0,o.yP)();if(!l||!s)return Promise.reject();{let e={url:"".concat((0,r.A6)(r.tW),"/user/reactions/cancelchat"),method:"POST",headers:{"X-Yuanshi-Authorization":"Bearer "+l.token,"X-Yuanshi-DeviceId":s},data:{conversationId:t,turnId:n,answerSentenceId:i}};return(0,a.ZP)(e)}}function p(e){let{conversationId:t,sentenceIdList:n}=e,i=(0,o.oo)(),s=(0,o.yP)();if(!s||!i)return Promise.reject();{let e={url:"".concat((0,r.A6)(r.tW),"/share/chat"),method:"POST",headers:{"X-Yuanshi-Authorization":"Bearer "+s.token,"X-Yuanshi-DeviceId":i},data:{conversationId:t,sentenceIds:n}};return(0,a.ZP)(e)}}function T(){let e=(0,o.oo)(),t=(0,o.yP)();if(!t||!e)return Promise.reject();{let n={url:"".concat((0,r.A6)(r.tW),"/recommend/icebreaking"),method:"GET",headers:{"X-Yuanshi-Authorization":"Bearer "+t.token,"X-Yuanshi-DeviceId":e}};return(0,a.ZP)(n)}}function S(e){let{keys:t=[]}=e,n=(0,o.oo)(),i=(0,o.yP)();if(!i||!n)return Promise.reject();{let e={url:"".concat((0,r.A6)(r.tW),"/operate/prompt"),data:{keys:t},method:"POST",headers:{"X-Yuanshi-DeviceId":n,"X-Yuanshi-Authorization":"Bearer "+((null==i?void 0:i.token)||"")}};return(0,a.ZP)(e)}}function m(e){let{conversationId:t,name:n,botId:i}=e,s=(0,o.oo)(),l=(0,o.yP)();if(!l||!s)return Promise.reject();{let e={url:"".concat((0,r.A6)(r.tW),"/conversations/conversation/name"),method:"PUT",data:{conversationId:t,name:n,botId:i},headers:{"X-Yuanshi-Authorization":"Bearer "+(null==l?void 0:l.token),"X-Yuanshi-DeviceId":s}};return(0,a.ZP)(e)}}function y(e){let{conversationId:t,turnId:n,sentenceId:i,indexList:s,startIndex:l,endIndex:u}=e,c=(0,o.oo)(),d=(0,o.yP)();if(!d||!c)return Promise.reject();{let e={url:"".concat((0,r.A6)(r.tW),"/websearch"),method:"POST",data:{conversationId:t,turnId:n,sentenceId:i,indexList:s,startIndex:l,endIndex:u},headers:{"X-Yuanshi-Authorization":"Bearer "+(null==d?void 0:d.token),"X-Yuanshi-DeviceId":c}};return(0,a.ZP)(e)}}function g(e,t,n){return(0,a.ZP)({url:"/api/export",method:"POST",timeout:18e4,data:{type:n,title:t,url:e}})}function A(e){let t=(0,o.oo)(),n=(0,o.yP)();if(!n||!t)return Promise.reject();{let o={url:"".concat((0,r.A6)(r.tW),"/conversations/name/top"),method:"POST",data:{conversationId:e},headers:{"X-Yuanshi-Authorization":"Bearer "+(null==n?void 0:n.token),"X-Yuanshi-DeviceId":t}};return(0,a.ZP)(o)}}function b(e){let t=(0,o.oo)(),n=(0,o.yP)();if(!n||!t)return Promise.reject();{let o={url:"".concat((0,r.A6)(r.tW),"/conversations/name/top"),method:"DELETE",data:{conversationId:e},headers:{"X-Yuanshi-Authorization":"Bearer "+(null==n?void 0:n.token),"X-Yuanshi-DeviceId":t}};return(0,a.ZP)(o)}}},9992:function(e,t,n){n.d(t,{EG:function(){return d},Qk:function(){return I},U_:function(){return f},W0:function(){return E},Zh:function(){return u},Zr:function(){return l},jl:function(){return s},ms:function(){return i},pO:function(){return v},qj:function(){return h},yz:function(){return c}});var r=n(97179),o=n(14586),a=n(23851);function i(e){let t=_({path:"/captcha/verify/ticket",method:"POST",data:e,baseUrl:(0,r.A6)(r.tW)});return(0,a.ZP)(t)}function s(e){let t=_({path:"/operate/coin/cost",method:"POST",data:e,baseUrl:(0,r.A6)(r.tW)});return(0,a.ZP)(t)}function l(e){let t=_({path:"/weChatPay/check/order",method:"POST",data:e,baseUrl:(0,r.Xg)(r.tW)});return(0,a.ZP)(t)}function u(e){let t=_({path:"/purchase/record",method:"GET",data:e,baseUrl:(0,r.Xg)(r.tW)});return(0,a.ZP)(t)}function c(){let e=_({path:"/task/coin/product",method:"GET",data:void 0,baseUrl:(0,r.Uz)(r.tW)});return(0,a.ZP)(e)}function d(){let e=_({path:"/reward/balance",method:"GET",data:void 0,baseUrl:(0,r.Uz)(r.tW)});return(0,a.ZP)(e)}function v(){let e=_({path:"/reward/balance_v2",method:"GET",data:void 0,baseUrl:(0,r.Uz)(r.tW)});return(0,a.ZP)(e)}function I(e){let t=_({path:"/weChatPay/prepay/native",method:"POST",data:e,baseUrl:(0,r.Xg)(r.tW)});return(0,a.ZP)(t)}function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{taskId:""},t=_({path:"/task/sign/detail",method:"GET",data:e,baseUrl:(0,r.Uz)(r.tW)});return(0,a.ZP)(t)}function E(e){let t=(0,r.Uz)(r.tW),n=(0,o.yP)(),i=(0,o.oo)(),s="".concat(t).concat("/task/trigger","?taskId=").concat(e.taskId);return(0,a.ZP)({url:s,method:"POST",headers:{"x-api-key":"67b2d4d155a29","X-Yuanshi-DeviceId":i,"X-Yuanshi-Authorization":"Bearer ".concat(null==n?void 0:n.token)}})}function f(e){let t=_({path:"/task/list",method:"GET",data:e,baseUrl:(0,r.Uz)(r.tW)});return(0,a.ZP)(t)}function _(e){let{path:t,method:n="POST",data:a,baseUrl:i=(0,r.Uz)(r.tW)}=e,s=(0,o.yP)(),l=(0,o.oo)(),u="GET"===n?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.entries(t).map(e=>{let[t,n]=e,r=encodeURIComponent(t),o=encodeURIComponent(n.toString());return"".concat(r,"=").concat(o)}).join("&");return n?"".concat(e,"?").concat(n):e}("".concat(i).concat(t),a||{}):"".concat(i).concat(t);return{url:u,method:n,headers:{"x-api-key":"67b2d4d155a29","X-Yuanshi-DeviceId":l,"X-Yuanshi-Authorization":"Bearer ".concat(null==s?void 0:s.token)},data:a}}},13743:function(e,t,n){n.d(t,{F:function(){return s}});var r=n(97179),o=n(14586),a=n(33018);let i=null;{let e=window.localStorage.getItem("webId");i=new a.SseController({auth:(0,o.yP)(),visitorId:(0,o.oo)(),baseUrl:(0,r.A6)(r.tW),commonHeaders:{appName:"wenxiaobai",appVersion:"3.5.0",webId:e}})}function s(){return i||(i=new a.SseController({auth:(0,o.yP)(),visitorId:(0,o.oo)(),baseUrl:(0,r.A6)(r.tW)})),i}t.Z=i},40654:function(e,t,n){var r,o,a,i,s,l,u,c;n.d(t,{He:function(){return r},ZI:function(){return a},tM:function(){return o},wr:function(){return i}}),(s=r||(r={})).EXPERT_PERSPECTIVE_START="expertStart",s.EXPERT_PERSPECTIVE="expert",s.EXPERT_PERSPECTIVE_END="expertEnd",s.THINK_START="thinkingStart",s.THINK="thinking",s.THINK_END="thinkingEnd",s.SEARCH_WEB="search_web",s.READ_WEBPAGE="read_webpage",s.READ_MORE_FROM_WEBPAGE="read_more_from_webpage",s.TOOL_WEB_SEARCH_DETAIL="toolWebSearchDetail",s.ORGANIZE_START="organizingStart",s.ORGANIZE="organizing",s.ORGANIZE_END="organizingEnd",s.WRITE_START="writingStart",s.WRITING="writing",s.WRITE_END="writingEnd",s.HTML_START="htmlStart",s.HTML="html",s.HTML_END="htmlEnd",s.VISUALIZATION="visualization",s.ARTICLE_TITLE="articleTitle",s.END="researchEnd",(l=o||(o={})).PDF="pdf",l.DOCX="docx",(u=a||(a={})).DEEP_RESEARCH_WRITE="deep_research_write",u.NORMAL_CHAT="normal_chat",(c=i||(i={})).SEARCH="search",c.WEB_SEARCH_KEYWORDS="webSearchKeywords",c.WEB_SEARCH_DETAIL="webSearchDetail",c.WEB_SEARCH_DETAIL_END="onlineSearchEnd"},99568:function(e,t,n){n.d(t,{He:function(){return a.He},yq:function(){return o},ZI:function(){return a.ZI},tM:function(){return a.tM}}),(r=o||(o={}))[r.ON_LINE=0]="ON_LINE",r[r.OFF_LINE=1]="OFF_LINE";var r,o,a=n(40654)},81885:function(e,t,n){var r,o,a,i;n.d(t,{B:function(){return r},F:function(){return o}}),(a=r||(r={})).Light="light",a.Dark="dark",(i=o||(o={})).Light="light",i.Dark="dark",i.System="system"}}]);
//# sourceMappingURL=1427-cdc31b15a65c933c.js.map
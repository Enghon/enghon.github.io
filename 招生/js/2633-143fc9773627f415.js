try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="cf9865b9-9c6d-4044-a902-1e3171a428ff",e._sentryDebugIdIdentifier="sentry-dbid-cf9865b9-9c6d-4044-a902-1e3171a428ff")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2633],{71162:function(e,t,n){"use strict";n.d(t,{Em:function(){return o},Wz:function(){return s},aU:function(){return a}});let a=[{title:"置顶",filterFn:e=>!!e.top,filterTimeStampRange:-1/0,id:0},{title:"今天",filterTimeStampRange:864e5,id:1},{title:"昨天",filterTimeStampRange:1728e5,id:2},{title:"近7日",filterTimeStampRange:6048e5,id:7},{title:"更早",filterTimeStampRange:1/0,id:-1}],s="未命名",o="未命名对话"},71895:function(e,t,n){"use strict";n.d(t,{Z:function(){return C}});var a=n(59115);class s{constructor(e,t){this.get=t,this.set=e}}var o=n(97179),i=n(27173),r=n(2890),l=n.n(r),c=n(71162),d=n(66395),_=n(13743);let u="网络开小差，请稍后再试！";function m(e){return new Promise((t,n)=>{(0,d.Y3)({...d.Ni,...e}).then(e=>{let{code:a,data:s,msg:o}=e;if(0===Number(a)){let e=s.conversationInfos[s.conversationInfos.length-1];t({list:s.conversationInfos,botInfo:s.botInfo,hasTop:s.hasTop,cursor:e?e.updateTime:0})}n(o)},e=>{n(e)})})}async function p(e){let{conversationId:t}=e;return(0,d.tY)(t)}async function h(e){let{conversationId:t}=e;return(0,d.b2)(t)}function v(e){if(window){let t=document.querySelectorAll("div[data-conversation-id='".concat(e,"']"));t.length&&t[0].scrollIntoView({behavior:"smooth",block:"start"})}}var f=n(57255),x=n.n(f);class g{constructor(){this.list=[],this.renderGroupList=[],this.scrollControl={cursor:0,hasMore:!0},this.selectedRecord=null,this.botInfo={},this.fetchListParams={botId:0,userId:"",token:"",startTime:0,hasTop:!0},this.loading=!1,this.auth=null,this.infoFunc=null}}class b extends s{fetchList(){let{fetchListParams:e}=this.get();this.nextFetchList(e)}nextFetchList(e){return new Promise((t,n)=>{let{auth:a}=this.get();a&&m(e).then(n=>{let a=this.mergeList(n.list),s=this.mergeScrollControl(n.cursor);this.updateStore({list:a,renderGroupList:this.generateRenderGroupList(a),botInfo:this.mergeBotInfo(n.botInfo),scrollControl:s,fetchListParams:{...e,startTime:n.cursor,hasTop:n.hasTop},loading:!1}),t(n.list)},n)})}async resetList(){let{fetchListParams:e}=this.get(),{auth:t}=this.get();return t?await m({...e,startTime:0,hasTop:!0}).then(t=>{let n=t.list,a=this.mergeScrollControl(t.cursor);return this.updateStore({list:n,renderGroupList:this.generateRenderGroupList(n),botInfo:this.mergeBotInfo(t.botInfo),scrollControl:a,fetchListParams:{...e,startTime:t.cursor,hasTop:t.hasTop},loading:!1}),n}):[]}selectedConversation(e){this.updateStore({selectedRecord:e})}async pinConversation(e){let t=await p({conversationId:e.conversationId}),{code:n}=t;n===o.n8.SUCCESS&&this.fetchListFindRecord(e.conversationId).then(t=>{v(e.conversationId)})}async unpinConversation(e){let t=await h({conversationId:e.conversationId}),{code:n}=t;n===o.n8.SUCCESS&&this.resetList()}modifyName(e,t){var n;if(e.name===t)return;let{botId:a,conversationId:s}=e;(n={botId:a,conversationId:s,name:t},new Promise((e,t)=>{(0,d.$Q)(n).then(n=>{let{code:a,data:s,msg:o}=n;0===Number(a)?e(!0):t(o)},()=>{t(u)})})).then(e=>{e&&this.modifyRecord(s,{name:t})}).catch(e=>{this.message(e)})}addRecord(e){let{list:t}=this.get();if(t.find(t=>t.conversationId===e.conversationId))return;let n=[e,...t];this.updateStore({list:n,renderGroupList:this.generateRenderGroupList(n),selectedRecord:e})}addConversationEnd(e){let{list:t}=this.get();t.find(t=>t.conversationId===e)?this.fetchListFindRecord(e).then(t=>{this.updateStore({selectedRecord:t}),v(e)}):this.resetList()}fetchListFindRecord(e){return new Promise(async(t,n)=>{let a=await this.resetList().then(t=>{let n=t.find(t=>t.conversationId===e);return n});if(a)t(a);else{let n=10;for(;n>0;){n--;let{fetchListParams:a}=this.get(),s=await this.nextFetchList(a),o=s.find(t=>t.conversationId===e);if(o){t(o);return}await this.sleep(1500)}}})}sleep(e){return new Promise(t=>{setTimeout(t,e)})}updateInfoFunc(e){this.updateStore({infoFunc:e})}modifyRecord(e,t){let{list:n}=this.get(),a=n.map(n=>n.conversationId===e?{...n,...t}:n);this.updateStore({list:a,renderGroupList:this.generateRenderGroupList(a)})}deleteRecord(e){var t;return(t={conversationId:e.conversationId,botId:e.botId},new Promise(async(e,n)=>{await _.Z.stopSse({conversationId:t.conversationId,uuid:t.conversationId}),(0,d.jS)(t.botId,t.conversationId).then(t=>{let{code:a,msg:s}=t;0===Number(a)?e("删除成功！"):n(s)},()=>{n(u)})})).then(t=>(this.message(t),this.removeRecord(e),t),e=>{let{infoFunc:t}=this.get();return this.message(e),Promise.reject(e)})}message(e){let{infoFunc:t}=this.get();t&&t(e)}removeRecord(e){let{list:t}=this.get(),n=t.filter(t=>t.conversationId!==e.conversationId);this.updateStore({list:n,renderGroupList:this.generateRenderGroupList(n)})}authUpdate(e,t){var n,a;let{fetchListParams:s}=this.get(),o={...s,userId:null!==(n=null==e?void 0:e.userId)&&void 0!==n?n:"",token:null!==(a=null==e?void 0:e.token)&&void 0!==a?a:""};this.set((0,i.Uy)(n=>{n.fetchListParams=o,n.auth=e,n.appConfig=t}))}mergeScrollControl(e){let{scrollControl:t}=this.get();return{...t,cursor:e,hasMore:e!==t.cursor}}generateRenderGroupList(e){let t=function(e,t){if(0===e.length)return t.map(e=>({title:e.title,data:[]}));let n=function(){let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate());return t.getTime()+864e5-1}(),[a,s]=x()(t,e=>e.filterFn&&"function"==typeof e.filterFn),{results:o,rest:i}=function(e,t){let n=[],a=[...e];for(let e of t){let t=[],s=[];for(let n of a)e(n)?t.push(n):s.push(n);n.push(t),a=s}return{results:n,rest:a}}(e,a.map(e=>e.filterFn)),r=a.map((e,t)=>({title:e.title,data:o[t]})),l=s.map(e=>({title:e.title,data:[]})),c=s.map(e=>({title:e.title,threshold:n-e.filterTimeStampRange})),d=0,_=c.length-1;for(let e=0;e<c.length-1;e++){var u;let t=c[e].threshold,n=d,a=i.length-1;for(;(null===(u=i[n])||void 0===u?void 0:u.updateTime)>t&&n<=a;)n++;n>d&&(l[e].data.push(...i.slice(d,n)),d=n)}return d<i.length&&l[_].data.push(...i.slice(d)),[...r,...l]}(l().cloneDeep(e),c.aU);return t}mergeList(e){let{list:t}=this.get(),n=l().uniqBy([...t,...e],"createTime");return n}mergeBotInfo(e){let{botInfo:t}=this.get(),n={...t,...e};return n}updateStore(e){this.set((0,i.Uy)(t=>{for(let n in e)t[n]=e[n]}))}constructor(e,t){super(e,t)}}let y=(0,a.U)((e,t)=>{let n=new g,a=new b(e,t,void 0),s=function(e){let t=Object.getPrototypeOf(e);return Object.fromEntries(Object.getOwnPropertyNames(t).filter(t=>"constructor"!==t&&"function"==typeof e[t]).map(t=>[t,e[t].bind(e)]))}(a);return{...n,...s}});var C=y},94107:function(e,t,n){"use strict";n.d(t,{d:function(){return i}});var a=n(54829);let s=async e=>{var t;let n=await a.Z.get("/api/cos/getConfig?name=".concat(e));return null==n?void 0:null===(t=n.data)||void 0===t?void 0:t.data};var o=n(19404);let i=e=>{let t=(0,o.Z)(()=>s(e));return t}},41664:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return no}});var a,s,o,i,r,l,c=n(57437),d=n(57281),_=n(69948),u=n(18804),m=n(16063),p=n(71361),h=n(97179),v=n(28493),f=n(51387),x=n(2265),g=n(77601),b=n.n(g);let y=e=>{null==e||e.preventDefault(),null==e||e.stopPropagation()};var C=e=>{let{conversationId:t,nextConversationId:n,children:a,preCheck:s,disabled:o=!1,visible:i=!1,uploadType:r="file"}=e,{inputConvFiles:l}=(0,f.useUploadFile)()||{},d=(0,x.useRef)(null),_=(0,x.useRef)(null),u=(0,x.useRef)(null),[g,C]=(0,x.useState)(!1),k=(0,x.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),C(!0)},[]),{track:j}=(0,v.useTrack)(),I=(0,x.useCallback)(e=>{var t;null===(t=_.current)||void 0===t||t.info(e)},[_]),N=(0,x.useMemo)(()=>h.Re[r]||h.Re.file,[r]),w=(0,x.useMemo)(()=>N.acceptType.join(" ,"),[N]),T=(0,x.useMemo)(()=>{let e="拖拽".concat(N.title,"到这里即可上传");return i&&(e="点击这里或"+e),e},[N,i]),S=(0,x.useMemo)(()=>N.dropUploadTips,[N]),P=(0,x.useCallback)(async e=>{let a=t||n,s=await l(a,e);return s},[t,n,l]),A=(0,x.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy",C(!0)},[]),E=(0,x.useCallback)(e=>{e.currentTarget.contains(e.relatedTarget)||(e.preventDefault(),e.stopPropagation(),C(!1))},[C]),R=(0,x.useCallback)(e=>{let n=t?"chat":"new_conv_guide",a=e.map(e=>({name:e.name,size:e.size,type:e.type,lastModified:e.lastModified}));j("chat_file_upload",{page:n,uplaod_type:"drop",files:a})},[t,j]),M=(0,x.useCallback)((e,t)=>{j("chat_file_upload_error",{status:t,file:e})},[j]),B=(0,x.useCallback)(async e=>{let t=Array.from(e.target.files||[]).filter(e=>e.size>N.sizeLimit?(I(N.exceedSizeMsg),M(e,f.UPLOAD_ERROR_TYPE.SIZE),!1):!e.type||-1!==w.indexOf(e.type)||(I(N.exceedAcceptTypeMsg),M(e,f.UPLOAD_ERROR_TYPE.TYPE),!1)),n=await P(t);n||I(N.exceedTotalLengthMsg),R(orgfiles)},[w,N,I,M,P,R]),D=(0,x.useCallback)(async e=>{e.preventDefault(),e.stopPropagation(),C(!1),("function"!=typeof s||s())&&B(e)},[C,s,B]),L=(0,x.useCallback)(async()=>{try{var e;if("function"==typeof s&&!s())return;null===(e=u.current)||void 0===e||e.click()}catch(e){}},[s,u]),O=(0,x.useCallback)(async e=>{e.preventDefault(),e.stopPropagation(),B(e)},[B]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(p.ZP,{ref:_,"data-sentry-element":"MyMessage","data-sentry-source-file":"DropUpload.tsx"}),(0,c.jsxs)("div",{id:"drop-zone",onDragEnter:o?y:k,onDragOver:o?y:A,onDragLeave:o?y:E,onDrop:o?y:D,className:b().drop_file,ref:d,role:"button","aria-label":"点击或拖放以上传文件",children:[a,(0,c.jsx)("div",{className:"\n            ".concat(i?b().upload_mask_open:b().upload_mask,"\n            ").concat(i?b().cursor:"","\n            ").concat(g?i?b().upload_mask_blur:b().upload_mask_open:""," \n          "),onClick:i&&!o?L:y,children:(0,c.jsxs)("div",{className:b().drop_content,children:[(0,c.jsx)(m.Z,{name:"trayandarrowupfill1",className:b().drop_icon,"data-sentry-element":"IconFont","data-sentry-source-file":"DropUpload.tsx"}),(0,c.jsx)("div",{className:b().drop_title,children:T}),(0,c.jsx)("div",{className:b().drop_desc,children:S})]})}),(0,c.jsx)("input",{ref:u,type:"file",onChange:O,id:"drop-file-input",accept:w,style:{display:"none"},value:"",multiple:N.lengthLimit>1})]})]})},k=n(1427),j=n(39177),I=n(13743),N=n(27173),w=n(59115),T=n(9992);let S=(a={isShow:!1},s=(e,t)=>({setIsShow:t=>e((0,N.Uy)(e=>{e.isShow=t})),createCaptcha:e=>{try{let e=new TencentCaptcha("195256389",e=>{new Promise((t,n)=>{(0,T.ms)(e).then(e=>{t(e)},n)})},{});e.show()}catch(e){}}}),(0,w.U)((e,t)=>{let n=s(e,t);return{...a,...n}})),P=()=>{let{createCaptcha:e,isShow:t}=S(e=>e),n=(0,I.F)();(0,x.useEffect)(()=>{let a=n.bind("error",n=>{t||(null==n?void 0:n.state)!==5107||e();try{n.onComplete()}catch(e){}});return()=>{try{a()}catch(e){}}},[n])};var A=n(73417),E=n(42744),R=n.n(E),M=n(68143),B=n.n(M);n(62067);var D=n(61109),L=n(9189),O=n.n(L),Z=n(94368),F=n(71895);let U=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],{addRecord:t,addConversationEnd:n}=(0,F.Z)(e=>e);(0,x.useEffect)(()=>{let e=[];return e.push(I.Z.bind("beforeOpen",e=>{let n=function(e){let{conver:t,strategy:n,auth:a}=e,s={botId:e.botId,conversationId:t.conversationId,name:"回答生成中...",state:0,createTime:+new Date,updateTime:+new Date,isManuallyModified:0,botAlias:"",botState:"",botKind:"",botInfo:null};return s}(e);t(n);try{e.onComplete()}catch(e){}})),e.push(I.Z.bind("end",e=>{var t;n(null===(t=e.conver)||void 0===t?void 0:t.conversationId),(0,Z.vd)()})),()=>{e.forEach(e=>e())}},[...e])};var V=n(39634),Y=n(77577),K=n.n(Y);let H=()=>{};var z=e=>{let{className:t,onClick:n,loading:a,enable:s}=e;return(0,c.jsx)(V.Z,{title:"分享该对话",placement:"left","data-sentry-element":"Tooltip","data-sentry-component":"ConverShare","data-sentry-source-file":"ConverShare.tsx",children:(0,c.jsx)("div",{className:"".concat(K().share_btn_container," custom_button ").concat(s?"":K().disabled),onClick:s?n:H,children:(0,c.jsx)(m.Z,{className:K().share_icon,name:"share","data-sentry-element":"IconFont","data-sentry-source-file":"ConverShare.tsx"})})})},q=n(66395),W=n(2390),X=n.n(W),G=n(27457),Q=n(13977),J=n(24033),$=n(20532),ee=n(42512),et=n(7856),en=n(64041),ea=n.n(en),es=e=>{let{iconName:t,isActive:n,children:a,disabled:s,loading:o,loadingText:i}=e;return(0,c.jsxs)("div",{className:"\n        ".concat(ea().bottom_icon," \n        ").concat(n?ea().act:""," \n        ").concat(s?ea().disable:"","\n        ").concat(o?ea().loading:"","\n      "),"data-sentry-component":"ChatBottomButton","data-sentry-source-file":"index.tsx",children:[(0,c.jsx)(m.Z,{name:t,"data-sentry-element":"IconFont","data-sentry-source-file":"index.tsx"}),a&&(0,c.jsx)("span",{className:ea().bottom_icon_text,children:o?i:a})]})},eo=n(26230),ei=n(42615),er=n(14074),el=n(16886),ec=n.n(el),ed=n(40263).Buffer,e_=e=>{let{conversationId:t,fileName:n,hideText:a,sentenceIdList:s,canExport:o=!0}=e,[i,r]=(0,x.useState)(!1),[l,d]=(0,x.useState)(!1),{theme:_}=(0,eo.useViewConfigState)(),{downloadUrl:u}=(0,ei.ky)(),m=(0,x.useRef)(null),h=(0,x.useCallback)(e=>{var t;null===(t=m.current)||void 0===t||t.info(e)},[m]),v=async e=>{if(!l){r(!1),d(!0);try{var a;let o=await (0,q.Zi)({conversationId:t,sentenceIdList:s}),i="".concat(o.data.baseUrl,"export/").concat(e,"/").concat(o.data.shareId),r=await (0,q.WD)(i,n,e),l=ed.from(null==r?void 0:null===(a=r.data)||void 0===a?void 0:a.content),c=new Blob([l]);u(URL.createObjectURL(c),"".concat(n,".").concat(e))}catch(e){h("导出失败")}finally{d(!1)}}};return o?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(p.ZP,{ref:m}),(0,c.jsx)(er.Z,{trigger:"click",open:i,overlayInnerStyle:{padding:0},color:"dark"==_?"#a7a7a7":"#fff",onOpenChange:()=>{o&&!l&&r(!i)},arrow:!1,content:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"".concat("dark"==_?ec().raw_btn_dark:ec().raw_btn," ").concat(ec().raw_btn_top),onClick:()=>v("pdf"),children:[(0,c.jsx)("div",{className:"".concat(ec().opt_btn_icon," ").concat(ec().export_file_pdf)}),"PDF"]}),(0,c.jsxs)("div",{className:"".concat("dark"==_?ec().raw_btn_dark:ec().raw_btn," ").concat(ec().raw_btn_bottom),onClick:()=>v("docx"),children:[(0,c.jsx)("div",{className:"".concat(ec().opt_btn_icon," ").concat(ec().export_file_docx)}),"DOCX"]})]}),children:(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(es,{iconName:"chatbottomexport",disabled:l,loading:l,loadingText:"导出中...",children:a?"":"导出"})})})]}):""},eu=(e,t)=>{let n=(0,x.useRef)(!1);(0,x.useEffect)(()=>{t&&!n.current&&(e(),n.current=!0)},[t,e])},em=n(99568),ep=n(14586),eh=n(53912),ev=n.n(eh),ef=e=>{let{loading:t,disabled:n,children:a,onClick:s,className:o}=e;return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("button",{className:R()(null===ev()||void 0===ev()?void 0:ev().button,t||n?ev().disabled:"",o),disabled:t||n,onClick:s,children:t?(0,c.jsx)("span",{className:ev().loader}):a})})},ex=n(1433),eg=n(19404);let eb=e=>({id:null==e?void 0:e.id,taskId:null==e?void 0:e.taskId,thumbnail:null==e?void 0:e.coverUrl}),ey="67b2d4d155a29",eC={fc_plate:[2014,1027,2024],list:["generate","editor"]};var ek=n(91123),ej=n.n(ek);(o=r||(r={})).PPT_Download="ppt_download",o.PPT="ppt",o.Hide="hide";var eI=x.memo(e=>{let{contents:t,conversationId:n,turnId:a,sentenceId:s,status:o,extraInfo:i}=e,{updateAnswer:l}=(0,k.useConver)(),{track:d}=(0,v.useTrack)(),[_,u]=(0,x.useState)(r.Hide),[p,f]=(0,x.useState)({}),[g,b]=(0,x.useState)({}),{downloadUrl:y}=(0,ei.ky)();(0,x.useEffect)(()=>{var e,n;let a=()=>{let e=function(e){let{pptInfo:t,contents:n}=e,a={title:"",bref:"",pptInfo:t},s=n.split("```").filter(e=>!!e);if(s.length>1){let e=s[s.length-1].split("\n");if(e.length>0){let t=e.filter(e=>!!e);t.length>0&&(a.title=t[0].includes("markdown")?t[1]:t[0],a.bref=t.join("\n"))}}if(1===s.length){let e=s[s.length-1].split("\n"),t=e.filter(e=>!!e);t.length>0&&(a.title=t[0],a.bref=t.join("\n"))}return a}({pptInfo:null==i?void 0:i.pptInfo,contents:t});f(e)};(null==i?void 0:null===(e=i.pptInfo)||void 0===e?void 0:e.code)?(b(eb(null==i?void 0:i.pptInfo)),u(r.PPT_Download)):(null==i?void 0:i.pptInfo)&&0===Object.keys(null==i?void 0:i.pptInfo).length?(a(),u(r.PPT)):u(r.Hide),"close"!==o||null==i||!i.pptInfo||(null==i?void 0:null===(n=i.pptInfo)||void 0===n?void 0:n.code)||(a(),u(r.PPT))},[o,null==i?void 0:i.pptInfo,t]),(0,x.useEffect)(()=>{let e=document.getElementById("aippt-iframe-btn");return e&&(null==e||e.addEventListener("click",()=>{(null==g?void 0:g.id)?u(r.PPT_Download):u(r.PPT)})),()=>{null==e||e.removeEventListener("click",()=>{})}},[g]);let C=(0,eg.Z)(ex.ti,{manual:!0,onSuccess:e=>{e.code,h.n8.SUCCESS},onError:e=>{}}),j=(0,eg.Z)(e=>(0,ex.Un)(e),{manual:!0}),I=(0,eg.Z)(e=>(0,ex.Un)(e),{manual:!0});async function N(e,t,o){let i=e||{fc_plate:[2014,1027,2024],custom_generate:{title:p.title,content:p.bref,type:7,step:2}};try{if(!AipptIframe)return;await AipptIframe.show({appkey:ey,channel:"",code:(null==o?void 0:o.code)||"656b30d966cee00db2c269d2401e1b6e",editorModel:!0,onMessage(e,t){"GENERATE_PPT_SUCCESS"===e&&(u(r.PPT_Download),b({...g,...t,id:t.id,thumbnail:t.thumbnail}),l({conversationId:n,sentenceId:s,turnId:a,info:{pptInfo:{...g,...t,id:t.id,coverUrl:t.thumbnail,code:(null==o?void 0:o.code)||""}}}),(0,ex.rd)({conversationId:n,turnId:a,sentenceId:s,pptInfo:{id:t.id,taskId:t.taskId,coverUrl:t.thumbnail,code:(null==o?void 0:o.code)||"",key:ey}}))},options:i,routerOptions:t||{list:["generate","editor"],generate:{step:2}}})}catch(e){}}let w=async()=>{try{let e=await C.runAsync();N(!1,!1,{code:e.code,token:e.token}),d("chat_conversation_ppt_btn_click",{page:h.fK.CHAT.key,area:h.fK.CHAT.area.CONVERSATION.key,element:h.fK.CHAT.area.CONVERSATION.element.PPT_CREATE,bhv_type:"ppt_create",conversation_id:n,turn_id:a,a_sentence_id:s,content:t,is_new_start:!1})}catch(e){}},T=async()=>{try{let e=await C.runAsync(),t=await j.runAsync({format:"ppt",id:(null==g?void 0:g.id)||"",token:e.token||""});if(t.code===h.n8.SUCCESS){let e={url:t.data[0],filename:"ppt"};y(null==e?void 0:e.url,null==e?void 0:e.filename)}}catch(e){}},S=async()=>{try{let e=await C.runAsync(),t=await I.runAsync({format:"pdf",id:(null==g?void 0:g.id)||"",token:e.token||""});if(t.code===h.n8.SUCCESS){let e={url:t.data[0],filename:"pdf"};y(null==e?void 0:e.url,null==e?void 0:e.filename)}}catch(e){}},P=async()=>{if(null!=g&&g.id)try{let e=await C.runAsync();N({fc_plate:eC.fc_plate},{list:eC.list,editor:{id:g.id}},{code:e.code,token:e.token})}catch(e){}};return(0,c.jsx)(c.Fragment,{children:_!==r.Hide&&(0,c.jsxs)("div",{className:ej()["ai-ppt-block"],children:[_===r.PPT&&(0,c.jsxs)("div",{className:ej().ai_ppt_one_key,onClick:w,children:[(0,c.jsx)(m.Z,{className:ej().ppt_icon,name:"Slideppt"}),(0,c.jsx)("div",{children:"一键生成PPT >"})]}),_===r.PPT_Download&&(0,c.jsxs)("div",{children:[(0,c.jsx)("img",{className:ej().ppt_cover_url,src:null==g?void 0:g.thumbnail,alt:"ppt封面图"}),(0,c.jsxs)("div",{className:ej().ppt_down,children:[(0,c.jsx)(ef,{disabled:j.loading,loading:j.loading,className:ej().download_btn,onClick:T,children:"下载PPT"}),(0,c.jsx)(ef,{disabled:I.loading,loading:I.loading,className:ej().download_btn,onClick:S,children:"下载PDF"}),(0,c.jsx)(ef,{className:ej().download_btn,onClick:P,children:"编辑PPT"})]})]})]})})}),eN=n(41709),ew=n(50115),eT=n(84702),eS=n(9179),eP=n(27290),eA=n.n(eP),eE=n(85496),eR=n(25815);let eM=e=>{let{}=e,{track:t}=(0,v.useTrack)(),n=(0,ep.yP)(),a=(0,J.useRouter)(),s=()=>{a.push("/chat/payment")},{ref:o}=(0,eT.YD)({threshold:1,delay:1e3,trackVisibility:!0,onChange:(e,a)=>{if(null==a?void 0:a.isVisible)try{t(eS.R3.getcoins_show,{uid:null==n?void 0:n.user.id})}catch(e){}}});return(0,c.jsxs)("div",{className:eA().notCoinContainer,"data-sentry-component":"LackCoin","data-sentry-source-file":"DeepSearchPayment.tsx",children:[(0,c.jsx)("div",{className:eA().title,children:"金币不足"}),(0,c.jsxs)("div",{className:eA().desc,children:["此次生成需消耗 ",eS.b2," 金币"]}),(0,c.jsx)("div",{className:eA().buttonContainer,children:(0,c.jsx)("button",{className:eA().goCoinCenterButton,onClick:()=>{s();try{t(eS.R3.getcoins_click,{uid:null==n?void 0:n.user.id})}catch(e){}},ref:o,children:"获取金币"})})]})},eB=e=>{let{onClick:t}=e,{track:n}=(0,v.useTrack)(),a=(0,ep.yP)(),{ref:s}=(0,eT.YD)({threshold:1,delay:1e3,trackVisibility:!0,onChange:(e,t)=>{if(null==t?void 0:t.isVisible)try{n(eS.R3.buyview_show,{uid:null==a?void 0:a.user.id})}catch(e){}}});return(0,c.jsxs)("div",{className:eA().paymentContainer,"data-sentry-component":"PayButton","data-sentry-source-file":"DeepSearchPayment.tsx",children:[(0,c.jsx)("div",{className:eA().title,children:(0,c.jsx)("svg",{width:"56",height:"56",viewBox:"0 0 56 56",fill:"none",xmlns:"http://www.w3.org/2000/svg","data-sentry-element":"svg","data-sentry-source-file":"DeepSearchPayment.tsx",children:(0,c.jsxs)("g",{opacity:"0.1","data-sentry-element":"g","data-sentry-source-file":"DeepSearchPayment.tsx",children:[(0,c.jsx)("path",{d:"M41.1277 22.3067C41.8713 24.0619 42.2405 25.9379 42.2354 27.8131C42.2255 31.383 40.8587 34.9499 38.135 37.6737C35.4112 40.3975 31.8443 41.7643 28.2744 41.7741C26.3992 41.7793 24.5231 41.4101 22.768 40.6664M33.7031 14.8821C31.9479 14.1385 30.0719 13.7692 28.1967 13.7744C24.6267 13.7843 21.0599 15.1511 18.3361 17.8748C15.6123 20.5986 14.2455 24.1655 14.2357 27.7354C14.2305 29.6106 14.5997 31.4867 15.3434 33.2418",stroke:"black","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round","data-sentry-element":"path","data-sentry-source-file":"DeepSearchPayment.tsx"}),(0,c.jsx)("path",{d:"M36.8516 26.6406L40.5638 20.2108L46.9937 23.923",stroke:"black","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round","data-sentry-element":"path","data-sentry-source-file":"DeepSearchPayment.tsx"}),(0,c.jsx)("path",{d:"M9.05469 32.1016L15.4846 35.8138L19.1968 29.384",stroke:"black","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round","data-sentry-element":"path","data-sentry-source-file":"DeepSearchPayment.tsx"})]})})}),(0,c.jsx)("div",{className:eA().buttonContainer,children:(0,c.jsx)("button",{className:eA().payButton,onClick:()=>{t();try{n(eS.R3.buyview_click,{uid:null==a?void 0:a.user.id})}catch(e){}},ref:s,children:"重新生成"})})]})},eD=e=>{let{isShowDeepResearchPayment:t,mode:n,turnId:a,conversationId:s,retry:o,updateConversation:i,updateBalance:r}=(0,eR.P)(e=>e),{deleteTurnFromConv:l}=e;(0,x.useEffect)(()=>{i({conversationId:e.conversationId})},[e]);let{ref:d}=(0,eT.YD)({threshold:1,delay:1e3,trackVisibility:!0,onChange:(e,t)=>{if(null==t?void 0:t.isVisible)try{r()}catch(e){}}}),_=x.useRef(null);return(0,x.useEffect)(()=>{_.current&&n===eE.XG.lock&&t&&_.current.info("模型生成中，金币余额不足")},[t,n]),t?(0,c.jsxs)("div",{className:eA().container,ref:d,"data-sentry-component":"DeepSearchPayment","data-sentry-source-file":"DeepSearchPayment.tsx",children:[(0,c.jsx)(p.ZP,{ref:_,"data-sentry-element":"MyMessage","data-sentry-source-file":"DeepSearchPayment.tsx"}),(0,c.jsx)("div",{className:eA().overlay,children:n===eE.XG.enough?(0,c.jsx)(eB,{onClick:()=>{s&&a&&l(s,a),o()}}):(0,c.jsx)(eM,{})})]}):null};var eL=n(18003),eO=n(53615),eZ=n(94026),eF=n.n(eZ),eU=n(79710),eV=n(38470),eY=n(45576),eK=n(81036),eH=n(48907),ez=n(22304),eq=n(41726),eW=n(20301),eX=n.n(eW),eG=e=>{let{}=e;return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("div",{className:eX().image_loading,children:(0,c.jsx)("div",{className:eX().loader})})})},eQ=n(67530),eJ=x.memo(e=>{let{contents:t,children:n,status:a,botId:s,botInfo:o,conversationId:i,turnId:r,mediaInfos:l,turnIndex:d}=e,{deleteTurnFromConv:_,isDeepResearchBot:u,runBreakPointResume:p,clearTimeoutTurn:v}=(0,k.useConver)(),{getChatCustomParams:f}=(0,ez.useConverMenuContext)(),{online:g}=(0,eq.Z)();(0,x.useEffect)(()=>{g&&"net_error"===a&&p()},[g]);let b=(0,x.useCallback)(async()=>{p()},[p]),y=(0,x.useCallback)(async()=>{await I.Z.stopSse({conversationId:i,uuid:i}),/^newTurnId/.test(r)&&_(i,r),(0,ep.xn)(i,r);let{capabilities:e}=f(t||"");I.Z.sendMsgToBot({botId:s,botAlias:(null==o?void 0:o.alias)||"",conversationId:i,contents:t,mediaInfos:l,turnIndex:d,strategy:{isRetry:!/^newTurnId/.test(r),breakingStrategy:0},uuid:i,turnId:/^newTurnId/.test(r)?"":r,timeoutRetry:!0,inputWay:h.zY.INPUT_WAY.PROACTIVE,customAttrs:{input_way:h.zY.INPUT_WAY.PROACTIVE},customParams:{capabilities:e}})},[i,t,l,d,s,null==o?void 0:o.alias,r,_,f]),C=(0,x.useMemo)(()=>{switch(a){case"loading":return(0,c.jsx)("div",{className:eX().question_loading});case"timeout":return(0,c.jsx)(m.Z,{onClick:y,className:eX().question_timeout_icon,name:"arrowclockwisecirclefill1"});case"net_error":return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(m.Z,{onClick:b,className:eX().question_timeout_icon,name:"arrowclockwisecirclefill1"})});default:return null}},[a,y,b]);return(0,c.jsxs)("div",{"data-sentry-component":"SentenceCard","data-sentry-source-file":"index.tsx",children:[d>0&&Array.isArray(l)&&l.length>0&&(0,c.jsx)(eK.Z,{hasClose:!1,files:l}),(0,c.jsx)(eQ.Z,{turnStateICon:C,contents:t,"data-sentry-element":"QuestionPure","data-sentry-source-file":"index.tsx"}),(0,c.jsx)("div",{className:eX().media_list,children:d<1&&Array.isArray(l)&&l.map((e,t)=>{let{thumb:n,downloadUrl:a,q_type:s}=e;return(0,c.jsxs)(c.Fragment,{children:["loading"===s&&(0,c.jsx)(eG,{},s+"_"+t),"loading"!==s&&(n?(0,c.jsx)(eH.Z,{thumb:n,downloadUrl:a||n},"".concat(e.name,"_").concat(t)):(0,c.jsx)(eY.Z,{...e,hasClose:!1,stage:2,status:2},"".concat(e.name,"_").concat(t)))]})})})]})}),e$=n(31804),e0=n.n(e$),e1=n(1865),e2=n.n(e1),e4=e=>{let{item:t,show:n,botInfo:a,botId:s}=e,{suggestedQuestion:o,conversations:i,currentConversationId:r,suggestedQuestionShow:l,webSearch:d,initOneConversation:_,noMore:u,getMoreHistoryConversation:p}=(0,k.useConver)(),v=(0,x.useMemo)(()=>i[r],[i,r]),f=(0,x.useMemo)(()=>{if(!v)return{};{let{turnList:e}=v;return e[0]}},[v]),g=(0,x.useMemo)(()=>{var e;return(null==f?void 0:null===(e=f.sentenceList)||void 0===e?void 0:e.filter(e=>1===e.direction))||[]},[f]);return(0,c.jsx)(c.Fragment,{children:n&&(0,c.jsx)("div",{className:e2().r1_suggest_item_wrapper,children:(0,c.jsxs)("div",{className:e2().r1_suggest_item,onClick:()=>{var e;let n="";g[0].contents||(n=(0,eV.V)(g[0].mediaInfos));let o=(null==t?void 0:t.defaultQuery)||(null===(e=g[0])||void 0===e?void 0:e.contents)||"";I.Z.sendMsgToBot({botId:s,botAlias:(null==a?void 0:a.alias)||"",rewriteQuery:n,mediaInfos:g[0].mediaInfos,conversationId:r,contents:o,strategy:{isRetry:!1,breakingStrategy:0},uuid:r,inputWay:h.zY.INPUT_WAY.RELATIVED,customAttrs:{input_way:h.zY.INPUT_WAY.RELATIVED},customParams:{capabilities:[t]}})},children:[(0,c.jsx)(m.Z,{className:e2().icon,name:"chat-bottom-ri"}),(0,c.jsx)("div",{children:"转成精致网页"})]})})})};let e7=["cancel","like","dislike"],e3=e=>{let{inputingMsg:t}=e;return(0,c.jsx)("div",{className:e0().answer_container,"data-sentry-component":"LoadingRender","data-sentry-source-file":"TurnCardLast.tsx",children:(0,c.jsx)("div",{className:e0().answer_content,style:{alignItems:"center"},children:(0,c.jsx)("div",{style:{marginRight:10,lineHeight:1.8},children:(0,c.jsx)(eU.Z,{className:e0().answer_loading_msg,text:t,"data-sentry-element":"ShinyText","data-sentry-source-file":"TurnCardLast.tsx"})})})})};var e5=(0,x.memo)(e=>{var t,n,a,s,o;let{sentenceList:i,conversationId:r,turnId:l,botId:d,botInfo:_,isLast:u,auth:f,appConfig:g,setTurnFeedback:b,webSearch:y,lastedTurnIsNew:C,sseStatus:N,status:w,setBotDrawerOpen:T,lastEventIndex:S=-1,eventIndex:P=0}=e,{checkRealLogin:A}=(0,j.useGlobalExecuteState)(),E=(0,x.useRef)(null),R=(0,J.useSearchParams)(),M=R.get("inner_refer")||"history",[B,D]=(0,x.useState)(!1),{track:L}=(0,v.useTrack)(),{setSentenceFeedback:O,confirmDeleteTurn:Z,checkedMenuItems:F,changeConvLasTurnAnsIdx:U,suggestedQuestion:Y}=(0,k.useConver)(),K=(0,x.useMemo)(()=>"before"===w?"loading":"timeout"===w?"timeout":"net_error"===w?"net_error":"none",[w]),H=(0,x.useMemo)(()=>"before"===N||"open"===N||"webSearch"===N||"needResume"===w||P<S-1,[N,P,S,w]),z=(0,x.useMemo)(()=>i.filter(e=>1===e.direction),[i]),W=(0,x.useMemo)(()=>i.filter(e=>1!==e.direction),[i]),[G,Q]=(0,x.useState)(W.length-1>-1?W.length-1:0),$=(0,x.useMemo)(()=>{var e,t,n,a,s,o;let i=(null===(t=W[G])||void 0===t?void 0:null===(e=t.extraInfo)||void 0===e?void 0:e.answerVisualization)||(null===(a=W[G])||void 0===a?void 0:null===(n=a.extraInfo)||void 0===n?void 0:n.visualizationError);return!i&&(null===(o=W[G])||void 0===o?void 0:null===(s=o.contents)||void 0===s?void 0:s.indexOf("chat-text-to-image"))==-1},[W,G]),ee=(0,x.useMemo)(()=>i.map(e=>e.sentenceId),[i]);(0,x.useCallback)(()=>{D(!B)},[B,D]);let et=(0,x.useCallback)(e=>{var t;null===(t=E.current)||void 0===t||t.info(e)},[E]),en=(0,x.useCallback)(async e=>{let t=W[G];if(t){if(t.feedback===e&&(e=0),t){let a=await (0,q.dU)(t.userId||f.user.id,t.botId||d,{userId:f.user.id,turnId:l,conversationId:r,...t},e7[e],t.sentenceId,f.token);if(a.code===h.n8.SUCCESS&&O({conversationId:r,turnId:l,sentenceId:t.sentenceId,feedback:e}),"cancel"!==e7[e]){var n;let a="chat_conversation_dislike_btn_click",s="dislike",o=h.fK.CHAT.area.CONVERSATION.element.DISLIKE_BTN;"like"===e7[e]&&(a="chat_conversation_praise_btn_click(",s="praise",o=h.fK.CHAT.area.CONVERSATION.element.PRAISE_BTN),L(a,{page:h.fK.CHAT.key,area:h.fK.CHAT.area.CONVERSATION.key,element:o,bhv_type:s,conversation_id:r,turn_id:l,q_sentence_id:null===(n=z[0])||void 0===n?void 0:n.sentenceId,a_sentence_id:t.sentenceId,content:t.contents,is_new_start:C,refer_page:M})}}"dislike"===e7[e]&&b({turnId:l,show:!0})}},[W,b,l,r,z,G,d,f,O,L,M,C]),ea=(0,x.useCallback)(async()=>{A()&&en(1)},[A,en]),eo=(0,x.useCallback)(async()=>{A()&&en(2)},[A,en]),ei=(0,x.useCallback)(()=>{let e=G>0?G-1:0;Q(e)},[Q,G]),er=(0,x.useCallback)(()=>{let e=G<W.length-1?G+1:W.length-1;Q(e)},[Q,G,W]),el=(0,x.useCallback)(()=>{var e;let t=W[G],n={page:h.fK.CHAT.key,area:h.fK.CHAT.area.CONVERSATION.key,conversation_id:r,turn_id:l,q_sentence_id:null===(e=z[0])||void 0===e?void 0:e.sentenceId,a_sentence_id:t.sentenceId,content:t.contents};Z(r,l,!0,n)},[Z,G,W,z,r,l]);(0,x.useEffect)(()=>{let e=W.length-1>-1?W.length-1:0;Q(e)},[W]);let ec=(0,x.useMemo)(()=>{let{visibility:e,searchMsg:t}=y||{};return e?t?t.content:"小白正在搜索...":"小白正在思考..."},[y]),ed=(0,x.useMemo)(()=>{var e,t;return(null===(e=W[G])||void 0===e?void 0:e.contents)||(("close"!==w||(null===(t=W[G])||void 0===t?void 0:t.voluntaryStop))&&w?"":h.BK)},[W,G,w]),eu=(0,x.useCallback)(e=>{var t;let{eventName:n,bh:a,aSentence:s}=e;L(n,{page:h.fK.CHAT.key,area:h.fK.CHAT.area.CONVERSATION.key,bhv_type:a,conversation_id:r,turn_id:l,q_sentence_id:null===(t=z[0])||void 0===t?void 0:t.sentenceId,a_sentence_id:s.sentenceId,content:s.contents,refer_page:M})},[L,r,l,M,z]),em=(0,x.useCallback)(()=>{let e=W[G],t=e.contents||"",n=(0,ep.l8)(t);""===n?et("复制失败，当前对话没有正文信息"):(X()(n),et("复制成功"))},[W,G,et]);(0,x.useEffect)(()=>{U({conversationId:r,index:G})},[G,r]);let eh=(0,x.useMemo)(()=>{var e,t,n;return u&&!H&&("close"===N||!N)&&(null===(n=W[G])||void 0===n?void 0:null===(t=n.extraInfo)||void 0===t?void 0:null===(e=t.coin)||void 0===e?void 0:e.status)!==eL.WT.PENDING},[H,u,N,W,G]),ev=(0,x.useMemo)(()=>{let e=Y[r];if((null==e?void 0:e.contents)&&Array.isArray(e.contents)){let t=e.contents.find(e=>"object"==typeof e&&(null==e?void 0:e.key)==="genHtml");return t||{}}return null},[r,Y]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(p.ZP,{ref:E,"data-sentry-element":"MyMessage","data-sentry-source-file":"TurnCardLast.tsx"}),(0,c.jsxs)("div",{className:e0().turn_container,children:[z[0]?(0,c.jsx)(eJ,{conversationId:r,turnId:l,botId:d,botInfo:_,contents:z[0].contents,status:K,mediaInfos:z[0].mediaInfos,turnIndex:z[0].turnIndex,answerList:W,querySentenceId:null===(t=z[0])||void 0===t?void 0:t.sentenceId}):null,u?H?(0,c.jsx)(e3,{inputingMsg:ec}):W[G]&&"timeout"!==N?(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(to,{...W[G],conversationId:r,botInfo:_,turnId:l,isLast:u,status:w,contents:ed,deleteTrace:eu,setBotDrawerOpen:T,sseStatus:N,fileName:null===(s=z[0])||void 0===s?void 0:s.contents,loadingMsg:ec,answerLoading:H,appConfig:g,children:eh&&!W[G].loading&&z[0]?(0,c.jsxs)("div",{className:e0().operation_l,children:[(0,c.jsxs)("div",{className:e0().left_opts,children:[(0,c.jsx)(e4,{show:!!(null==ev?void 0:ev.botDesc),item:ev,botInfo:_,botId:d}),(0,c.jsx)(e_,{conversationId:r,sentenceIdList:ee,canExport:$,fileName:null===(o=z[0])||void 0===o?void 0:o.contents})]}),(0,c.jsxs)("div",{className:"".concat(e0().right_opts," ").concat(e0().more_opts_show),children:[W.length>1?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"",children:(0,c.jsx)(V.Z,{title:"上一条",children:(0,c.jsxs)("div",{className:0!==G?e0().opt_btn:e0().opt_btn_disable,onClick:ei,children:[(0,c.jsx)("div",{className:"".concat(e0().opt_btn_icon," ").concat(e0().left_btn),children:(0,c.jsx)(m.Z,{name:"chat-bottom-page"})}),(0,c.jsx)("div",{className:"".concat(e0().page_text),children:G+1})]})})}),(0,c.jsx)("div",{className:"".concat(e0().page_text),children:"/"}),(0,c.jsx)("div",{className:"",children:(0,c.jsx)(V.Z,{title:"下一条",children:(0,c.jsxs)("div",{className:G!==W.length-1?e0().opt_btn:e0().opt_btn_disable,onClick:er,children:[(0,c.jsx)("div",{className:"".concat(e0().page_text),children:W.length}),(0,c.jsx)("div",{className:"".concat(e0().opt_btn_icon," ").concat(e0().right_btn),children:(0,c.jsx)(m.Z,{name:"chat-bottom-page"})})]})})})]}):null,(0,c.jsx)("div",{className:e0().opt_btn,onClick:em,children:(0,c.jsx)(es,{iconName:"chatbottomcopy"})}),(0,c.jsx)("div",{className:e0().opt_btn,onClick:()=>{var e,t;if(!z[0])return;let n="";z[0].contents||(n=(0,eV.V)(z[0].mediaInfos));let a=eF()((null===(t=z[0])||void 0===t?void 0:null===(e=t.extraInfo2)||void 0===e?void 0:e.chatReqSnapshot)||{},eO._X);I.Z.sendMsgToBot({botId:d,botAlias:(null==_?void 0:_.alias)||"",contents:z[0].contents,querySentenceId:z[0].sentenceId,strategy:{isRetry:!0,breakingStrategy:0},turnId:l,mediaInfos:z[0].mediaInfos,turnIndex:z[0].turnIndex,rewriteQuery:n,conversationId:r,uuid:r,inputWay:h.zY.INPUT_WAY.PROACTIVE,capabilities:F||[],customAttrs:{eventName:"chat_conversation_refresh_btn_click",attrs:{bhv_type:"click",page:h.fK.CHAT.key,area:h.fK.CHAT.area.CONVERSATION.key,element:h.fK.CHAT.area.CONVERSATION.element.REFRESH_BTN,refer_page:M},input_way:h.zY.INPUT_WAY.PROACTIVE},customParams:a})},children:(0,c.jsx)(es,{iconName:"chatbottomrefresh"})}),(0,c.jsx)("div",{className:e0().opt_btn,onClick:ea,children:(0,c.jsx)(es,{iconName:"chatbottomlike",isActive:1===W[G].feedback})}),(0,c.jsx)("div",{className:e0().opt_btn,onClick:eo,children:(0,c.jsx)(es,{iconName:"chatbottomunlike",isActive:2===W[G].feedback})}),(0,c.jsx)("div",{className:e0().opt_btn,onClick:el,children:(0,c.jsx)(es,{iconName:"chatbottomdelete"})})]})]}):null})}):null:W[G]&&"timeout"!==w?(0,c.jsx)(to,{...W[G],conversationId:r,botInfo:_,turnId:l,isLast:!1,likeReport:en,status:w,contents:null===(n=W[G])||void 0===n?void 0:n.contents,handleDeleteTurn:el,hasOperation:!0,deleteTrace:eu,setBotDrawerOpen:T,sseStatus:N,fileName:null===(a=z[0])||void 0===a?void 0:a.contents,sentenceIdList:ee,appConfig:g}):null]})]})}),e6=n(52899),e9=x.memo(e=>{let{contents:t,loading:n,conversationId:a,turnId:s,isLast:o,isBanned:i,sentenceId:r,outputType:l,extraInfo:d,privateStopVis:_,status:u,loadingEvent:m}=e,p=(0,x.useMemo)(()=>o&&n&&"step"===l,[o,n,l]);return(0,c.jsx)(e6.U,{content:t,loading:n,linkComp:null,conversationId:a,stepping:p,sentenceId:r,turnId:s,extraInfo:d,privateStopVis:_,status:u,loadingEvent:m,"data-sentry-element":"Markdown","data-sentry-component":"StepMarkDown","data-sentry-source-file":"index.tsx"})}),e8=n(57629),te=n.n(e8),tt=e=>{let{extraInfo:t}=e,{track:n}=(0,v.useTrack)(),a=(0,x.useMemo)(()=>null==t?void 0:t.answerVisualization,[t]),s=(0,x.useMemo)(()=>null==t?void 0:t.visualizationError,[t]),o=(0,x.useMemo)(()=>a||s,[a,s]),{openExternalUrl:i}=(0,ei.ky)();return o?(0,c.jsx)("div",{className:te().wrapper,"data-sentry-component":"Visualization","data-sentry-source-file":"index.tsx",children:s?(0,c.jsx)("div",{className:te().content,children:(0,c.jsxs)("div",{className:te().left,children:[(0,c.jsx)("div",{className:"".concat(te().icon," ").concat(te().error)}),(0,c.jsx)("div",{className:te().title,children:s})]})}):(0,c.jsxs)("div",{className:"".concat(te().content," ").concat(te().cursor),onClick:()=>{let e=(null==t?void 0:t.answerVisualization)||"";if(e){let t=(0,eO.ld)(e),a="https://".concat("www.wenxiaobai.com","/share/html/").concat(t,"?refer_channel=answer_visualization");i(a),n("chat_answer_visualization_fullscreen_click",{bhv_type:"click",url:e})}},children:[(0,c.jsxs)("div",{className:te().left,children:[(0,c.jsx)("div",{className:te().icon}),(0,c.jsx)("div",{className:te().title,children:"精致的网页已经生成，点击浏览"})]}),(0,c.jsx)("div",{className:te().btn,children:"全屏预览"})]})}):null},tn=n(88511),ta=n.n(tn),ts=e=>{let{contents:t,loading:n,children:a,isLast:s,isBanned:o,privateStopVis:i,stepBeginCb:r,stepCompleteCb:l,outputType:d,sentenceId:_,conversationId:u,turnId:m,extraInfo:p,status:h,loadingEvent:v}=e;return(0,c.jsxs)("div",{style:{maxWidth:"100%",width:"100%"},"data-sentry-component":"AnswerPure","data-sentry-source-file":"AnswerPure.tsx",children:[(0,c.jsxs)("div",{className:"".concat(ta().answer_content,"  ").concat(s?ta().answer_content_last:""),children:["no_data"===h&&(0,c.jsx)("div",{className:ta().no_data_container,children:(0,c.jsxs)("div",{className:ta().no_data_text,children:["小白正在全力分析中，请稍等片刻，稍后可以",(0,c.jsx)("span",{onClick:()=>{window.location.reload()},className:ta().no_data_text_link,children:"刷新页面"}),"查看最新进度。"]})}),"no_data"!==h&&(0,c.jsx)(e9,{contents:t,outputType:d,loading:n,isLast:s,isBanned:o,handleStepComplete:l,handlleStepBegin:r,sentenceId:_,turnId:m,extraInfo:p,privateStopVis:i,status:h,loadingEvent:v,conversationId:u}),(0,c.jsx)(tt,{extraInfo:p,"data-sentry-element":"Visualization","data-sentry-source-file":"AnswerPure.tsx"}),i?(0,c.jsx)("span",{className:ta().stop_message,children:"（已停止）"}):null]}),a]})},to=x.memo(e=>{var t,n,a;let{contents:s,loading:o,children:i,conversationId:r,botInfo:l,turnId:d,isLast:_,isBanned:u,voluntaryStop:m,likeReport:h,feedback:v,sentenceId:f,deleteTrace:g,handleDeleteTurn:b,hasOperation:y=!1,status:C,extraInfo:I,loadingEvent:N,setBotDrawerOpen:w,sseStatus:T,fileName:S,sentenceIdList:P,loadingMsg:A,answerLoading:E,appConfig:R}=e,M=(0,x.useRef)(null),[B,D]=(0,x.useState)(!1),{isDeepResearchBot:L,conversations:O,currentConversationId:Z,deleteTurnFromConv:F}=(0,k.useConver)(),[U,Y]=(0,x.useState)(!1),K=(0,x.useRef)(null),{setUserLoginModalShow:H,setPhoneBindModalShow:z}=(0,j.useGlobalExecuteState)(),q=(0,x.useRef)(),{checkRealLogin:W}=(0,j.useGlobalExecuteState)(),{isShowDeepResearchPayment:G}=(0,eR.P)(e=>e),Q=(0,x.useCallback)(()=>{W()&&h(1)},[W,h]),J=(0,x.useCallback)(async()=>{W()&&(await h(2),D(!1))},[W,h,D]),en=(0,x.useCallback)(e=>{g({eventName:e,bh:"exposure",aSentence:{contents:s,sentenceId:f}})},[s,g,f]),ea=(0,x.useCallback)(()=>{b&&b()},[b]);(0,x.useCallback)(e=>{D(e),en("chat_delete_turn_exposure")},[D,en]);let eo=(0,x.useCallback)(()=>{"needBound"===C?z(!0):H(!0)},[C,H,z]),ei=(0,x.useCallback)(e=>{var t;null===(t=M.current)||void 0===t||t.info(e)},[M]),er=(0,x.useCallback)(()=>{let e=s||"",t=(0,ep.l8)(e);""===t?ei("复制失败，当前对话没有正文信息"):(X()(t),ei("复制成功"))},[s,ei]),el=(0,x.useMemo)(()=>m,[m]),ec=(0,x.useMemo)(()=>{var e;return!_&&y&&"needLogin"!==C&&"needBound"!==C&&(null==I?void 0:null===(e=I.coin)||void 0===e?void 0:e.status)!==1&&!G},[_,y,C,I,G]),ed=(0,x.useMemo)(()=>{var e,t,n,a;if(null==I?void 0:null===(e=I.deepResearch)||void 0===e?void 0:e.details){let e=null===(n=(null==I?void 0:null===(a=I.deepResearch)||void 0===a?void 0:a.details)||[])||void 0===n?void 0:null===(t=n.find(e=>e.stage===em.He.VISUALIZATION))||void 0===t?void 0:t.content;return e||""}return null},[I]),eh=(0,x.useMemo)(()=>!L,[L]);eu(()=>{var e;null==K||null===(e=K.current)||void 0===e||e.setCollapseOpen(!1)},!!ed);let ev=(0,x.useMemo)(()=>L||(0,ep.U1)({botId:null==l?void 0:l.id,appConfig:R})?"https://wy-static.wenxiaobai.com/wenxiaobai-web/web-image/bot/xiaobai_answer_avatar.webp":null==l?void 0:l.avatar,[L,l,R]),ef=(0,x.useMemo)(()=>{let e=(null==I?void 0:I.answerVisualization)||(null==I?void 0:I.visualizationError);return!e},[I]),ex=(0,x.useMemo)(()=>{var e;let t="";return null===(e=O[Z])||void 0===e||e.turnList.forEach(e=>{var n;null==e||null===(n=e.sentenceList)||void 0===n||n.forEach(e=>{var n,a,s,o;(null==e?void 0:null===(n=e.extraInfo)||void 0===n?void 0:n.deepResearch)&&(null==e||null===(o=e.extraInfo)||void 0===o||null===(s=o.deepResearch)||void 0===s||null===(a=s.details)||void 0===a||a.forEach(e=>{(null==e?void 0:e.stage)===em.He.ARTICLE_TITLE&&(t=null==e?void 0:e.title)}))})}),t||"小白研报文档-wenxiaobai.com"},[O,Z]),eg=(0,x.useMemo)(()=>["close","error","timeout","stop","net_error"].includes(C)||!C,[C]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(p.ZP,{ref:M,"data-sentry-element":"MyMessage","data-sentry-source-file":"index.tsx"}),(0,c.jsxs)("div",{className:ta().answer_body_content,children:[(null==l?void 0:l.avatar)&&(0,c.jsx)("img",{className:"".concat(ta().answer_bot_avatar," ").concat(eg?ta().avatar_hide:""),src:ev,alt:"",onClick:()=>w(!0)}),(0,c.jsxs)("div",{className:"".concat(ta().answer_right_content," ").concat((null==l?void 0:l.avatar)?ta().show_avatar:""," ").concat(_&&ta().last_right_answer_content," "),children:[((null==I?void 0:I.onlineSearch)||(null==I?void 0:null===(t=I.thinkInfo)||void 0===t?void 0:t.content))&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(ee.Z,{thinkInfo:null==I?void 0:I.thinkInfo,onlineSearch:null==I?void 0:I.onlineSearch,conversationId:r,turnId:d,sentenceId:f}),A&&"onlineSearch"===C&&(0,c.jsx)(e3,{inputingMsg:A||""})]}),I&&I.deepResearch&&(null===(n=I.deepResearch.details)||void 0===n?void 0:n.length)>0?(0,c.jsx)($.Z,{ref:K,title:"小白研报",data:I.deepResearch.details,iconName:"xiaobaresearch"}):null,I&&I.webSearchDetail?(0,c.jsx)(et.Z,{conversationId:r,turnId:d,sentenceId:f,data:I.webSearchDetail,isDeepSearch:L,sseStatus:T,isLast:_}):null,I&&I.deepResearch&&(null===(a=I.deepResearch.details)||void 0===a?void 0:a.length)>0&&!ed?(0,c.jsx)(eN.Z,{data:null==I?void 0:I.deepResearch.details}):null,(0,c.jsx)(eD,{conversationId:Z,extraInfo:I,deleteTurnFromConv:F,"data-sentry-element":"DeepSearchPayment","data-sentry-source-file":"index.tsx"}),(0,c.jsxs)("div",{ref:q,className:ta().answer_container,onMouseEnter:()=>{Y(!0)},onMouseLeave:()=>{Y(!1)},children:[eh&&!G&&(0,c.jsxs)(ts,{conversationId:r,isLast:_,isBanned:u,contents:s,outputType:"step",loading:o,sentenceId:f,turnId:d,privateStopVis:el,extraInfo:I,status:C,loadingEvent:N,children:[i,"needLogin"===C||"needBound"===C?(0,c.jsxs)("div",{className:ta().login_btn,onClick:eo,children:[(0,c.jsx)("div",{className:ta().login_text,children:"needLogin"===C?"去登录":"去绑定"}),(0,c.jsx)("div",{className:ta().login_icon})]}):null]}),ec?(0,c.jsxs)("div",{className:"\n                  ".concat(ta().opt_container," \n                  ").concat(U?"":ta().opt_hide,"\n                "),style:{position:"absolute",bottom:"-50px"},children:[(0,c.jsx)("div",{className:null===ta()||void 0===ta()?void 0:ta().left,children:(0,c.jsx)(e_,{conversationId:r,sentenceIdList:P,fileName:S,canExport:ef})}),(0,c.jsxs)("div",{className:null===ta()||void 0===ta()?void 0:ta().right,children:[(0,c.jsx)(V.Z,{title:"复制",children:(0,c.jsx)("div",{className:ta().opt_btn,onClick:er,children:(0,c.jsx)(es,{iconName:"chatbottomcopy"})})}),(0,c.jsx)(V.Z,{title:"喜欢",children:(0,c.jsx)("div",{className:ta().opt_btn,onClick:Q,children:(0,c.jsx)(es,{iconName:"chatbottomlike",isActive:1===v})})}),(0,c.jsx)(V.Z,{title:"不喜欢",children:(0,c.jsx)("div",{className:ta().opt_btn,onClick:J,children:(0,c.jsx)(es,{iconName:"chatbottomunlike",isActive:2===v})})}),(0,c.jsx)(V.Z,{title:"删除",children:(0,c.jsx)("div",{className:ta().opt_btn,onClick:ea,children:(0,c.jsx)(es,{iconName:"chatbottomdelete"})})})]})]}):null]}),(0,c.jsx)(eI,{conversationId:r,turnId:d,isLast:!1,hasOperation:y,likeReport:h,status:C,contents:s,loading:o,sentenceId:f,privateStopVis:el,extraInfo:I,"data-sentry-element":"Aippt","data-sentry-source-file":"index.tsx"}),ed&&!G&&(0,c.jsx)(ew.Z,{url:ed,showToolBar:!0,toolBarProps:{conversationId:r,sentenceIdList:P,canExport:!0,title:ex}})]})]})]})});let ti=["cancel","like","dislike"];var tr=(0,x.memo)(e=>{var t;let{sentenceList:n,conversationId:a,turnId:s,botId:o,auth:i,setTurnFeedback:r,status:l,hasOperation:d=!0,specialAnsIdx:_}=e,u=(0,J.useSearchParams)(),m=u.get("inner_refer")||"history",{track:f}=(0,v.useTrack)(),{setSentenceFeedback:g,confirmDeleteTurn:b}=(0,k.useConver)(),y=(0,x.useMemo)(()=>n.filter(e=>1===e.direction),[n]),C=(0,x.useMemo)(()=>n.filter(e=>1!==e.direction),[n]),j=(0,x.useMemo)(()=>null==_?C.length-1:_,[_,C]),I=(0,x.useRef)(null);(0,x.useCallback)(e=>{var t;null===(t=I.current)||void 0===t||t.info(e)},[I]);let N=(0,x.useCallback)(async e=>{let t=C[j];if(t){if(t.feedback===e&&(e=0),t){let r=await (0,q.dU)(t.userId||i.user.id,t.botId||o,{userId:i.user.id,turnId:s,conversationId:a,...t},ti[e],t.sentenceId,i.token);if(r.code===h.n8.SUCCESS&&g({conversationId:a,turnId:s,sentenceId:t.sentenceId,feedback:e}),"cancel"!==ti[e]){var n;let o="chat_conversation_dislike_btn_click",i="dislike",r=h.fK.CHAT.area.CONVERSATION.element.DISLIKE_BTN;"like"===ti[e]&&(o="chat_conversation_praise_btn_click",i="praise",r=h.fK.CHAT.area.CONVERSATION.element.PRAISE_BTN),f(o,{page:h.fK.CHAT.key,area:h.fK.CHAT.area.CONVERSATION.key,element:r,bhv_type:i,conversation_id:a,turn_id:s,q_sentence_id:null===(n=y[0])||void 0===n?void 0:n.sentenceId,a_sentence_id:t.sentenceId,content:t.contents,is_new_start:!1,refer_page:m})}}"dislike"===ti[e]&&r({turnId:s,show:!0})}},[i,C,a,y,m,g,f,s,r,o]),w=(0,x.useCallback)(e=>{var t;let{eventName:n,bh:o,aSentence:i}=e;f(n,{page:h.fK.CHAT.key,area:h.fK.CHAT.area.CONVERSATION.key,bhv_type:o,conversation_id:a,turn_id:s,q_sentence_id:null===(t=y[0])||void 0===t?void 0:t.sentenceId,a_sentence_id:i.sentenceId,content:i.contents,refer_page:m})},[f,a,s,m,y]),T=(0,x.useCallback)(()=>{var e;let t=C[j],n={page:h.fK.CHAT.key,area:h.fK.CHAT.area.CONVERSATION.key,conversation_id:a,turn_id:s,q_sentence_id:null===(e=y[0])||void 0===e?void 0:e.sentenceId,a_sentence_id:t.sentenceId,content:t.contents};b(a,s,!0,n)},[b,C,y,a,s,j]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(p.ZP,{ref:I,"data-sentry-element":"MyMessage","data-sentry-source-file":"TurnCard.tsx"}),(0,c.jsxs)("div",{className:e0().turn_container,children:[y[0]?(0,c.jsx)(eJ,{conversationId:a,turnId:s,contents:y[0].contents,status:l,botId:o,mediaInfos:y[0].mediaInfos,turnIndex:y[0].turnIndex}):null,C[j]&&"timeout"!==l?(0,c.jsx)(to,{...C[j],conversationId:a,turnId:s,isLast:!1,hasOperation:d,likeReport:N,status:l,contents:(null===(t=C[j])||void 0===t?void 0:t.contents)||h.BK,handleDeleteTurn:T,deleteTrace:w}):null]})]})}),tl=n(53104),tc=n.n(tl),td=e=>{let{children:t,className:n,type:a,disabled:s,onClick:o,show:i,loading:r,disable:l,handleCloseModal:d,conversation:_,conversationId:u,lasTurnAnsIdx:m}=e,h=(0,x.useMemo)(()=>_?_.turnList:[],[_]),{track:f}=(0,v.useTrack)();return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(p.ZP,{"data-sentry-element":"MyMessage","data-sentry-source-file":"ConvShareModal.tsx"}),(0,c.jsx)(Q.Z,{transitionName:tc().trans,style:{pointerEvents:"auto",top:"calc(50vh - 280px)"},getContainer:!1,keyboard:!0,maskClosable:!0,onCancel:d,onOk:d,title:"分享对话",content:(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:tc().share_chat_ctnt,children:(0,c.jsx)("div",{className:tc().conv_list,children:h?h.map((e,t)=>e&&"delete"!==e.status?(0,c.jsx)(tr,{...e,conversationId:"",setTurnFeedback:()=>{},isLast:!1,auth:{},specialAnsIdx:0===t?m:void 0,hasOperation:!1,botId:""},"".concat(null==e?void 0:e.turnId)):null):null})}),(0,c.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:40},children:(0,c.jsx)(G.Z,{className:tc().reback_btn,type:"primary",loading:!1,onClick:e=>{try{var t;let e=(0,ep.yP)();f("chat_conversation_shared_click",{uid:null==e?void 0:null===(t=e.user)||void 0===t?void 0:t.id})}catch(e){}o&&o(e)},disabled:!1,children:"复制分享链接"})})]}),open:i,"data-sentry-element":"MyModal","data-sentry-source-file":"ConvShareModal.tsx"})]})},t_=function(e){let{conversationId:t,conversation:n}=e,[a,s]=(0,x.useState)(!1),[o,i]=(0,x.useState)(""),r=(0,x.useRef)(null),{ansPrintStep:l,lasTurnAnsIdx:d}=(0,k.useConver)(),{needRealLogin:_,checkRealLogin:u}=(0,j.useGlobalExecuteState)(),m=(0,x.useMemo)(()=>d[t],[d,t]),{btnEnable:h}=(0,x.useMemo)(()=>n&&n.status&&"close"!==n.status&&"error"!==n.status&&"timeout"!==n.status?{btnEnable:!0}:{btnEnable:!1},[n]),v=(0,x.useCallback)(e=>{var t;null===(t=r.current)||void 0===t||t.info(e)},[r]),f=(0,x.useCallback)(async()=>{s(!0);let e=function(e,t){let{turnList:n}=e,a=[];return n&&n.forEach((e,n)=>{var s,o,i;let{sentenceList:r}=e,l=[],c=[];for(let e=0;e<r.length;++e){let t=r[e];1===t.direction?l.push(t):c.push(t)}a.push(null===(s=l[0])||void 0===s?void 0:s.sentenceId),0!==n||null==t?a.push(null===(o=c[c.length-1])||void 0===o?void 0:o.sentenceId):a.push(null===(i=c[t])||void 0===i?void 0:i.sentenceId)}),a}(n,m),a=await (0,q.Zi)({conversationId:t,sentenceIdList:e});if(0===a.code){let{baseUrl:e,shareId:t}=a.data;i("".concat(e).concat(t))}},[t,s,i,n,m]),g=(0,x.useCallback)(()=>{s(!1)},[s]),b=(0,x.useCallback)(()=>{X()(o),v("对话链接已复制"),g()},[o,g,v]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(p.ZP,{ref:r,"data-sentry-element":"MyMessage","data-sentry-source-file":"ChatShare.tsx"}),(0,c.jsx)(td,{conversation:n,conversationId:t,show:a,handleCloseModal:g,onClick:b,lasTurnAnsIdx:m,"data-sentry-element":"ConvShareModal","data-sentry-source-file":"ChatShare.tsx"}),!_&&(0,c.jsx)(z,{onClick:f,enable:!h})]})},tu=n(99424),tm=n(335),tp=n.n(tm);let th={header:{borderBottom:"none",padding:"24px 20px",background:"var(--common-title-label-bg,#F6F5F7)"},body:{background:"var(--common-title-label-bg,#F6F5F7)",padding:"24px 60px"}},tv=()=>{};function tf(e){var t,n,a,s;let{open:o=!1,botInfo:i,onClose:r=tv}=e,l=(0,x.useRef)(null),d=(0,x.useCallback)(e=>{var t;null===(t=l.current)||void 0===t||t.info(e)},[l]),_=(0,x.useCallback)(async()=>{let{id:e}=i;if(!e)return;let t=await (0,ex.$N)({botId:e});if(t.code===h.n8.SUCCESS){let{baseUrl:e,shareId:n}=t.data;X()("".concat(e).concat(n)),d("已复制链接，分享给朋友吧 \uD83C\uDF8A")}else d("分享失败，请稍后再试")},[i,d]),u=(0,x.useMemo)(()=>{var e;return!!(null==i?void 0:null===(e=i.extra)||void 0===e?void 0:e.openingRemarks)},[i]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(p.ZP,{ref:l,"data-sentry-element":"MyMessage","data-sentry-source-file":"index.tsx"}),(0,c.jsx)(tu.Z,{styles:th,open:o,width:480,onClose:()=>r(),getContainer:e=>(null==e?void 0:e.parentNode)||!1,closeIcon:(0,c.jsx)(m.Z,{className:tp().close_btn,name:"close"}),"data-sentry-element":"Drawer","data-sentry-source-file":"index.tsx",children:(0,c.jsxs)("div",{className:tp().bot_share_container,children:[(0,c.jsx)("div",{className:tp().bot_avatar_container,children:(0,c.jsx)("img",{className:tp().bot_avatar,src:null==i?void 0:i.avatar,alt:""})}),(0,c.jsx)("div",{className:tp().bot_name,children:u?null==i?void 0:null===(n=i.extra)||void 0===n?void 0:null===(t=n.openingRemarks)||void 0===t?void 0:t.descWeb:null==i?void 0:i.name}),(0,c.jsx)("div",{className:tp().bot_desc,children:u?null==i?void 0:null===(s=i.extra)||void 0===s?void 0:null===(a=s.openingRemarks)||void 0===a?void 0:a.fullDescWeb:null==i?void 0:i.openingRemarks}),(0,c.jsxs)("div",{className:"".concat(tp().btn_container," custom_button"),onClick:_,children:[(0,c.jsx)("div",{className:tp().backdrop}),(0,c.jsx)("div",{className:tp().share_btn,children:(0,c.jsx)("div",{children:"分享"})})]})]})})]})}var tx=n(43607),tg=n(67655),tb=n(25970),ty=n.n(tb);let tC={background:"#FFFFFF"};var tk=e=>{let{closeModal:t,show:n,appConfig:a,turnId:s,botId:o}=e,[i,r]=(0,x.useState)(""),[l,d]=(0,x.useState)(-1),[_,u]=(0,x.useState)(120),[m,v]=tg.ZP.useMessage(),f=(0,x.useRef)(null),g=(0,x.useMemo)(()=>i||-1!==l,[i,l]),b=e=>{var t;null===(t=f.current)||void 0===t||t.info(e)};(0,x.useEffect)(()=>{let e=window.matchMedia("(max-width: 879px)").matches;e&&u(100)},[]);let y=()=>{r(""),d(-1),t()},C=(0,x.useCallback)(e=>{r(e.target.value)},[]),k=async()=>{if(!g)return;let e=await (0,q.Od)({turnId:s,botId:o,reportType:l,reportInfo:i});e.code===h.n8.SUCCESS?b("感谢你的反馈"):b(e.msg),y()};return(0,c.jsxs)(c.Fragment,{children:[v,(0,c.jsx)(p.ZP,{ref:f,"data-sentry-element":"MyMessage","data-sentry-source-file":"ReportModal.tsx"}),(0,c.jsx)(Q.Z,{transitionName:ty().trans,style:{pointerEvents:"auto",top:"calc(50vh - 280px)"},keyboard:!0,maskClosable:!0,onCancel:y,onOk:y,title:"反馈",content:(0,c.jsxs)("div",{className:ty().report_modal,children:[(0,c.jsx)("div",{className:ty().feedback_container,children:a&&Array.isArray(a.feedbacks)?a.feedbacks.map(e=>(0,c.jsx)("div",{onClick:t=>{d(e.type)},className:ty().feed_item,"data-act":l===e.type,dataKey:e.type,children:(0,c.jsx)("div",{children:e.content})},e.type)):null}),(0,c.jsx)(tx.Z,{inputEnable:!0,value:i,onKeyUp:()=>{},onKeyDown:()=>{},onInput:C,sendMsg:()=>{},lineHeight:()=>{},maxLength:300,placeholder:"点击这里反馈内容",autoSize:!1,style:{...tC,height:_}}),(0,c.jsx)(G.Z,{className:ty().reback_btn,type:"primary",disabled:!g,onClick:k,children:"提交"})]}),open:n,"data-sentry-element":"Modal","data-sentry-source-file":"ReportModal.tsx"})]})},tj=x.memo(e=>{let{turnList:t,lastTurnId:n,conversationId:a,botId:s,botInfo:o,buildSse:i,auth:r,appConfig:l,isLastConversation:d,webSearch:_,lastedTurnIsNew:u,sseStatus:m}=e,[p,h]=(0,x.useState)(""),[v,f]=(0,x.useState)({turnId:-1,show:!1}),[g,b]=(0,x.useState)(!1),y=(0,x.useCallback)(()=>{f({turnId:-1,show:!1})},[f]);return(0,c.jsxs)(c.Fragment,{children:[t?t.map((e,t)=>e&&"delete"!==e.status?(0,c.jsx)(e5,{...e,conversationId:a,botId:s,botInfo:o,auth:r,buildSse:i,isLast:d&&0===t,editingTurnId:p,setEditingTurnId:h,appConfig:l,setTurnFeedback:f,webSearch:_,lastedTurnIsNew:u,sseStatus:m,setBotDrawerOpen:b},"".concat(null==e?void 0:e.turnId)):null):null,(0,c.jsx)(tk,{show:v.show,turnId:v.turnId,botId:s,closeModal:y,appConfig:l,"data-sentry-element":"ReportModal","data-sentry-source-file":"Conversation.tsx"}),(0,c.jsx)(tf,{open:g,botInfo:o,onClose:()=>b(!1),"data-sentry-element":"BotShareDrawer","data-sentry-source-file":"Conversation.tsx"})]})}),tI=n(68518),tN=n.n(tI),tw=e=>{let{appConfig:t}=e,{deleteTurnFromConv:n,deleteTurnModalShow:a,setDeleteTurnModalShow:s,deleteTurnInfo:o,deleteSuggestByConversationId:i,currentConverTurns:r,changeChatUrl:l}=(0,k.useConver)(),{refreshChatList:d,deleteConv:u}=(0,_.useChat)(),{track:m}=(0,v.useTrack)(),[f,g]=(0,x.useState)(!1),b=(0,J.useRouter)(),y=(0,x.useRef)(null),C=(0,x.useCallback)(e=>{var t;null===(t=y.current)||void 0===t||t.info(e)},[y]),j=(0,x.useCallback)(()=>{let{trackParams:e}=o;s(!1),m("chat_delete_turn_click",{...e,bhv_type:"click",action:"cancel"})},[s,o]),{resetList:I}=(0,F.Z)(e=>e),N=(0,x.useCallback)(async()=>{let{conversationId:e,turnId:a,isLastTurn:s,trackParams:c}=o;if(!e||!a)return;g(!0),m("chat_delete_turn_click",{...c,bhv_type:"click",action:"confirm"});let d=await (0,q.oY)({conversationId:e,turnId:a});if(g(!1),d.code===h.n8.SUCCESS){let o=r(e);if(o<2){let n=await (0,q.jS)(t.bot.id,e);n.code===h.n8.SUCCESS&&u(e),b.replace("/"),l("")}n(e,a),I(),s&&i(e),m("chat_delete_turn_result",{...c,bhv_type:"click",result:!0})}else C("删除对话失败，请稍后重试。"),m("chat_delete_turn_result",{...c,bhv_type:"click",result:!1});j()},[o,i,n,d,u,b,t,r,C,j,g]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(p.ZP,{ref:y,"data-sentry-element":"MyMessage","data-sentry-source-file":"index.tsx"}),(0,c.jsx)(Q.Z,{transitionName:tN().trans,style:{pointerEvents:"auto",top:"calc(50vh - 280px)"},keyboard:!0,maskClosable:!0,onCancel:j,onOk:N,title:"是否删除这组消息",content:(0,c.jsxs)("div",{className:tN().modal,children:[(0,c.jsx)("div",{className:tN().modal_content,children:"当前的回答和问题会一起被删除！"}),(0,c.jsxs)("div",{className:tN().btn_container,children:[(0,c.jsx)(G.Z,{className:tN().modal_cancel,onClick:j,children:"不删除"}),(0,c.jsx)(G.Z,{type:"primary",loading:f,className:tN().modal_confirm,onClick:N,children:"删除"})]})]}),open:a,"data-sentry-element":"Modal","data-sentry-source-file":"index.tsx"})]})},tT=n(26411),tS=n.n(tT),tP=x.memo(e=>{let{type:t}=e;return(0,c.jsx)("span",{className:tS().loader,"data-sentry-component":"LoaidingAnim","data-sentry-source-file":"index.tsx"})}),tA=n(5145),tE=n.n(tA),tR=e=>{let{data:t,show:n,botId:a,botInfo:s,lastedTurnIsNew:o,sseStatus:i,lastTurn:r}=e,{conversationId:l,turnId:d,contents:_,qSentenceId:u,aSentenceId:m,customAttrs:p}=t,f=(0,x.useRef)(null),{track:g}=(0,v.useTrack)(),{getChatCustomParams:b}=(0,ez.useConverMenuContext)(),y=(0,x.useMemo)(()=>n&&_&&"close"===i,[n,_,d,m,i]),C=(0,x.useMemo)(()=>{let e="generateEnd"===i;return e},[i,d,m]),k=(0,J.useSearchParams)(),j=k.get("inner_refer")||"history",N=(0,x.useMemo)(()=>{var e;return(null==r?void 0:null===(e=r.sentenceList)||void 0===e?void 0:e.filter(e=>1===e.direction))||[]},[r]),w=e=>e&&e.capability,T=(0,x.useCallback)((e,t)=>{let n=w(e);if(n){var i;let n="";N[0].contents||(n=(0,eV.V)(N[0].mediaInfos));let r=(null==e?void 0:e.defaultQuery)||(null===(i=N[0])||void 0===i?void 0:i.contents)||"";g("chat_other_bot_related_suggestion_click",{page:h.fK.CHAT.key,area:h.fK.CHAT.area.CONVERSATION.key,element:h.fK.CHAT.area.CONVERSATION.element.RELATED_QUESTION,index:"".concat(t),bhv_type:"click",conversation_id:l,turn_id:d,a_sentence_id:m,q_sentence_id:u,content:r,input_way:null==p?void 0:p.input_way,is_new_start:o,refer_page:j,other_bot_id:(null==e?void 0:e.botId)||"",other_bot_desc:(null==e?void 0:e.botDesc)||""}),I.Z.sendMsgToBot({botId:a,botAlias:(null==s?void 0:s.alias)||"",rewriteQuery:n,mediaInfos:N[0].mediaInfos,conversationId:l,contents:r,strategy:{isRetry:!1,breakingStrategy:0},uuid:l,inputWay:h.zY.INPUT_WAY.RELATIVED,customAttrs:{input_way:h.zY.INPUT_WAY.RELATIVED},customParams:{capabilities:[e]}})}else{let t=b(e);I.Z.sendMsgToBot({botId:a,botAlias:(null==s?void 0:s.alias)||"",conversationId:l,contents:e,strategy:{isRetry:!1,breakingStrategy:0},uuid:l,inputWay:h.zY.INPUT_WAY.RELATIVED,customAttrs:{input_way:h.zY.INPUT_WAY.RELATIVED},customParams:t})}g("chat_conversation_related_question_click",{page:h.fK.CHAT.key,area:h.fK.CHAT.area.CONVERSATION.key,element:h.fK.CHAT.area.CONVERSATION.element.RELATED_QUESTION,index:"".concat(t),bhv_type:"click",conversation_id:l,turn_id:d,a_sentence_id:m,q_sentence_id:u,content:e,input_way:null==p?void 0:p.input_way,is_new_start:o,refer_page:j})},[a,null==s?void 0:s.alias,p,N,g,l,d,m,u,o,j,b]),S=(0,x.useCallback)((e,t)=>{let n=e[0].isIntersecting;n&&_.forEach((e,t)=>{g("chat_conversation_related_question_exposure",{page:h.fK.CHAT.key,area:h.fK.CHAT.area.CONVERSATION.key,element:h.fK.CHAT.area.CONVERSATION.element.RELATED_QUESTION,index:"".concat(t),bhv_type:"exposure",conversation_id:l,turn_id:d,a_sentence_id:m,q_sentence_id:u,content:e,input_way:null==p?void 0:p.input_way,is_new_start:o,refer_page:j})})},[p,g,l,d,m,u,j,o,_]);return(0,x.useEffect)(()=>{let e=new IntersectionObserver(S);return f.current&&e.observe(f.current),()=>e.disconnect()},[y,f,_]),(0,c.jsxs)(c.Fragment,{children:[y?(0,c.jsx)("div",{ref:f,className:tE().container,children:_.map((e,t)=>(0,c.jsx)("div",{onClick:()=>{T(e,t)},className:"".concat(tE().suggested_q," suggestion_itm"),style:{display:w(e)?"none":"flex"},children:w(e)?null:(0,c.jsx)(e6.U,{content:e})},"".concat(e,"_").concat(t)))}):null,C?(0,c.jsx)("div",{className:tE().container,children:(0,c.jsx)("div",{className:tE().loading_container,children:(0,c.jsx)(tP,{type:"text"})})}):null]})};(i=l||(l={}))[i.XIAO_BAI_YAN_BAO=0]="XIAO_BAI_YAN_BAO";var tM=n(40223),tB=n(12023),tD=n(16691),tL=n.n(tD),tO=n(27879),tZ=n.n(tO);let tF={[l.XIAO_BAI_YAN_BAO]:function(e){let{data:t}=e,{cardId:n,title:a,coverImage:s}=t,{track:o}=(0,v.useTrack)(),i=(0,tB.Z)(()=>{o("chat_suggestion_reco_xbyb_show",{bhv_type:"exposure",card_id:n})}),r=(0,tB.Z)(()=>{o("chat_suggestion_reco_xbyb_click",{bhv_type:"click",card_id:n})}),{isLightMode:l}=(0,eo.useViewConfigState)(),{openExternalUrl:d}=(0,ei.ky)(),{info:_,MessageContextHolder:u}=(0,p.il)(),f=(0,x.useCallback)(async()=>{r();let e=await (0,tM.U)({cardId:n});if(e.code===h.n8.SUCCESS){let{baseUrl:t,shareId:n}=e.data;d("".concat(t).concat(n))}else _("获取数据失败，请稍后再试")},[n,_,d,r]),g=(0,x.useMemo)(()=>{let e=l?"/chatContent/xbyb_reco_light.png":"/chatContent/xbyb_reco_dark.png";return(null==s?void 0:s.url)||e},[s,l]);return(0,x.useEffect)(()=>{i()},[i]),(0,c.jsxs)(c.Fragment,{children:[u,(0,c.jsxs)("div",{className:tZ().card,onClick:f,children:[(0,c.jsxs)("div",{className:tZ().left,children:[(0,c.jsxs)("div",{className:tZ().tag,children:[(0,c.jsx)(m.Z,{name:"xiaobairesearch",className:tZ().icon,"data-sentry-element":"IconFont","data-sentry-source-file":"XiaoBaiYanBao.tsx"}),(0,c.jsx)("div",{className:tZ().text,children:"小白研报"})]}),(0,c.jsx)("div",{className:tZ().title,children:a})]}),(0,c.jsx)("div",{className:tZ().right,children:(0,c.jsx)("div",{className:tZ().image_cnt,children:(0,c.jsx)(tL(),{src:g,alt:"",width:84,height:84,"data-sentry-element":"Image","data-sentry-source-file":"XiaoBaiYanBao.tsx"})})})]})]})}};function tU(e){let{className:t="",type:n,listData:a}=e,s=tF[n];return s?a.map((e,a)=>(0,c.jsx)("div",{className:t,children:(0,c.jsx)(s,{data:e})},"".concat(n,"_").concat(a))):null}var tV=n(48193),tY=n.n(tV),tK=e=>{let{data:t,show:n,sseStatus:a}=e,{contents:s=[]}=t,o=(0,x.useMemo)(()=>n&&s.length&&"close"===a,[n,s,a]),i=e=>{let{type:t}=e,n=[];return t===l.XIAO_BAI_YAN_BAO&&(n=e.deepResearchCards||[]),n.slice(0,2)};return(0,c.jsx)(c.Fragment,{children:o?(0,c.jsxs)("div",{className:tY().suggestion_reco_container,children:[(0,c.jsx)("div",{className:tY().title,children:"延展阅读"}),(0,c.jsx)("div",{className:tY().cnt,children:s.map((e,t)=>(0,c.jsx)(tU,{className:tY().reco_item,type:e.type,listData:i(e)},"".concat(e.type,"_").concat(t)))})]}):null})},tH=x.memo((e,t)=>{let{botId:n,botInfo:a,appConfig:s,auth:o,conversationId:i}=e,r=(0,x.useRef)(null);!function(e,t){let{scrollAmount:n=50,behavior:a="auto"}=t||{};(0,x.useEffect)(()=>{let t=e.current;if(!t)return;let s=e=>{e.target===document.body&&("ArrowUp"===e.key?(t.scrollBy({top:-n,behavior:a}),e.preventDefault()):"ArrowDown"===e.key&&(t.scrollBy({top:n,behavior:a}),e.preventDefault()))};return document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s)}},[e,n])}(r,{scrollAmount:100,behavior:"instant"}),P();let{suggestedQuestion:l,conversations:d,suggestedQuestionShow:_,suggestionReco:u,suggestionRecoShow:m,webSearch:p,initOneConversation:h,noMore:v,getMoreHistoryConversation:f}=(0,k.useConver)();U([]);let g=(0,x.useMemo)(()=>d[i],[d,i]),b=(0,x.useMemo)(()=>{if(!g)return{};{let{turnList:e}=g;return e[0]}},[g]),y=(0,x.useMemo)(()=>{if(!g)return"";{var e;let{turnList:t}=g;return null===(e=t[0])||void 0===e?void 0:e.turnId}},[g]),C=(0,x.useMemo)(()=>!v[i],[v,i]),j=(0,x.useMemo)(()=>{if(g){let{turnList:e}=g;return e.length}return 0},[g]),I=(0,x.useMemo)(()=>{let e=d[i];return null==e?void 0:e.status},[d,i]),N=(0,x.useMemo)(()=>u[i]||[],[i,u]),w=(0,x.useMemo)(()=>m[i],[i,m]),T=(0,x.useMemo)(()=>l[i]||{},[i,l]),S=(0,x.useMemo)(()=>_[i],[i,_,w]),E=(0,x.useMemo)(()=>{if(g){let{turnList:e}=g;return e.length<2}return!0},[g]),M=(0,x.useMemo)(()=>p[i],[p,i]),L=(0,x.useRef)(null);(0,x.useEffect)(()=>{g&&"before"===g.status&&setTimeout(F,300)},[g]);let Z=(0,x.useCallback)(async()=>f({conversationId:i,botId:n}),[i,f,n]),F=()=>{L&&L.current.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})};return(0,x.useEffect)(()=>{async function e(){i&&h({conversationId:i,botId:n})}let t=B()(e,500);t()},[n,i]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{id:"scrollableChatContentDiv",ref:r,className:R()([O().chat_content_scroller,O()["infinite-scroll-component"]]),children:[(0,c.jsx)(tw,{appConfig:s,"data-sentry-element":"DeleteTurnModal","data-sentry-source-file":"ChatContent.tsx"}),(0,c.jsxs)(D.Z,{scrollableTarget:"scrollableChatContentDiv",dataLength:j,next:Z,hasMore:C,loader:(0,c.jsx)("div",{style:{margin:"20px",display:"flex",justifyContent:"center"},children:(0,c.jsx)(A.Z,{})}),pullDownToRefreshThreshold:50,style:{display:"flex",flexDirection:"column-reverse"},inverse:!0,"data-sentry-element":"InfiniteScroll","data-sentry-source-file":"ChatContent.tsx",children:[(0,c.jsx)("div",{ref:L}),g?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(tK,{show:w,data:N,sseStatus:I}),(0,c.jsx)(tR,{botId:n,botInfo:a,data:T,show:S,lastedTurnIsNew:E,sseStatus:I,lastTurn:b}),(0,c.jsx)(tj,{...g,botId:n,botInfo:a,lastTurnId:y,conversationId:i,auth:o,appConfig:s,webSearch:M,isLastConversation:!0,sseStatus:I},g.conversationId)]}):null]})]}),(0,c.jsx)(t_,{conversation:g,conversationId:i,"data-sentry-element":"ChatShare","data-sentry-source-file":"ChatContent.tsx"})]})}),tz=n(55803),tq=n(94107),tW=n(9562),tX=n(94621),tG=n.n(tX);function tQ(e){let{className:t="",style:n,data:a}=e,{tagText:s,description:o,image:i}=a;return(0,c.jsxs)("div",{className:R()(tG().content_wrapper,t),style:n,"data-sentry-component":"BannerCase","data-sentry-source-file":"index.tsx",children:[(0,c.jsx)("img",{className:tG().bkg_img,src:i,alt:""}),(0,c.jsx)("div",{className:tG().tag,children:s}),(0,c.jsx)("div",{className:tG().mask,children:(0,c.jsxs)("div",{className:tG().mask_cnt,children:[(0,c.jsx)("div",{className:tG().desc,children:o}),(0,c.jsx)("div",{className:tG().btn,children:"做同款"})]})})]})}var tJ=n(96056),t$=n.n(tJ);function t0(e){let{className:t="",style:n,data:a,isFlip:s=!1}=e,{title:o,tagText:i,description:r,image:l}=a;return(0,c.jsxs)("div",{className:R()(t$().content_wrapper,t),style:n,"data-sentry-component":"BannerCase","data-sentry-source-file":"index.tsx",children:[(0,c.jsxs)("div",{className:t$().content,children:[(0,c.jsx)("div",{className:t$().title,children:o}),(0,c.jsx)("div",{className:R()(t$().desc,o&&t$().has_title),children:r})]}),(0,c.jsx)("div",{className:t$().shadow,children:(0,c.jsxs)("div",{className:t$().img_container,children:[(0,c.jsx)("img",{src:l,alt:"wenxiaobai"}),s&&(0,c.jsx)("div",{className:t$().empty_rotate})]})}),(0,c.jsx)("div",{className:t$().tag,children:i})]})}var t1=n(27047),t2=n.n(t1);function t4(e){let{className:t="",style:n,data:a}=e,{title:s,description:o,image:i}=a;return(0,c.jsx)("div",{className:R()(t2().content_wrapper,t),style:n,"data-sentry-component":"BannerCase","data-sentry-source-file":"index.tsx",children:(0,c.jsxs)("div",{className:t2().content,children:[(0,c.jsx)("img",{className:t2().icon,src:i,alt:""}),(0,c.jsx)("div",{className:t2().title,children:s}),(0,c.jsx)("div",{className:t2().desc,children:o})]})})}var t7=n(57141),t3=n.n(t7);let t5=["ppt"];function t6(e){let{className:t="",style:n={},menuKey:a,meta:s,data:o}=e,{showType:i="banner"}=s,r=(0,x.useMemo)(()=>R()(t3().item,t),[t]);return"banner"===i?(0,c.jsx)(t0,{className:r,style:n,data:o,isFlip:t5.includes(a)}):"card"===i?(0,c.jsx)(t4,{className:r,style:n,data:o}):"background"===i?(0,c.jsx)(tQ,{className:r,style:n,data:o}):null}var t9=n(6418),t8=n.n(t9);function ne(e){let{className:t="",menuKey:n,onInputValue:a,onInputFocus:s}=e,o=(0,J.useRouter)(),{openExternalUrl:i}=(0,ei.ky)(),{data:r}=(0,tq.d)(tW.t.ConverCase),l=(0,x.useMemo)(()=>(null==r?void 0:r[n])||{},[r,n]),{meta:d={},data:{moreUrl:_="",list:u=[]}={}}=l,{lineCount:p=3,showCount:h=3,actionType:v="url"}=d,f=(0,x.useMemo)(()=>u.slice(0,h),[u,h]),g=(0,x.useMemo)(()=>!!_,[_]),b=(0,x.useMemo)(()=>"deep_research"===n,[n]),y=(0,x.useCallback)(()=>{if(!g)return;let e=_.startsWith("/");e?o.push(_):i(_)},[g,i,_,o]),C=e=>{let{url:t="",prompt:n=""}=e;if("url"===v){if(b){let{origin:e}=(0,ep.mN)();t=t.includes("/share/chat/")?t:(0,eO.xq)(e,t)}i(t)}"prompt"===v&&(a(n),s())};return(0,c.jsxs)("div",{className:R()(t8().case_list,!b&&t8().not_deep_research,t),"data-sentry-component":"ConverCase","data-sentry-source-file":"index.tsx",children:[(0,c.jsx)("div",{className:R()(t8().case_list_cnt,b&&t8().deep_inner),children:f.map((e,t)=>(0,c.jsx)("div",{className:R()(t8().case_item,b&&t8().deep_table),style:{width:"calc((100% - ".concat(p-1," * 10px) / ").concat(p,")")},onClick:()=>C(e),children:(0,c.jsx)(t6,{menuKey:n,meta:d,data:e})},"".concat(n,"_").concat(t)))}),g&&(0,c.jsx)("div",{className:t8().show_more,children:(0,c.jsxs)("div",{className:t8().cnt,onClick:y,children:[(0,c.jsx)("span",{children:"更多优秀案例"}),(0,c.jsx)(m.Z,{className:t8().deep_header_more_icon,name:"regenerate-1"})]})})]})}var nt=n(67559),nn=n(27857),na=n(20914),ns=n.n(na);function no(e){let{botId:t,botInfo:n,appConfig:a,recommend:s,resetBot:o=!0}=e,{chatBot:i,mergeBotInfo:r,botInfoMap:l}=(0,_.useChat)(),{setCommonData:m}=(0,v.useTrack)(),{showRightSide:p,setShowRightSide:f}=(0,u.useMobileTrans)(),{mainConverItem:g,selectMenuWithKey:b}=(0,ez.useConverMenuContext)(),{currentConversationId:y,nextConversationId:I,curChatBotId:N,setCurrentBotId:w,isDeepResearchBot:T}=(0,k.useConver)(),{auth:S,checkRealLogin:P,needLogin:A,setUserLoginModalShow:E}=(0,j.useGlobalExecuteState)();(0,nn.Z)(async()=>{if(null==S?void 0:S.token){let{code:e,data:n}=await (0,ex.mn)(t);e===h.n8.SUCCESS&&r({[n.id]:n})}},[S]);let R=(0,tB.Z)(()=>{(!N||o)&&w(t)});(0,x.useEffect)(()=>{R()},[t,R]),(0,x.useEffect)(()=>{r({[t]:n})},[t,n,r]);let M=(0,J.useSearchParams)(),B=(0,x.useRef)(null),D=(0,x.useMemo)(()=>i?i.name:"",[i]),{isShowDeepResearchPayment:L}=(0,eR.P)(e=>e),{isDebug:O}=(0,ei.qi)(),[Z,F]=(0,x.useMemo)(()=>{let e,a;return N&&l[N]?(e=N,a=l[N]):(e=t,a=n||(0,ep.Nx)({id:Number(e),state:O?em.yq.ON_LINE:em.yq.OFF_LINE,avatar:""})),[e,a]},[l,N,O,t,n]),{initMenuItems:U}=(0,ez.useConverMenuContext)();(0,x.useEffect)(()=>{var e;let t=(null==F?void 0:null===(e=F.extra)||void 0===e?void 0:e.multimodalCapabilities)||[];U(t,a)},[F,U,a]),(0,x.useEffect)(()=>{let e=M.get("toBotKey");e&&b(e)},[M,b]);let V=(0,x.useMemo)(()=>(null==F?void 0:F.state)===1,[F]);(0,x.useEffect)(()=>{m({bot_id:Z,bot_name:F.name})},[Z,F,m]),(0,x.useEffect)(()=>{if(f(),!y){var e;null===(e=B.current)||void 0===e||e.focus()}},[y]);let Y=(0,J.useRouter)(),{diffLoginAction:K}=(0,ei._7)({botInfo:F,info:()=>{}}),H=(0,x.useMemo)(()=>A?"":I,[A,I]),z=(0,x.useMemo)(()=>A?K:void 0,[A,K]);return(0,c.jsxs)(nt.V9,{hashPriority:"high",transformers:[nt.IJ],"data-sentry-element":"StyleProvider","data-sentry-component":"BotChatPageClient","data-sentry-source-file":"index.tsx",children:[(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("div",{className:"".concat(ns().inlet," ").concat(y?ns().inlet_vis:""),onClick:e=>{e.stopPropagation(),Y.push("/chat/downloadPage")}})}),(0,c.jsx)(C,{disabled:!0,visible:!1,conversationId:y,nextConversationId:I,preCheck:P,uploadType:"file","data-sentry-element":"DropUpload","data-sentry-source-file":"index.tsx",children:(0,c.jsxs)("div",{className:"".concat(ns().page_container),"data-sidebarvisible":p,children:[V&&(0,c.jsx)("div",{className:ns().bot_offline_mask,children:(0,c.jsxs)("div",{className:ns().bot_offline_content,children:[(0,c.jsx)("div",{className:ns().bot_offline_tip,children:"当前智能体已下线，看看其它智能体吧"}),(0,c.jsxs)("div",{className:"".concat(ns().bot_offline_ctn," custom_button"),onClick:()=>{Y.push("/chat/bots")},children:[(0,c.jsx)("div",{className:ns().backdrop}),(0,c.jsx)("div",{className:ns().footer_dwn_btn,children:(0,c.jsx)("div",{children:"查看全部智能体"})})]})]})}),(0,c.jsx)(d.Z,{title:D,"data-sentry-element":"PageHeader","data-sentry-source-file":"index.tsx"}),y?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(tH,{botId:Z,botInfo:F,appConfig:a,auth:S,conversationId:y}),!T&&!L&&(0,c.jsx)(eV.Z,{conversationId:y,botId:Z,botInfo:F,appConfig:a,isNewConversation:!1,auth:S,showBottomMsg:!1})]}):(0,c.jsx)("div",{className:"".concat(ns().empty_content," ").concat(ns().empty_content_vis),children:(0,c.jsx)(tz.Z,{botId:Z,botInfo:F,appConfig:a,recommend:s,nextConvId:H,forceLogin:z,children:(0,c.jsxs)("div",{children:[(0,c.jsx)(eV.Z,{ref:B,conversationId:H,newConv:!0,botId:Z,botInfo:F,isNewConversation:!0,appConfig:a,auth:S,showBottomMsg:!0,forceLogin:z}),(0,c.jsx)(ne,{className:(null==g?void 0:g.key)&&!y?"":ns().hidden,menuKey:g.key,onInputValue:e=>{var t;null===(t=B.current)||void 0===t||t.input(e)},onInputFocus:e=>{var t;null===(t=B.current)||void 0===t||t.focus()}})]})})})]})})]})}},27457:function(e,t,n){"use strict";var a=n(57437),s=n(54105),o=n.n(s);t.Z=e=>{let{children:t,className:n,type:s,disabled:i,onClick:r,loading:l}=e;return(0,a.jsxs)("div",{className:"".concat(o().btn," ").concat("primary"===s?i?o().disabled:o().enable:""," ").concat(n),onClick:r,"data-sentry-component":"MyButton","data-sentry-source-file":"index.tsx",children:[l?(0,a.jsx)("span",{className:o().btn_loading}):null,t]})}},73417:function(e,t,n){"use strict";var a=n(57437),s=n(54952),o=n(98720);n(2265),t.Z=()=>(0,a.jsx)(o.Z,{indicator:(0,a.jsx)(s.Z,{style:{fontSize:24},spin:!0}),"data-sentry-element":"Spin","data-sentry-component":"App","data-sentry-source-file":"SmallLoading.tsx"})},13977:function(e,t,n){"use strict";var a=n(57437),s=n(33746);n(94598),n(2265);var o=n(16063),i=n(49748),r=n.n(i);t.Z=e=>{let{wrapClassName:t,containerClassName:n,style:i,getContainer:l,keyboard:c,closable:d=!0,maskClosable:_,onCancel:u,onOk:m,title:p,content:h,open:v,CustomClose:f}=e;return(0,a.jsx)(s.Z,{style:{...i},getContainer:l,keyboard:c,maskClosable:_,onClose:u,visible:v,animation:"zoom",maskAnimation:"fade",className:t,footer:null,title:null,modalRender:()=>(0,a.jsxs)("div",{className:"".concat(r().modal_container," ").concat(n),children:[d?f||(0,a.jsx)(o.Z,{onClick:u,className:r().modal_close,name:"close"}):null,(0,a.jsx)("div",{className:r().modal_title,children:p}),(0,a.jsx)("div",{children:h})]}),"data-sentry-element":"Dialog","data-sentry-component":"MyModal","data-sentry-source-file":"index.tsx"})}},1433:function(e,t,n){"use strict";n.d(t,{$N:function(){return _},Pg:function(){return i},Un:function(){return c},mn:function(){return d},rd:function(){return l},ti:function(){return r}});var a=n(97179),s=n(14586),o=n(23851);async function i(e,t){let n=(0,s.oo)(),i={url:"".concat((0,a.eD)(a.tW),"/bots/users/").concat(e),method:"GET",headers:{"X-Yuanshi-Authorization":"Bearer "+t,"X-Yuanshi-DeviceId":n}};return(0,o.ZP)(i)}function r(){let e={url:"",method:"",headers:{}},t=(0,s.oo)();e.url="".concat((0,a.A6)(a.tW),"/aippt/tokens"),e.method="GET";let n=(0,s.yP)();return e.headers={"X-Yuanshi-DeviceId":t,"X-Yuanshi-Authorization":"Bearer ".concat(null==n?void 0:n.token)},(0,o.ZP)(e)}function l(e){let t=(0,s.oo)(),n=(0,s.yP)(),i={url:"".concat((0,a.A6)(a.tW),"/conversations/conversation/ppt"),method:"POST",headers:{"X-Yuanshi-DeviceId":t,"X-Yuanshi-Authorization":"Bearer ".concat(null==n?void 0:n.token)},data:e||{}};return(0,o.ZP)(i)}function c(e){let t=(0,s.oo)(),n=(0,s.yP)(),i={url:"".concat((0,a.A6)(a.tW),"/aippt/download"),method:"POST",headers:{"x-api-key":"67b2d4d155a29","x-token":"".concat(e.token),"X-Yuanshi-DeviceId":t,"X-Yuanshi-Authorization":"Bearer ".concat(null==n?void 0:n.token)},data:e};return(0,o.ZP)(i)}async function d(e){let t=(0,s.yP)(),n={url:"".concat((0,a.A6)(a.tW),"/bot/query?botId=").concat(e),method:"GET",headers:{"X-Yuanshi-Authorization":"Bearer "+t.token,"X-Yuanshi-Platform":"web"}};return(0,o.ZP)(n)}function _(e){let{botId:t}=e,n=(0,s.oo)(),i=(0,s.yP)();if(!i||!n)return Promise.reject();{let e={url:"".concat((0,a.A6)(a.tW),"/share/bot"),method:"POST",headers:{"X-Yuanshi-Authorization":"Bearer "+i.token,"X-Yuanshi-DeviceId":n},data:{botId:t}};return(0,o.ZP)(e)}}},9562:function(e,t,n){"use strict";var a,s;n.d(t,{t:function(){return a}}),(s=a||(a={})).DeepResearch="deep-research",s.ConverCase="conver-case"},20914:function(e){e.exports={hidden:"botChatPage_hidden__PT9ar",page_loading:"botChatPage_page_loading__mii29",page_container:"botChatPage_page_container__h5moB",bot_offline_mask:"botChatPage_bot_offline_mask__1wNT5",bot_offline_content:"botChatPage_bot_offline_content__4aPN1",bot_offline_tip:"botChatPage_bot_offline_tip__fmGVH",bot_offline_ctn:"botChatPage_bot_offline_ctn__Mb7ow",backdrop:"botChatPage_backdrop__ic7Q1",footer_dwn_btn:"botChatPage_footer_dwn_btn__krp8Z",empty_content:"botChatPage_empty_content__1Q_q6",empty_content_vis:"botChatPage_empty_content_vis__oha3S",page_container_deep_research:"botChatPage_page_container_deep_research__T0se1",inlet:"botChatPage_inlet__ekN0J",inlet_vis:"botChatPage_inlet_vis__eeeKe"}},91123:function(e){e.exports={"ai-ppt-block":"Aippt_ai-ppt-block__pPjaC",ppt_icon:"Aippt_ppt_icon__Ka0l_",ppt_cover_url:"Aippt_ppt_cover_url__Fdoa0",ai_ppt_one_key:"Aippt_ai_ppt_one_key___7eT0",ppt_down:"Aippt_ppt_down__pINkC",download_btn:"Aippt_download_btn__aDNTW"}},53104:function(e){e.exports={conv_list:"share_conv_list___v8Yy",share_chat_ctnt:"share_share_chat_ctnt__HP_Or",reback_btn:"share_reback_btn__PVLsF"}},25970:function(e){e.exports={report_modal:"ReportModal_report_modal__G_ty0",feed_item:"ReportModal_feed_item__3a1kC",feed_item_act:"ReportModal_feed_item_act__Owh1T",feedback_container:"ReportModal_feedback_container__C3LOQ",reback_btn:"ReportModal_reback_btn__f0Bsd"}},31804:function(e){e.exports={operation_l:"TurnCard_operation_l__uEet_",opt_btn:"TurnCard_opt_btn__6A_0Y",bottom_icon:"TurnCard_bottom_icon__VOrI2",act:"TurnCard_act___em32",left_opts:"TurnCard_left_opts__NSU4V",right_opts:"TurnCard_right_opts__9bP6m",more_opts_show:"TurnCard_more_opts_show__v9C2K",opt_name:"TurnCard_opt_name__A6Q_I",opt_btn_disable:"TurnCard_opt_btn_disable__frhdQ",opt_btn_icon:"TurnCard_opt_btn_icon__oV__7",copy_icon:"TurnCard_copy_icon__Asvlf",more_opts_btn:"TurnCard_more_opts_btn__TJMLM",like:"TurnCard_like__CQ3pl",dislike:"TurnCard_dislike___9otm",delete_icon:"TurnCard_delete_icon__6CgWj",dislike_name_act:"TurnCard_dislike_name_act__0ERA2",left_btn:"TurnCard_left_btn__8D8EX",right_btn:"TurnCard_right_btn__TbD7e",reload_btn:"TurnCard_reload_btn__nJuqb",answer_container:"TurnCard_answer_container__O33Ch",answer_content:"TurnCard_answer_content__Yomkd",answer_loading_msg:"TurnCard_answer_loading_msg__SauNX",opt_content:"TurnCard_opt_content__IO6N8",turn_container:"TurnCard_turn_container__BIcGD",page_text:"TurnCard_page_text__GPd4o",answer_hidden:"TurnCard_answer_hidden__lcskz"}},5145:function(e){e.exports={suggested_q:"suggestedQuestion_suggested_q__Vxhay",suggested_r1:"suggestedQuestion_suggested_r1__7XqcW",icon:"suggestedQuestion_icon__Kt0Ru",text:"suggestedQuestion_text__fBSWY",container:"suggestedQuestion_container__P8Y4G",loading_container:"suggestedQuestion_loading_container__38DZc",enter:"suggestedQuestion_enter__e_coM"}},54105:function(e){e.exports={btn:"Button_btn__bJHsP",disabled:"Button_disabled__anlhz",enable:"Button_enable__jckq2",btn_loading:"Button_btn_loading__W9LPe",roll_loading:"Button_roll_loading__YttFX"}},77577:function(e){e.exports={share_btn_container:"ConverShare_share_btn_container__Gx0SN",disabled:"ConverShare_disabled__5RjTw",share_icon:"ConverShare_share_icon__NiycO",share_text:"ConverShare_share_text__wvsq0"}},16886:function(e){e.exports={export_icon:"ExportFile_export_icon__aojEP",raw_btn_top:"ExportFile_raw_btn_top__FH6vg",raw_btn:"ExportFile_raw_btn__Y5aNm",raw_btn_dark:"ExportFile_raw_btn_dark__wU9l9",raw_btn_bottom:"ExportFile_raw_btn_bottom__9O57Y",export_file_pdf:"ExportFile_export_file_pdf__hUpwn",export_file_docx:"ExportFile_export_file_docx__BGk00",opt_btn:"ExportFile_opt_btn__epzFQ",opt_btn_disable:"ExportFile_opt_btn_disable__ZKaRX",opt_btn_loading:"ExportFile_opt_btn_loading__KU_iG",opt_btn_notext:"ExportFile_opt_btn_notext__v_UM6",opt_btn_icon:"ExportFile_opt_btn_icon__snv2y",opt_name:"ExportFile_opt_name__ZLifR",loader:"ExportFile_loader__0__U7",rotation:"ExportFile_rotation__E50U7"}},26411:function(e){e.exports={"dot-flashing":"style_dot-flashing___2Rko",text:"style_text__n1uQ6",avatar:"style_avatar__LQ52c","dot-flashing-avatar":"style_dot-flashing-avatar__iPoFF",dot:"style_dot__j3A0W",loader:"style_loader__dT6gK",animloader:"style_animloader__tWtW0"}},49748:function(e){e.exports={modal_container:"Modal_modal_container__Wkym7",modal_title:"Modal_modal_title__oN0yt",modal_close:"Modal_modal_close__pl__X"}},68518:function(e){e.exports={right:"page_right__UMq_q",input_content:"page_input_content__SNh9E",input_mask:"page_input_mask__VH_0c",inlet:"page_inlet__18DL5",ellipsis_ctl:"page_ellipsis_ctl__iEApr",ellipsis_icon:"page_ellipsis_icon__17gBR",term:"page_term__AEJTs",term_content:"page_term_content__5k1UP",check_cont:"page_check_cont__HuQ64",modal_cancel:"page_modal_cancel__E5e3Q",modal_confirm:"page_modal_confirm__y3Ano",modal_title:"page_modal_title__a4T_3",modal_content:"page_modal_content__s3GWi",modal_term:"page_modal_term___UGfX",modal:"page_modal__Zu_ho",clost_icon:"page_clost_icon__KMwO3",btn_container:"page_btn_container__qs585",bot_glass:"page_bot_glass__h_7q3",left:"page_left__kiRJI",main_content:"page_main_content__387OI"}},335:function(e){e.exports={bot_share_container:"BotShareDrawer_bot_share_container__MMtQB",bot_avatar_container:"BotShareDrawer_bot_avatar_container__7CHNZ",bot_avatar:"BotShareDrawer_bot_avatar__6_bmF",bot_name:"BotShareDrawer_bot_name__fm9Ue",bot_desc:"BotShareDrawer_bot_desc__1Ue4e",btn_container:"BotShareDrawer_btn_container___kzbH",backdrop:"BotShareDrawer_backdrop__1X_Zu",share_btn:"BotShareDrawer_share_btn__AXqBD",close_btn:"BotShareDrawer_close_btn__MqEuq"}},9189:function(e){e.exports={divider:"ChatContent_divider__6T2mN",line:"ChatContent_line__PIw1C",text:"ChatContent_text__guTEr",chat_content_scroller:"ChatContent_chat_content_scroller__kfHj9","loading-rotation":"ChatContent_loading-rotation__afuAV"}},27290:function(e){e.exports={lack:"deepResearchPayment_lack__lq__P",enough:"deepResearchPayment_enough__Hh1Lb",container:"deepResearchPayment_container__2wY3e",overlay:"deepResearchPayment_overlay__FO4LJ",paymentContainer:"deepResearchPayment_paymentContainer__UUa5o",title:"deepResearchPayment_title__xYHr_",desc:"deepResearchPayment_desc___YJBR",buttonContainer:"deepResearchPayment_buttonContainer__3jn_5",goCoinCenterButton:"deepResearchPayment_goCoinCenterButton__AD2MK",payButton:"deepResearchPayment_payButton__LbFZM",tips:"deepResearchPayment_tips__9_SxM",notCoinContainer:"deepResearchPayment_notCoinContainer__ru_FY"}},57629:function(e){e.exports={wrapper:"Visualization_wrapper__03lGj",content:"Visualization_content__vIYcL",cursor:"Visualization_cursor__M7_3p",left:"Visualization_left__jNdBw",icon:"Visualization_icon__Q3qP_",error:"Visualization_error__OLFhz",title:"Visualization_title__PzGzz",btn:"Visualization_btn__BAKku"}},64041:function(e){e.exports={bottom_icon:"ChatBottomButton_bottom_icon__UDwLK",disable:"ChatBottomButton_disable__wBwdg",loading:"ChatBottomButton_loading__CJgky",bottom_icon_text:"ChatBottomButton_bottom_icon_text__MSC7Q",act:"ChatBottomButton_act__xOY90"}},1865:function(e){e.exports={r1_suggest_item:"R1SuggestItem_r1_suggest_item__WS2zu",icon:"R1SuggestItem_icon__r8_qg",r1_suggest_item_wrapper:"R1SuggestItem_r1_suggest_item_wrapper__isax2"}},27879:function(e){e.exports={card:"XiaoBaiYanBao_card__8bOsX",left:"XiaoBaiYanBao_left__4fk2U",tag:"XiaoBaiYanBao_tag__wAKrk",icon:"XiaoBaiYanBao_icon__5N320",text:"XiaoBaiYanBao_text__vVeN9",title:"XiaoBaiYanBao_title__TWxwI",right:"XiaoBaiYanBao_right__IFee_",image_cnt:"XiaoBaiYanBao_image_cnt__2JKNe","loading-rotation":"XiaoBaiYanBao_loading-rotation__cLLai"}},48193:function(e){e.exports={suggestion_reco_container:"suggestionReco_suggestion_reco_container__FFZqP",title:"suggestionReco_title__g6b1w",cnt:"suggestionReco_cnt__Qf2Ms",reco_item:"suggestionReco_reco_item__xsF0H","loading-rotation":"suggestionReco_loading-rotation__Tr_oQ"}},53912:function(e){e.exports={button:"Button_button__I3Qkf",disabled:"Button_disabled__ZXSDx",loader:"Button_loader__RsSnD",rotate:"Button_rotate__V_wwk",prixClipFix:"Button_prixClipFix__UBrcu"}},94621:function(e){e.exports={content_wrapper:"Background_content_wrapper___qS_v",mask:"Background_mask__T2FBu",bkg_img:"Background_bkg_img__ob859",tag:"Background_tag__3rvuc",mask_cnt:"Background_mask_cnt__kL24K",desc:"Background_desc__Te1Ox",btn:"Background_btn__AxTw0","loading-rotation":"Background_loading-rotation__O_kyZ"}},96056:function(e){e.exports={content_wrapper:"Banner_content_wrapper__jhShp",content:"Banner_content__OlWr5",title:"Banner_title__P0Y3o",desc:"Banner_desc__bxo60",has_title:"Banner_has_title__yOqqh",shadow:"Banner_shadow__hXIDC",img_container:"Banner_img_container__tEQsP",empty_rotate:"Banner_empty_rotate__H_V5v",tag:"Banner_tag__xWosB","loading-rotation":"Banner_loading-rotation__8WBKr"}},27047:function(e){e.exports={content_wrapper:"Card_content_wrapper__mKq7U",content:"Card_content__h6hly",icon:"Card_icon__SPUiC",title:"Card_title__HutSw",desc:"Card_desc__iFS7r","loading-rotation":"Card_loading-rotation__REntW"}},57141:function(e){e.exports={item:"Case_item___Qhvo"}},6418:function(e){e.exports={case_list:"ConverCase_case_list__ZrxvJ",not_deep_research:"ConverCase_not_deep_research__CcH8U",case_list_cnt:"ConverCase_case_list_cnt__eYYw4",show_more:"ConverCase_show_more__v1ARj",cnt:"ConverCase_cnt__uL3TM",deep_inner:"ConverCase_deep_inner__SA8Dl",deep_table:"ConverCase_deep_table__cgx6i",row_3:"ConverCase_row_3__pgrTc",row_4:"ConverCase_row_4___wraL"}}}]);
//# sourceMappingURL=2633-143fc9773627f415.js.map